---
title: UNIX IPC
date: 2020-03-05 15:33:19
tags:
 - UNIX
categories: UNIX
---


## 进程间通信
Linux及城建通信可以分为两类，一类是同一台主机之间的进程间通信，另一类是网络之间的进程通信。
同一台主机之间的进程通信有以下几种：
1. 管道
2. 协程
3. FIFO
4. 消息队列
5. 信号量
6. 共享存储
7. UNIX域套接字。

而网络通信主要就是套接字通信。

## 管道
管道的局限性：
1. 半双工。（虽然大多数实现都是全双工，为了移植性，假设是半双工）。
2. 管道只能在具有公共祖先的两个进程之间使用。

FIFO没有第二种局限性，UNIX域套接字两种局限性都没有。


### 函数`popen`和`pclose`
popen创建一个FILE stream指针。
指定参数'r'从cmd的标准输出读，指定参数'w'向cmd的标准输入写。

## 协同进程
UNIX过滤程序从标准输入读取数据，向标准输出读取数据。
当一个过滤程序即产生某个过滤程序的输入，又读取该过滤程序的输出时，它就变成了协同进程。
popen只提供连接到另一个进程的标准输入或者标准输出的单向通道，而协同新城有连接到另一个进程的两个单向管道：一个连接到其标准输入，另一个则连接到它的标准输出。
相当于我们把数据写入一个进程的标准输出，经过它的处理后，又从它的标准输出读出。（可以通过创建两个管道来实现，一个管道向该进程的标准输入写，另一个管道从该进程的标准输出读。）
**注意如果使用标准IO函数测试的话，可能要注意缓冲区的设置。**

## FIFO
FIFO也叫命名管道。但是管道只能在两个相关的进程之间使用，而FIFO可以在任意两个进程之间交换数据。
创建一个FIFO之后，需要使用open打开它。
如果不指定O_NONBLOCK，**只读**open会阻塞到别的进程为写打开这个FIFO为止，而**只写**open会阻塞到别的进程为读而打开这个FIFO为止。
如果指定O_NONBLOCK，只读open总是返回成功。而如果没有其他进程为读打开这个FIFO，返回-1，置位errno为ENXIO。
FIFO的用处：
1. shell命令将数据从一条管道传送到另一条时，无需创建中间临时文件。
2. 客户进程-服务器进程应用程序中，FIFO用作汇集点，在服务器和客户端之间传送数据。

## 消息队列

## 信号量

## 共享存储

## UNIX域套接字

## 参考文献
1.《APUE》第三版
