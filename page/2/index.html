<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
































<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">



  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.jpg?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.jpg?v=6.6.0">










<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.6.0',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="记录硕士三年自己的积累">
<meta property="og:type" content="website">
<meta property="og:title" content="mxxhcm&#39;s blog">
<meta property="og:url" content="http://mxxhcm.github.io/page/2/index.html">
<meta property="og:site_name" content="mxxhcm&#39;s blog">
<meta property="og:description" content="记录硕士三年自己的积累">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mxxhcm&#39;s blog">
<meta name="twitter:description" content="记录硕士三年自己的积累">



  <link rel="alternate" href="/atom.xml" title="mxxhcm's blog" type="application/atom+xml">




  <link rel="canonical" href="http://mxxhcm.github.io/page/2/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>mxxhcm's blog</title>
  












  <noscript>
  <style>
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion .logo-line-before i { left: initial; }
    .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">mxxhcm's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/29/OS-常见面试题目/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/29/OS-常见面试题目/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">OS 常见面试题目</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-29 21:43:49" itemprop="dateCreated datePublished" datetime="2020-02-29T21:43:49+08:00">2020-02-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-03-15 09:49:19" itemprop="dateModified" datetime="2020-03-15T09:49:19+08:00">2020-03-15</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/操作系统/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="中断和异常">中断和异常</h2>
<p>中断通常被定义为改变处理器执行指令顺序的事件。终端常常被分为同步中断和异步终端：<br>
同步中断是指指令执行时由CPU控制单元产生的。（异常）<br>
异步中断是指其他硬件设备依照CPU时钟信号随机产生的。（中断）<br>
Intel x86把同步和异步中断分别称为异常和中断。</p>
<p>中断提供了一种方式，是处理器转而去做正常控制流之外的代码。</p>
<h2 id="netstat">netstat</h2>
<p>netstat监控网络连接，路由表等，网络接口等。<br>
netstat默认打印所有打开的socket连接。<br>
-a, --all展示所有的listening和没有listening的sockets。<br>
-l, --listening，展示所有listening的socket，默认情况下是忽略的。<br>
-p, --program，每一个socket属于哪一个程序和pid。<br>
-n, --numeric，数值展示host，port和用户名。<br>
-t, --tcp<br>
-u, --udp<br>
-r打印路由表。<br>
-i打印网络接口。</p>
<h2 id="lsof">lsof</h2>
<p>列出打开的文件。</p>
<h2 id="ip">ip</h2>
<p>ip address，查看ip地址。<br>
ip link，查看网络设备。</p>
<h2 id="原子操作">原子操作</h2>
<p>原子操作指的是由多步组成的操作，要么执行完所有步骤，要不一步也不执行。</p>
<h2 id="程序和线程">程序和线程</h2>
<p>程序是一个存储在硬盘上的可执行文件。<br>
程序的执行实例被称为进程，它是操作系统对一个正在运行的程序的一个抽象。</p>
<h2 id="fork和vfork区别-clone">fork和vfork区别，clone</h2>
<ol>
<li>fork采用copy-on-write，而vfork在调用exec之前和父进程共享数据。</li>
<li>fork不对子进程的执行顺序做任何要求，而vfork要求子进程先运行，父进程挂起，知道子进程调用了exec或者exit之后，父进程恢复运行。</li>
<li>clone可以指定要复制的内容。</li>
</ol>
<h2 id="进程和线程的区别">进程和线程的区别</h2>
<ol>
<li>进程是资源分配和调度的最小单位，而线程是CPU调度的最小单位。引入线程后，系统并发性更高。</li>
<li>进程拥有独立的地址空间，若干代码段，数据段，文件，主存以及至少一个线程。</li>
<li>一个进程内的多个线程共享该进程的所有资源，线程自己拥有很少的资源，比如线程ID，寄存器，线程私有数据，线程栈。</li>
<li>进程调度需要上下文切换，开销大。</li>
<li>同一进程内的线程切换，仅交换线程拥有的一小部分资源，效率高。不同进程的线程切换会引发进程调度。</li>
<li>线程中通常要进行同步操作，当多个线程共享线相同的内存时，需要使用同步操作确保他们看到一致的视图。</li>
<li>进程之间交换信息要使用进程间通信。</li>
<li>一个进程结束后所有线程都将终止。</li>
<li>而一个线程结束通常不会影响其他线程（如果调用了exit就会终止所有线程。）</li>
</ol>
<h2 id="进程都有哪些资源">进程都有哪些资源</h2>
<p>寄存器<br>
堆<br>
栈<br>
数据段<br>
代码段<br>
文件描述符<br>
锁<br>
信号</p>
<h2 id="进程都有哪些区域">进程都有哪些区域</h2>
<p>可执行代码<br>
初始化数据<br>
未初始化数据<br>
堆<br>
栈</p>
<h2 id="进程创建">进程创建</h2>
<p>怎么创建一个进程。调用fork复制进程的数据空间，代码段，堆和栈的副本。现在的fork利用写时复制，这些区域由父进程和子进程共享，内核将它们的访问权限修改为只读，如果父进程和子进程中的任何一个试图修改这些区域，内核只为修改的那篇区域（通常是一页）制作一个副本，原来的页仍是受到保护的，当其他进程试图写入时，内核会检查写进程是不是这个页的唯一属主，如果是，他把这个页标记为对这个进程是可写的。通过使用一个引用计数记录共享相应页的进程数目。</p>
<h2 id="进程执行">进程执行</h2>
<p>进程，是一个程序的执行实例。<br>
每个进程都由一个进程描述符表示，这个描述符包含有关进程当前状态的信息。当内核暂停一个进程的执行时，它在进程描述符中保存好几个寄存器的内容：</p>
<ul>
<li>程序计数器和栈指针寄存器</li>
<li>通过寄存器</li>
<li>包含CPU状态信息的处理器控制寄存器</li>
<li>内存管理寄存器。</li>
</ul>
<p>进程描述符用一个结构体task_struct表示。这个结构体中包含tty_struct，fs_struct，files_struct, mm_struct和signal_struct以及其他更多。</p>
<h2 id="进程状态">进程状态</h2>
<p>进程描述符中的状态域描述了进程当前可能所处的状态，有五种：</p>
<ol>
<li>运行状态</li>
<li>中断</li>
<li>不可中断</li>
<li>停止</li>
<li>僵死状态。</li>
</ol>
<h2 id="进程切换">进程切换</h2>
<p>为了控制进程的执行，内核必须有能力挂起正在CPU上运行的进程，并恢复以前挂起的某个进程的执行，这种行为被称为进程切换。linux中进程切换的主要内容：</p>
<ol>
<li>硬件上下文。</li>
<li>硬件支持。</li>
<li>Linux代码</li>
<li>保存浮点寄存器。</li>
</ol>
<h2 id="进程结束">进程结束</h2>
<p>使用exit，使用return ，使用Exit，进程的最后一个线程调用pthread_exit。<br>
调用abort，进程接收到某些信号，最后一个线程对cancel做出请求。</p>
<h2 id="进程通信">进程通信</h2>
<p>独立进程访问同一个对象的方法。使用共享内存，然后使用信号量，记录锁，或者读写锁进行进行保护。<br>
如何传递一个字符串？使用FIFO？</p>
<h2 id="线程都有哪些资源">线程都有哪些资源</h2>
<p>私有的：程序计数器，栈空间和寄存器。</p>
<h2 id="线程创建">线程创建</h2>
<p>pthread_create。</p>
<h2 id="线程结束">线程结束</h2>
<p>pthread_exit<br>
cancel<br>
从启动例程返回。</p>
<h2 id="线程同步">线程同步</h2>
<p>互斥量<br>
读写锁<br>
条件变量<br>
屏障</p>
<h2 id="协程">协程</h2>
<p>一个进程</p>
<h2 id="select和poll">select和poll</h2>
<h2 id="死锁">死锁</h2>
<h3 id="什么是死锁">什么是死锁</h3>
<p>两个或多个进（线）程在运行过程中相互请求其他进（线）程拥有且不释放的资源，造成所有的进程或者线程都无法继续前进。</p>
<h3 id="产生死锁的原因">产生死锁的原因</h3>
<ol>
<li>资源竞争。资源类型：可抢占资源，不可抢占资源。</li>
<li>加锁的顺序不合适。</li>
</ol>
<h3 id="产生死锁的必要条件">产生死锁的必要条件</h3>
<ol>
<li>互斥条件：每个资源是不可共享的。</li>
<li>请求和保持：进程因请求某个资源而阻塞时，保持已经获得的资源不放。</li>
<li>不剥夺：进程获得的资源没有使用完前，不能被其他进程强行剥夺，只能由获得资源的进程自己释放。</li>
<li>循环等待：A等待B，B等待A。</li>
</ol>
<h3 id="解决死锁的方法">解决死锁的方法</h3>
<ol>
<li>忽略死锁问题，假设系统永远不死锁。</li>
<li>保证系统永远不进入死锁状态。
<ul>
<li>死锁预防</li>
<li>死锁避免</li>
</ul>
</li>
<li>允许系统进入死锁状态，并且可以从死锁恢复。
<ul>
<li>死锁检测</li>
<li>死锁恢复</li>
</ul>
</li>
</ol>
<h4 id="忽略死锁">忽略死锁</h4>
<p>鸵鸟算法，假设死锁永不发生。死锁在计算机中很少出现，预防死锁的代码调高。</p>
<h4 id="死锁预防-静态资源分配">死锁预防（静态资源分配）</h4>
<p>对应死锁产生的后三个必要条件。资源的互斥条件不能改变。</p>
<ol>
<li>破坏请求和保持条件：资源一次性分配，只要有有一个资源得不到分配，就不给这个进程分资源。资源利用率低，但是容易实现。</li>
<li>破坏不可剥夺条件：超时放弃已有的锁。</li>
<li>破坏循环等待条件：对所有资源进行排序，以确定的顺序获得锁。</li>
</ol>
<h4 id="死锁避免-动态资源分配">死锁避免（动态资源分配）</h4>
<p>允许进程动态的申请资源，一次申请部分资源。系统在进行资源分配之前，先计算资源分配的安全性，如果此次分配不会导致系统进入不安全状态（可能死锁），就将资源分配给进程。<br>
银行家算法。<br>
n表示进程数据，m表示资源类型。<br>
可用资源向量。<br>
最大需求矩阵。<br>
分配矩阵。<br>
需求矩阵。<br>
当一个进程申请资源时，首先判断它的请求是不是小于avaiable，如果小于，就需要等到。否则，假设将资源分配给这个进程，然后修改相应的数据结构。执行安全性算法。<br>
安全性算法是：</p>
<h4 id="死锁检测">死锁检测</h4>
<p>系统进行资源分配后，计算资源的安全性，如果此次分配会导致死锁，就采取恢复措施，否则继续。</p>
<h4 id="死锁恢复">死锁恢复</h4>
<ol>
<li>剥夺资源使系统恢复。</li>
<li>撤销进程使得系统恢复。</li>
</ol>
<h2 id="页式内存管理">页式内存管理</h2>
<h3 id="原理">原理</h3>
<h4 id="页框和页面">页框和页面</h4>
<p>页框也叫物理块。将物理存储空间划分成大小相等的若干块。大小为2的整数幂，在512字节到8192字节之间。<br>
页面。将进程的逻辑地址空间划分成与物理块大小相同的若干片。<br>
为进程分配内存时，以块为单位将进程的若干页分别装入多个可以不相邻的物理块中。</p>
<h4 id="地址空间">地址空间</h4>
<p>假设进程使用的逻辑空间是线性的，逻辑地址空间的大小是0到2的m次方(m是地址空间的位数）。每个进程使用相同的逻辑空间。!!!注意，页式内存管理的逻辑地址空间和段页式内存管理的逻辑地址空间是不一样。<br>
假设每个页面的大小是2的n次方。逻辑地址空间中的地址是addr，<br>
页号§：addr / 2的n次方。（总共有2的m次方/2的n次方个页）<br>
页内偏移(d)：add % 2的n次方。</p>
<h4 id="页表">页表</h4>
<ol>
<li>记录进程的逻辑页和主存中物理块的对应关系，实现从页号到物理块的地址映射。</li>
<li>进程地址空间中的每一页在页表中有一个条目（page table entry, PTE)，指出该逻辑在主存中的物理块号。</li>
<li>页表存放在主存中，页表的主存地址与页表的长度在PCB中。</li>
<li>控制寄存器用来存放：
<ul>
<li>页表基址寄存器：指向页表。</li>
<li>页表长度寄存器：页表长度。</li>
</ul>
</li>
</ol>
<h3 id="地址转化">地址转化</h3>
<ol>
<li>将页表的初始地址和页表长度送入控制寄存器。</li>
<li>比较PC上的页号是否大于控制寄存器中的页表长度。</li>
<li>将页号和控制寄存器中的页表起始地址相加，得到页号在页表中的位置。（就相当于一个数据，判断当前要访问的元素下标是否越界，不越界的话，取得地址）。</li>
</ol>
<p>上述过程是通过硬件完成的。<br>
获得页表在主存中的位置后，将该主存块号乘上页面大小加上PC上的偏移量，得到在主存中的物理地址。</p>
<h3 id="快表和联想寄存器">快表和联想寄存器</h3>
<p>在地址变换单元中设置的专用缓冲存储器。用来存放页表的一部分。快表的组成：<br>
页号，块号，访问位，状态位。<br>
在查询时，先使用快表进行查询，没有找到时，继续使用主存进行正常的地址变换，直到形成访问主存的绝对地址。<br>
然后将相应的逻辑页号和物理块号，写入快表中状态为为0的一行中。如果没有这样的，就把它写入访问位为0的某一行，同时置状态位和访问位为1。</p>
<h3 id="多级页表">多级页表</h3>
<p>如果一个进程可以访问32位大小的逻辑空间，页的大小为4KB（2的12次方）。那么一个页表需要包含2的32次方/2的12次方=2的20次方个表项，假设一个表项4B，那么需要4MB连续物理空间存储页表。<br>
解决方法，再分页，即多级页表。</p>
<h3 id="页式管理的主存分配">页式管理的主存分配</h3>
<p>页表是每个进程一张。</p>
<h2 id="段式内存管理">段式内存管理</h2>
<h3 id="原理-v2">原理</h3>
<h4 id="为什么引入段式管理？">为什么引入段式管理？</h4>
<ol>
<li>方便编程。</li>
<li>信息共享。</li>
<li>信息保护。</li>
<li>动态增长。</li>
<li>动态链接。</li>
</ol>
<h4 id="分段">分段</h4>
<p>按照程序自身的逻辑关系将地址空间划分成若干部分。每个段都有自己的名字。每个段都从0开始编制。</p>
<p>每个逻辑地址都分为段号和段内偏移。<br>
段式存储分配以段为单位进行，为作业的每一个分段分配一个连续的主存空间，各段之间可以不连续。</p>
<h3 id="段表">段表</h3>
<ol>
<li>用于记录进程分段和物理存储空间的对应关系，实现从逻辑分段到物理内存的地址映射。</li>
<li>每个逻辑分段对应一个table entry，指出该逻辑分段在主存中的<strong>起始地址</strong>和<strong>段的长度</strong>。（注意页表中存放的是页号和块号）。</li>
<li>段表存放于主存。段表的主存起始和段表长度保存在进程控制块中。</li>
<li>控制寄存器。
<ul>
<li>段表基址寄存器：指向段表。</li>
<li>段表长度寄存器：段表长度。</li>
</ul>
</li>
</ol>
<h3 id="段式管理的主存分配">段式管理的主存分配</h3>
<p>存在外碎片。<br>
分段方法：<br>
首次适应法。<br>
最佳适应法。<br>
最坏适应法。</p>
<h2 id="段页式内存管理">段页式内存管理</h2>
<h3 id="段式和页式管理的比较">段式和页式管理的比较</h3>
<ol>
<li>段是信息的逻辑单位，它是根据用户需要进行划分的。</li>
<li>页是信息的物理单位，为了管理主存方便，对用户是透明的。</li>
<li>段式管理向用户提供的是二维地址空间。</li>
<li>而页式管理用户提供的是一维地址空间，确定其页号和页内偏移是由机器硬件实现的。</li>
<li>页的大小固定，由系统决定。段的大小不固定。</li>
<li>页式管理产生内碎片，段式管理产生外碎片。</li>
</ol>
<h2 id="进程调度算法">进程调度算法</h2>
<ol>
<li>先来先服务（FCFS)。非抢占式的，易于实现，效率不高，性能不好，有利于长作业，但是不利于短作业。</li>
<li>短作业优先（SJF）。可以剥夺，也可以不剥夺。<br>
每次从作业队列中挑选服务时间最短的作业进行处理。非抢占式的，有限照顾短作业，具有很好的性能，降低平均等待时间，提高吞吐量。但是不利于长作业，长作业出现饥饿状态。不能用于实时系统。<br>
不剥夺的话，就是最短剩余时间优先。首先按照作业时间最短的作业运行，如果运行时有新的作业到达，并且它的服务时间比当前作业的剩余服务时间短，就发生抢占。抢占式的，因为频繁抢占和进程切换，系统开销大，算法实现代价高，一般用于实时系统。</li>
<li>高响应比。优先运行运行时间短，等待时间长的进程。非抢占式的，每次选择响应比最高的作业运行。可以避免饥饿。</li>
<li>优先级调度算法。可以剥夺，也可以非剥夺。为每个进程指定一个优先级。</li>
<li>时间片轮转法。用于分时系统的进程调度，采用剥夺方式。不利于IO频繁的作业。</li>
<li>多级队列调度算法。</li>
</ol>
<p>window和linux都采用基于抢占的优先级调度算法。</p>
<h2 id="io数据传输的控制方式">IO数据传输的控制方式</h2>
<ol>
<li>程序查询方式。</li>
<li>程序中断方式。</li>
<li>直接存储器访问。</li>
<li>通道方式。</li>
</ol>
<h2 id="磁盘调度算法">磁盘调度算法</h2>
<ol>
<li>先来先服务。容易实现，公平合理。但是完全不考虑队列中各个请求情况，使得磁头频繁移动。</li>
<li>最短寻道时间优先（SSTF）。在移动磁头时，总是选择移动磁头距离最小的磁道。可能会导致饥饿问题。</li>
<li>扫描法SCAN和循环扫描法CSCAN。<br>
SCAN磁头不断的从一端移动到另一端，到头返回。（电梯算法）<br>
CSCAN，从一端移动到另一端时，立即返回它开始的地方。</li>
<li>查询法LOOK和循环查询法C-LOOK。<br>
SCAN和CSCAN都是将磁头从一端移动到另一端。<br>
而LOOK和CLOOK是移动到最远的请求上的那个磁道，如果前进方向上没有请求，就反向移动。</li>
</ol>
<h2 id="参考文献">参考文献</h2>
<p>1.《APUE》第三版<br>
2.<a href="https://stackoverflow.com/questions/200469/what-is-the-difference-between-a-process-and-a-thread" target="_blank" rel="noopener">https://stackoverflow.com/questions/200469/what-is-the-difference-between-a-process-and-a-thread</a><br>
3.<a href="https://www.geeksforgeeks.org/difference-between-process-and-thread/" target="_blank" rel="noopener">https://www.geeksforgeeks.org/difference-between-process-and-thread/</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/29/C-常见面试题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/29/C-常见面试题/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">C 常见面试题</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-29 21:43:10" itemprop="dateCreated datePublished" datetime="2020-02-29T21:43:10+08:00">2020-02-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-03-15 15:42:59" itemprop="dateModified" datetime="2020-03-15T15:42:59+08:00">2020-03-15</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/面试/" itemprop="url" rel="index"><span itemprop="name">面试</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="static关键字-4">static关键字[4]</h2>
<ol>
<li>隐藏全局变量和函数的作用域。这一个已经被标准抛弃了。</li>
<li>修饰局部变量，改变变量的生命周期。</li>
<li>修饰类的数据成员和成员函数。</li>
</ol>
<h2 id="const关键字">const关键字</h2>
<ol>
<li>顶层const和底层const。主要是常量指针和常量引用。</li>
<li>const修饰形参和const修饰返回值。</li>
<li>和类相关。<br>
修饰成员变量，必须使用初始化列表修饰。<br>
const修饰成员函数。<br>
修饰类对象，必须调用const类型的函数。<br>
const可以用来区分重载。</li>
</ol>
<h2 id="const和宏常量的区别">const和宏常量的区别</h2>
<p>const常量有数据类型，而宏常量没有。编译器可以对前者进行安全检查，对后者只能进行字符替换。</p>
<h2 id="inline-10-11">inline[10,11]</h2>
<ol>
<li>为什么引入inline？避免函数调用的开销，比如说参数入栈，出栈。</li>
<li>inline只适合函数体代码简单的函数使用，不能有循环等语句。适用于规模小，流程直接，频繁调用。</li>
<li>用inline声明的函数并不一定会inline，取决于编译器。</li>
<li>建议inline函数的定义放在头文件中。</li>
<li>类内定义的函数是隐式的inline函数。</li>
<li>inline关键字应该和实现放在一块，只在声明中说明没有用。</li>
<li>慎用内联。</li>
</ol>
<h2 id="inline和宏函数的区别">inline和宏函数的区别</h2>
<ol>
<li>宏函数是由预处理器对宏进行替换，而内联函数是通过编译器控制的。</li>
<li>内联函数是函数，会进行参数检查。只不过在调用的时候像宏一样展开，减少函数调用。</li>
<li>宏是不安全的，而内联是安全的。</li>
</ol>
<h2 id="指针函数和函数指针">指针函数和函数指针</h2>
<p>指针函数是一个函数，返回类型是一个指针而已。<br>
函数指针是一个指针，是一个指向函数的指针。</p>
<h2 id="数组和指针">数组和指针</h2>
<ol>
<li>数组是一块连续存放的空间，指针是一个地址，指针变量是一个变量。</li>
<li>初始化。</li>
<li>大小。</li>
<li>指针数组和数组指针。</li>
<li>作为函数参数。</li>
</ol>
<h2 id="指针和引用的区别">指针和引用的区别</h2>
<ol>
<li>可以定义指针的指针，但是不能（直接）定义引用的引用（模板参数推导的时候可以）。</li>
<li>指针可以被重新赋值。而引用一旦被绑定就不能修改。</li>
<li>指针可以为空，引用不能。</li>
<li>指针本身是一个变量，有它自己的内存地址，以及在栈上的大小。而引用的内存地址和它绑定的对象一样，看起来是一样的，但是实际上是不一样的（编译器做了一些操作），可以把引用当做它引用对象的别名。</li>
<li>指针必须被解引用才能使用，而引用不需要。</li>
<li>指针变量可以进行运算，而引用不能。</li>
<li>const引用可以指向字面值常量，而指针不能（除了字符数组）。</li>
<li>指针本身可以是const的，而引用不能。底层const和顶层const。</li>
</ol>
<h2 id="vector扩容">vector扩容</h2>
<h3 id="为什么不是常数">为什么不是常数</h3>
<p>成倍增长可以保持常数时间复杂度的插入操作。<br>
常数增长的插入时间复杂度是O(n)。<br>
为什么？假设要插入n个元素，成倍增长的倍数是p，常数增长的大小是q。<br>
成倍增长总共的复制开销：<br>
$$ \sum_{i=1}^{log_p^n } p^i $$<br>
常数增长总共的复制开销：<br>
$$\sum_{i=1}^{n/q} qi $$</p>
<h3 id="为什么是1-5或者2">为什么是1.5或者2</h3>
<p>为什么是1.5？可以复用之间的空间。<br>
为什么是2？实现简单。</p>
<h2 id="strlen和sizeof的区别">strlen和sizeof的区别</h2>
<ol>
<li>sizeof是运算符。它的值在编译时就已经确定了，所以不能用来获得动态分配的内存空间的大小。</li>
<li>strlen是函数，在运行时计算的。</li>
<li>静态数组传递给strlen就会退化成指针，在传递给sizeof的时候还是数组。strlen是数组中内容的长度，而sizeof是静态数组声明时的大小。</li>
<li>动态数组(malloc)分配的，strlen能获得数组中内容的大小，而sizeof只能获得指针的大小。</li>
<li>strlen不会计算空字符，而sizeof会。</li>
</ol>
<h2 id="override和overload">override和overload</h2>
<p>只有虚函数能被ovrride。<br>
override是用来实现多态的，函数的参数类型和声明和可以父类中完全一样。<br>
而overload中，函数的参数列表必须不同。它的作用我觉得可能是方便记忆，方便理解。实现同一个功能的函数具有同样的名字。</p>
<h2 id="空类的大小为1字节">空类的大小为1字节</h2>
<p>标准规定空类的大小为1，因为两个不同的对象需要不同的地址表示。标准规定完整对象的大小大于0。</p>
<h2 id="虚函数和虚函数表-12">虚函数和虚函数表[12]</h2>
<p>当某个类中声明了虚函数时，编译器会为该类创建一个虚函数表，存放虚函数的地址，这个是在编译时期完成的。然后编译器会在该类的对象中添加一个虚指针指向这样一个虚函数表。<br>
当有其他类继承这个类时，编译器为这个类也创建一个虚函数表。如果派生类重写了基类的虚函数，那么编译器会更新虚函数表中的函数地址为派生类的虚函数地址。<br>
当发生虚函数调用时，编译器会根据指针指向的对象，找到该对象的虚函数表，然后调用相应的虚函数。</p>
<h2 id="虚析构函数">虚析构函数</h2>
<p>一个基类总是需要虚析构函数。</p>
<h2 id="虚继承">虚继承</h2>
<p>为什么要有虚继承？<br>
派生类可能多次继承同一个类。默认情况下，派生类会含有继承链上每个类对应的子部分，如果某个类在派生过程中出现了多次，派生类中将包含该类的多个子对象。比如iostream之类的类，肯定不行。<br>
声明成虚继承的继承体系中，无论虚基类在继承体系中出现了多少次，派生类中都只含有一个共享的虚基类子对象。</p>
<h2 id="多态">多态</h2>
<p>C++的多态分为两种，一种是静态多态，通过函数重载和模板实现。<br>
一种是动态多态，虚函数实现。</p>
<p>C实现C++的多态[5,6]。</p>
<h2 id="rtti-13">RTTI[13]</h2>
<p>RTTI是运行时类型识别。</p>
<h2 id="cast"><code>cast</code></h2>
<h3 id="static-cast"><code>static_cast</code></h3>
<p>和C中提供的强制类型转换一样。</p>
<h3 id="const-cast"><code>const_cast</code></h3>
<p>只能改变运算对象的底层const，可能去掉也可以添加底层const。</p>
<h3 id="reinterprect-cast"><code>reinterprect_cast</code></h3>
<p>为运算对象的bit mode提供新的解释。比如可以把一个整数解释成字符串。</p>
<h3 id="dynamic-cast"><code>dynamic_cast</code></h3>
<p><code>dynamic_cast</code>实现安全的动态转换。<br>
它可以可以安全实现的执行downcast，但是需要是含有虚函数的类。</p>
<h2 id="智能指针">智能指针</h2>
<h3 id="shared-ptr实现">shared_ptr实现</h3>
<p>引用计数放在指针成员中。<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">shared_ptr</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">shared_ptr</span>():pd(<span class="literal">nullptr</span>)</span><br><span class="line">    &#123; &#125;</span><br><span class="line">    <span class="built_in">shared_ptr</span>(T *data): pd(data), <span class="keyword">new</span> <span class="keyword">size_t</span>(<span class="number">1</span>)</span><br><span class="line">    &#123; &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 拷贝构造函数</span></span><br><span class="line">    <span class="keyword">explicit</span> <span class="built_in">shared_ptr</span>(<span class="keyword">const</span> <span class="built_in">shared_ptr</span>&lt;T&gt; &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        pd = rhs.pd; </span><br><span class="line">        count = rhs.count;</span><br><span class="line"></span><br><span class="line">        ++*rhs.count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">shared_ptr</span>&lt;T&gt;&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="built_in">shared_ptr</span>&lt;T&gt; &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(count &amp;&amp; --*count == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">delete</span> pd;</span><br><span class="line">            <span class="keyword">delete</span> count;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        pd = rhs.pd;</span><br><span class="line">        count = rhs.count;</span><br><span class="line">        <span class="keyword">if</span>(rhs.count)</span><br><span class="line">            ++*count;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">shared_ptr</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(count &amp;&amp; --*count == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">delete</span> pd; </span><br><span class="line">            <span class="keyword">delete</span> count;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    T&amp; <span class="keyword">operator</span>*() </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> *p;</span><br><span class="line">    &#125;</span><br><span class="line">    T&amp; <span class="keyword">operator</span>*() <span class="keyword">const</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> *p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line">    T *pd;</span><br><span class="line">    <span class="keyword">size_t</span> *count;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h3 id="unique-ptr实现">unique_ptr实现</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">unique_ptr</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">unique_ptr</span>():p(<span class="literal">nullptr</span>)</span><br><span class="line">    &#123; &#125;</span><br><span class="line">    <span class="comment">// 构造函数</span></span><br><span class="line">    explicit unique_ptr(T *data): p(data)</span><br><span class="line">    &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//拷贝构造</span></span><br><span class="line">    <span class="built_in">unique_ptr</span>(<span class="keyword">const</span> <span class="built_in">unique_ptr</span>&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//拷贝赋值</span></span><br><span class="line">    <span class="built_in">unique_ptr</span>&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="built_in">unique_ptr</span> &amp;rhs) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//析构</span></span><br><span class="line">    ~<span class="built_in">unique_ptr</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(p)</span><br><span class="line">            <span class="keyword">delete</span> p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">T* <span class="title">release</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        T *q = p;</span><br><span class="line"></span><br><span class="line">        p = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">return</span> q; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">T* <span class="title">reset</span><span class="params">(T *data)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(p)</span><br><span class="line">            <span class="keyword">delete</span> p;</span><br><span class="line">        p = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    T&amp; <span class="keyword">operator</span>*() &#123;<span class="keyword">return</span> *p;&#125;</span><br><span class="line">    <span class="comment">//指针本身是个常量</span></span><br><span class="line">    <span class="comment">// const 修饰this指针，常量指针，指向不能改变，指针指向的值可以改变。为什么这里返回值不是常量。这个指针可不可以指向常量对象，可以。</span></span><br><span class="line">    T&amp; <span class="keyword">operator</span>*() <span class="keyword">const</span> &#123;<span class="keyword">return</span> *p&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T *p;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="shared-ptr和unique-ptr">shared_ptr和unique_ptr</h3>
<ol>
<li>它们管理保存指针的策略，前者可以共享指针，而后者则独占指针。</li>
<li>它们允许用户重载deleter的方式。只要在创建或者reset指针时给shared_ptr提供一个deleter即可。但是，deleter是unique_ptr对象的一部分。<br>
shared_ptr的deleter是运行时绑定，所以需要使用指针，开销大，但是用户重载更方便。它的执行方式可能如下：<code>del?del(p): delete p</code>。<br>
而unique_ptr的deleter是编译时绑定，避免了间接调用deleter的运行时开销。</li>
<li>shared_ptr不能动态管理数组，而unique_ptr可以动态管理数组。</li>
</ol>
<h3 id="智能指针和数组">智能指针和数组</h3>
<ol>
<li>shared_ptr不支持管理动态数组。需要提供自定义的delete（只要是一个可调用对象就行）。</li>
<li>unique_ptr支持动态管理数组，需要在类型后面加上一对方括号。当unique_ptr销毁时，会自动使用delete[]。不能使用成员访问运算符（点和箭头），但是可以使用下标访问运算符。</li>
</ol>
<h3 id="weak-ptr">weak_ptr</h3>
<p><code>weak_ptr</code>可以解决循环引用问题，比如双向链表中的循环引用。[9]</p>
<h2 id="类模板和函数模板的区别">类模板和函数模板的区别</h2>
<p>类模板用来生成类，函数模板的参数是由编译器推导的，而类模板的参数必须指定。</p>
<h2 id="模板特化和偏特化">模板特化和偏特化</h2>
<p>模板特化的本质是模板实例化，定义特化版本时，我们实际上是接替了编译器的工作。<br>
函数模板只能全特化。<br>
类模板可以全特化也可以偏特化。偏特化既有类型的偏特化，也有个数的偏特化。</p>
<h2 id="为什么模板的声明和实现要写在一起而类的实现和声明要分开-7">为什么模板的声明和实现要写在一起而类的实现和声明要分开[7]</h2>
<p>C++ 采用分离式编译。可以不用将所有的代码写在一个文件中，可以将他们分解为更小，更好管理的模块，可以独立的修改和编译这些模板。当我们改变这些模板时，只需要重新的编译它，并重新链接，不必重新编译其他文件。这一功能主要是通过链接器实现的。更多的内容可以查看CSAPP上介绍的。<br>
对于普通对象和函数而言，类的声明写在头文件中，实现写在cpp文件中。cpp文件是可以单独被编译的。<br>
但是模板函数的实现并不能直接编译成二进制代码，因为只有在真正使用模板的时候，才会知道模板参数的值。编译器和链接器的某一个部分，可以去掉模板的多重定义。</p>
<h2 id="模板元编程">模板元编程</h2>
<h2 id="哈希表">哈希表</h2>
<p>哈希表冲突严重的话会退化成单链表。这个时候哈希表的各种操作的时间复杂度都提升了一个量级，会占用大量CPU时间，降低系统响应时间，可以用来做DDos攻击。<br>
解决冲突的方法：</p>
<h2 id="malloc和new">malloc和new</h2>
<h3 id="new">new</h3>
<p>new一个空数组是和合法的，但是不能解引用！！！可以把它当做尾后迭代器来使用。</p>
<h3 id="malloc-calloc和realloc">malloc, calloc和realloc</h3>
<ol>
<li>malloc分配指定字节的数组，初值不定。</li>
<li>calloc分配nobj个size字节的对象，每一位都初始化为0。</li>
<li>realloc在以前分配的区域的基础上扩大为新的容量。如果原来的区域后面有足够大的空间，就在那里，否则复制到一个新的空间中。</li>
</ol>
<h3 id="ptmalloc实现">ptmalloc实现</h3>
<h3 id="placement-new">placement new</h3>
<p>重载operator new函数。placement new可以为分配函数提供额外的信息。<br>
Placement new允许我们将对象构造在已经分配好的内存上，分配好的内存不一定是operator new分配的内存，甚至可以是静态内存。<br>
allocator的内存分配和构造函数的调用是分开进行的，通过两个函数allocate和construct。<br>
对应于new，可以使用operator new进行空间分配，使用placement new调用构造函数。</p>
<h2 id="对齐">对齐</h2>
<p>gcc 默认对齐是4字节对齐。在结构体中要注意。<br>
malloc是16字节对齐。</p>
<h2 id="cmake和makefile">cmake和makefile</h2>
<p>make用来执行makefile，调用makefile中用户指定的命令进行编译和链接。<br>
makefile是文件，包含了怎么样进行编译和链接。<br>
makefile可以手动写，但是它不跨平台（即不同平台的makefile不同），而且工程大很麻烦。<br>
cmake可以根据CMakeList.txt跨平台自动生成makefile。<br>
CMakeLists.txt是我们自己写的。</p>
<h2 id="void">void *</h2>
<p>可以接收任意类型的赋值，无需强制类型转换。<br>
经过类型转换可以赋值给任意类型的变量。</p>
<h2 id="lambda表达式">lambda表达式</h2>
<p>为什么要有lambda表达式？</p>
<ol>
<li>总共有四种可调用对象，函数，函数指针，重载了函数运算符的类和lambda表达式。</li>
<li>lambda表达式的声明。<br>
auto f = [local variable](int x){return a;};</li>
<li>对于那种只在一两个地方使用的简单操作，lambda表达式是有用的。当在多个地方使用的话，通过应该使用一个函数，或者需要很多语句的话，也是函数比较好。</li>
<li>capture list中引用和值的作用。</li>
<li>可以和STL中的算法进行交互。</li>
</ol>
<h2 id="面向对象的几大原则">面向对象的几大原则</h2>
<ol>
<li>单一职责原则。解耦，增强内聚，即高内聚低耦合。</li>
<li>开放封闭原则。对扩展开放，对修改关闭。</li>
<li>里氏替换原则。子类可以替换父类。</li>
<li>依赖倒置原则。依赖于抽象而不是依赖细节。</li>
<li>接口分离原则。不需要让客户程序依赖它们不需要的方法。一个接口应该只提供一种对外的功能。</li>
<li>合成复用原则。</li>
<li>迪米特原则。</li>
</ol>
<h2 id="设计模式">设计模式</h2>
<ol>
<li>单例模式</li>
<li>reactor模式</li>
</ol>
<h2 id="move语义">move语义</h2>
<h2 id="分配器">分配器</h2>
<h2 id="虚拟内存">虚拟内存</h2>
<h2 id="数据结构相关">数据结构相关</h2>
<h3 id="堆">堆</h3>
<p><strong>二叉堆是完全二叉树，一般可以用数组实现</strong>。最大堆就是每个根节点的值大于其子节点的值，最小堆就是每个根节点的值小于其子节点的值。</p>
<h4 id="sgi-stl-heap相关的算法">SGI STL heap相关的算法</h4>
<ul>
<li>push_heap，将新的节点插在最后一个位置。</li>
<li>pop_heap，弹出最大堆的堆顶元素。（或者就是heapify）</li>
<li>sort_heap，就是排序。</li>
<li>make_heap，创建一个最大堆。</li>
</ul>
<h4 id="优先队列">优先队列</h4>
<p>底层实现是二叉堆，总是弹出key最大的元素。</p>
<h3 id="哈希和哈希表">哈希和哈希表</h3>
<h4 id="什么是哈希">什么是哈希</h4>
<p>哈希：把任意长度的输入，变成固定长度的输出，这个映射的规则就是对应的哈希算法，原始数据映射后的输出叫做哈希值。哈希值存在的目的是加速key-value的查找速度。<br>
哈希常见的几种实现方式：顺序，链式，散列，索引。哈希表是其中的一种。<br>
注意把哈希和哈希表区分开来。</p>
<h4 id="碰撞-冲突">碰撞（冲突）</h4>
<p>什么是碰撞？输入不同的数据得到相同的输出，哈希一定会发生碰撞。</p>
<h4 id="hash">hash</h4>
<h5 id="好的hash要求">好的hash要求</h5>
<ol>
<li>抗碰撞。不同的输入得到相同输出的概率要小。</li>
<li>抗篡改。输入数据的小的变化会得到完全不同的值，输入相同的数据会得到相同的值。（雪崩效应）。</li>
<li>速度要好。哈希算法的效率要高</li>
<li>根据输出不能反推输入。</li>
</ol>
<h5 id="hash的应用">hash的应用</h5>
<ol>
<li>保存密码，保存用户密码的哈希值。（这也是很多地方只能重置密码的原因，因为它们也不知道你的密码。。。）</li>
<li>数据校验。</li>
<li>负载均衡。在服务器扩容时，使用一致性哈希。</li>
</ol>
<h4 id="hashtable">hashtable</h4>
<p>哈希表是用哈希算法实现的表，提供了对任何有名字项的存取和删除操作，也可以查看是一种字典，提供常数时间的读写操作。<br>
哈希表的扩容(rehash)，元素个数比bucket个数多，再打散，把bucket个数增加两倍（接近两倍的质数）。</p>
<h4 id="hashtable碰撞的解决方法">hashtable碰撞的解决方法</h4>
<p>负载系数：元素个数除以表格大小，除了开链法，都要在0,1之间。<br>
<strong>线性探测</strong>：插入的时候，找到一个不可用的位置（被其他值占了），继续找下下一个位置，直到找到一个空位置。查找的时候，如果找到一个和当前搜索的目标不同的值，就继续往下找。删除的话，采用惰性删除，只删除记号，实际操作等到rehash时再进行。<br>
最坏情况下，哈希表退化成链表。<br>
<strong>二次探测</strong>：发生冲突是，而是使用H+n^2的平方寻找可用的位置。</p>
<ol>
<li>对于二次探测，假设表格大小为质数，负载因子为0.5，保持负载因子在0.5以下，超过0.5就rehash，可以保证插入每一个元素的探测次数不多于2。</li>
<li>二次探测本身所需的计算量其实和一次探测差不多。</li>
<li>rehash的时候，必须重新计算表中的每一个元素。</li>
</ol>
<p><strong>开链(seperate chaining)</strong>：在每一个表格中维护一个链表。表格的负载系数会大于1。</p>
<h4 id="hashtable的桶">hashtable的桶</h4>
<p>SGI使用开链法，表格（桶的集合）使用vector（为了动态扩容），而链表使用自定义的结构体。</p>
<ol start="0">
<li>SGI使用bkt_num()获得每个元素应该存放在哪个bucket中，这个函数负责调用hash function取得一个可以执行取模运算的值。为什么不直接使用hash_function，因为有些元素类型无法直接拿来对hashtable的大小进行模运算，这时候需要做一些转换。<br>
开链法没有要求表格的大小为质数，但是SGI依然这么做了，并且准备了28个质数的表，并且提供一个函数去获取最接近并大于某个数的质数。</li>
<li>在创建一个hashtable对象时，首先要进行实例化，指明hashtable的各个模板参数，然后提供参数给构造函数（没有默认构造函数数）。其中有一个参数大小为n，表明要创建的hashtable的桶的个数（它会自动寻找一个接近n的质数）。</li>
<li>插入元素的时候，每插入一个就会判断是否需要resize。这个是一个很常用的操作，插入操作，首先判断需不要扩容，比如vector等。</li>
<li>扩容的原则：元素数量大于bucket的数量就resize。</li>
<li>复制和删除，删除的时候需要对bucket中每一个链表都删除。而复制的时候需要先把原有的给删除掉，然后保留和复制对象至少一样的空间。</li>
<li>hashtable的示例，在新版本的STL中，不能直接使用hashtable，unordered_set和unordered_map都是对hashtable的封装，调用构造函数时传入一个n是桶的数量，这个n必须指定（STL会自动改成比n大的最小质数）。</li>
</ol>
<h4 id="hash函数">hash函数</h4>
<p>STL定义了很多仿函数，都是模板。hash也是一个仿函数，返回size_t类型。对于char, int,等类型，通常就返回原值，而对字符串和string等设计了相应的转换函数，对于浮点数，怎么办，没有说，STL源码剖析的版本没有实现，但是cppreference上说有，应该是新增加的。</p>
<h4 id="其他">其他</h4>
<p>unordered类容器和非ordered类容器最大的区别就是一个是默认有序，一个是默认无序。</p>
<h3 id="树">树</h3>
<p><strong>二叉搜索树</strong>：任何节点的键值一定大于它的左子树中的所有节点，小于右子树中每一个节点的键值。<br>
关联式容器的内部结构是<strong>平衡二叉树</strong>，平衡二叉树有AVL树，红黑树，AA树等。平衡的大概意思就是没有一个节点过深。</p>
<h4 id="avl树">AVL树</h4>
<p>确保整颗树的深度是logn，任何节点的左右子树高度最多相差1。<br>
AVL利用单旋和双旋，可以将所有不平衡的情况转换为平衡的情况。<br>
对于深度最深的节点X，造成节点X不平衡只有四种情况：<br>
插入点在X的左子节点的左子树。<br>
插入点在X的左子节点的右子树。<br>
插入点在X的右子节点的左子树。<br>
插入点在X的右子节点的右子树。<br>
双旋第一步做完，第二步就是单旋了。</p>
<h4 id="红黑树-17">红黑树[17]</h4>
<p>红黑树需要满足以下规则：</p>
<ol>
<li>所有节点非红即黑。</li>
<li>根节点为黑色。</li>
<li>如果节点为红，子节点必须为黑。</li>
<li>任一节点到叶子节点的任何路径，所包含的黑色节点必须相同。</li>
</ol>
<p>为什么有了AVL还要有红黑树。AVL的条件太苛刻了，基本上每次插入和删除都需要重新调整。这样子在插入和删除比较频繁的情况下代价太大了。就提出了AVL树，查找的时间复杂度也是logn的，但是它的平衡条件要比AVL树宽松一些，插入和删除时也不会像AVL那样频繁破坏规则。<br>
查找的代价：最长路径长度不超过最短路径长度的2倍。<br>
插入代价：插入节点最多只需要两次操作，和AVL一样，变色的时间复杂度是O(logN)。<br>
删除代价：删除一个节点最多只需要旋转3次，但是变色操作的时间复杂度在O(logN)。</p>
<p>插入有四种情况：</p>
<ol>
<li>父节点为黑色，直接插入一个红色节点就好了。</li>
<li>父节点为红色，这个时候，取决于叔节点的颜色。
<ul>
<li>叔节点为红色，这个时候还取决祖父节点的父节点的颜色。如果那个节点是黑，把新增加的节点和父节点（叔节点）交换一下就好了。如果那个节点是红色，还需要更改祖父节点的颜色。</li>
<li>叔节点为黑色，</li>
<li>叔节点为黑色，</li>
</ul>
</li>
</ol>
<p>一个有n个节点的红黑树的高度至多为2log(n+1)。</p>
<h2 id="b树-18">B树[18]</h2>
<p>B树是对二叉树的推广，B树一般有一个阶数m，m阶代表每个树节点最多有m个查找路径，其实就是有多少个分叉，有m个分叉，最多就能存储m-1个数据。m=2时，就是二叉树，二叉树每个节点能分两叉，只能存1个数据。</p>
<ol>
<li>如果根节点不是叶子节点，必须有两个叶节点，一个数据，也就是两个分叉。</li>
<li>每个非叶子节点的子节点数大于等于m/2的上界，小于m；每个节点的关键字个数必须大于m/2-1（这里除法是有小数的）的上界小于m-1，就是对应的分叉数-1。</li>
<li>所有的叶子节点都位于同一层，不包含关键字信息。</li>
</ol>
<h2 id="b-树-18">B+树[18]</h2>
<p>B+树和B树的区别：</p>
<ol>
<li>每个节点有n个子节点，n个关键字，而B树n个子节点有n-1个关键字。</li>
<li>还有就是根节点和叶子节点关键字和子节点的个数范围。</li>
<li>叶子节点包含全部关键字，所有非叶子节点都只起到了索引的作用。非叶子节点上有关键字，但是只用来索引，没有对应记录的存储地址。</li>
<li>非叶子节点中出现的关键字是会重复出现在叶子节点中的。</li>
</ol>
<p>B+树的好处，扫库的时候直接顺序查找就好了，而B树需要中序遍历。B+树还支持区间查询，而B树不支持。<br>
通常在B+树中有两个头指针，一个指向根节点，一个指向关键字最小的叶节点。所以支持顺序查找，也支持多路查找。</p>
<h2 id="gcc和gdb-14">gcc和gdb[14]</h2>
<p>gcc 常用选项：<br>
-O编译器优化，Og最低等级的优化，On，数字越大优化等级越高。<br>
-Wall发出所有警告<br>
-g产生调试信息<br>
-o指定输出文件。<br>
-E只进行预处理<br>
-S编译到汇编，就是产生汇编代码<br>
-c之编译汇编，不链接，就是产生目标代码<br>
-static禁止使用动态链接库，只链接静态库，编译后可独立执行，不需要动态库，但是得到的可执行目标文件比较大。<br>
-L dir在库文件的搜索列表添加dir目录<br>
-I dir在头文件的搜索列表添加dir目录<br>
-shared</p>
<p>使用gdb调试时，需要使用使用gcc -g选项添加调试信息。</p>
<ul>
<li>gdb program，</li>
<li>gdb program core，用gdb查看core dump文件</li>
<li>gdb program pid，用gdb查看已经开始运行的进程。</li>
</ul>
<p>使用quit或者q退出。</p>
<p>gdb调试选项<br>
help<br>
run，开始调试程序<br>
break，设置断点。<br>
info break，查看断点信息。<br>
watch，为一个表达式设置一个检视点，可以加上-l选项，当监视的变量改变时，就会自动打印。<br>
catch,<br>
list，打印源码展示出指定的函数或者行。<br>
print，打印出表达式的值。<br>
display，每次程序停止的时候打印出<br>
bt，显示程序的调用栈信息。<br>
framen，简要查看第n帧的信息。<br>
info frame，详细查看当前帧的信息<br>
info registers，查看寄存器<br>
info args，查看当前帧的参数。<br>
info locals，查看当前帧中的局部变量。<br>
continue<br>
step</p>
<h2 id="移动语义和右值引用-16">移动语义和右值引用[16]</h2>
<p>移动语义，是为了避免无用的复制开销。右值引用的出现，让移动语义变得可能。将指针指向的内存直接拿过来使用。<br>
Move semantics is a new way of moving resources around in an optimal way by avoiding unnecessary copies of temporary objects, based on rvalue references. In my opinion, the best way to understand what move semantics is about is to build a wrapper class around a dynamic resource (i.e. a dynamically allocated pointer) and keep track of it as it moves in and out functions. Keep in mind however that move semantics does not apply only to classes!</p>
<h2 id="参考文献">参考文献</h2>
<p>1.<a href="https://stackoverflow.com/questions/57483/what-are-the-differences-between-a-pointer-variable-and-a-reference-variable-in" target="_blank" rel="noopener">https://stackoverflow.com/questions/57483/what-are-the-differences-between-a-pointer-variable-and-a-reference-variable-in</a><br>
2.<a href="https://blog.csdn.net/dengheCSDN/article/details/78985684" target="_blank" rel="noopener">https://blog.csdn.net/dengheCSDN/article/details/78985684</a><br>
3.<a href="https://www.cnblogs.com/carekee/articles/1630789.html" target="_blank" rel="noopener">https://www.cnblogs.com/carekee/articles/1630789.html</a><br>
4.<a href="https://stackoverflow.com/a/943303/8939281" target="_blank" rel="noopener">https://stackoverflow.com/a/943303/8939281</a><br>
5.<a href="https://stackoverflow.com/questions/524033/how-can-i-simulate-oo-style-polymorphism-in-c" target="_blank" rel="noopener">https://stackoverflow.com/questions/524033/how-can-i-simulate-oo-style-polymorphism-in-c</a><br>
6.<a href="https://blog.csdn.net/dumpling5232/article/details/52632060" target="_blank" rel="noopener">https://blog.csdn.net/dumpling5232/article/details/52632060</a><br>
7.<a href="https://blog.csdn.net/uestclr/article/details/51372780" target="_blank" rel="noopener">https://blog.csdn.net/uestclr/article/details/51372780</a><br>
8.<a href="https://stackoverflow.com/questions/10068653/separate-compilation-in-c" target="_blank" rel="noopener">https://stackoverflow.com/questions/10068653/separate-compilation-in-c</a><br>
9.<a href="https://blog.csdn.net/qq_34992845/article/details/69218843" target="_blank" rel="noopener">https://blog.csdn.net/qq_34992845/article/details/69218843</a><br>
10.<a href="https://www.cnblogs.com/fnlingnzb-learner/p/6423917.html" target="_blank" rel="noopener">https://www.cnblogs.com/fnlingnzb-learner/p/6423917.html</a><br>
11.<a href="https://isocpp.org/wiki/faq/inline-functions" target="_blank" rel="noopener">https://isocpp.org/wiki/faq/inline-functions</a><br>
12.<a href="https://isocpp.org/wiki/faq/virtual-functions" target="_blank" rel="noopener">https://isocpp.org/wiki/faq/virtual-functions</a><br>
13.<a href="https://www.cnblogs.com/findumars/p/6358194.html" target="_blank" rel="noopener">https://www.cnblogs.com/findumars/p/6358194.html</a><br>
14.<a href="https://blog.csdn.net/kikajack/article/details/92829582" target="_blank" rel="noopener">https://blog.csdn.net/kikajack/article/details/92829582</a><br>
15.<a href="https://en.cppreference.com/w/cpp/utility/hash" target="_blank" rel="noopener">https://en.cppreference.com/w/cpp/utility/hash</a><br>
16.<a href="https://www.internalpointers.com/post/c-rvalue-references-and-move-semantics-beginners" target="_blank" rel="noopener">https://www.internalpointers.com/post/c-rvalue-references-and-move-semantics-beginners</a><br>
17.<a href="https://blog.csdn.net/hackbuteer1/article/details/7740956" target="_blank" rel="noopener">https://blog.csdn.net/hackbuteer1/article/details/7740956</a><br>
18.<a href="https://blog.csdn.net/Raven_csdn/article/details/88816877" target="_blank" rel="noopener">https://blog.csdn.net/Raven_csdn/article/details/88816877</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/29/UNIX-daemon/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/29/UNIX-daemon/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">UNIX daemon</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-29 16:08:36" itemprop="dateCreated datePublished" datetime="2020-02-29T16:08:36+08:00">2020-02-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-03-10 20:42:56" itemprop="dateModified" datetime="2020-03-10T20:42:56+08:00">2020-03-10</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UNIX/" itemprop="url" rel="index"><span itemprop="name">UNIX</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="守护进程">守护进程</h2>
<p>守护进程常常在系统引导装入时启动，仅在系统关闭时才终止。<br>
守护进程没有控制终端，终端名设置为问号。</p>
<h2 id="将一个进程初始化成守护进程">将一个进程初始化成守护进程</h2>
<ol>
<li>调用umask设置mask。</li>
<li>创建一个没有控制终端的进程。</li>
<li>更改进程当前工作目录。</li>
<li>关闭继承的文件描述符。</li>
<li>守护进程一般不和标准输入，标准输出以及标准错误绑定。</li>
</ol>
<h2 id="参考文献">参考文献</h2>
<p>1.《APUE》第三版</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/22/network-tcp-udp-message/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/22/network-tcp-udp-message/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">network tcp udp message</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-22 10:47:38" itemprop="dateCreated datePublished" datetime="2020-02-22T10:47:38+08:00">2020-02-22</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/21/C-virtual-function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/21/C-virtual-function/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">C virtual function</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-21 23:53:01" itemprop="dateCreated datePublished" datetime="2020-02-21T23:53:01+08:00">2020-02-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-22 00:59:57" itemprop="dateModified" datetime="2020-02-22T00:59:57+08:00">2020-02-22</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/C-C/" itemprop="url" rel="index"><span itemprop="name">C/C++</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="虚函数">虚函数</h2>
<h2 id="纯虚函数">纯虚函数</h2>
<h2 id="什么函数不能是虚函数">什么函数不能是虚函数</h2>
<ol>
<li>非成员函数</li>
<li>友元函数</li>
<li>构造函数</li>
<li>静态函数</li>
<li>内联函数</li>
</ol>
<h2 id="虚函数的作用">虚函数的作用</h2>
<h2 id="参考文献">参考文献</h2>
<p>1.<a href="https://www.cnblogs.com/mfrbuaa/p/5118361.html" target="_blank" rel="noopener">https://www.cnblogs.com/mfrbuaa/p/5118361.html</a><br>
2.<a href="https://stackoverflow.com/questions/2391679/why-do-we-need-virtual-functions-in-c" target="_blank" rel="noopener">https://stackoverflow.com/questions/2391679/why-do-we-need-virtual-functions-in-c</a><br>
3.<a href="https://stackoverflow.com/questions/8824359/why-use-virtual-functions" target="_blank" rel="noopener">https://stackoverflow.com/questions/8824359/why-use-virtual-functions</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/21/C-inline/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/21/C-inline/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">C inline</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-21 23:33:55" itemprop="dateCreated datePublished" datetime="2020-02-21T23:33:55+08:00">2020-02-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-25 15:06:02" itemprop="dateModified" datetime="2020-02-25T15:06:02+08:00">2020-02-25</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/C-C/" itemprop="url" rel="index"><span itemprop="name">C/C++</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="none"></h2>
<h2 id="参考文献">参考文献</h2>
<p>1.<a href="https://isocpp.org/wiki/faq/inline-functions" target="_blank" rel="noopener">https://isocpp.org/wiki/faq/inline-functions</a><br>
2.<a href="https://stackoverflow.com/questions/5971736/c-inline-function" target="_blank" rel="noopener">https://stackoverflow.com/questions/5971736/c-inline-function</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/21/C-final-and-override/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/21/C-final-and-override/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">C final and override</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-21 23:28:03" itemprop="dateCreated datePublished" datetime="2020-02-21T23:28:03+08:00">2020-02-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-22 01:06:13" itemprop="dateModified" datetime="2020-02-22T01:06:13+08:00">2020-02-22</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/C-C/" itemprop="url" rel="index"><span itemprop="name">C/C++</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="final"><code>final</code></h2>
<h2 id="override"><code>override</code></h2>
<h2 id="作用-使用场合-不用的后果">作用，使用场合，不用的后果。</h2>
<h2 id="参考文献">参考文献</h2>
<p>1.《C++ Primer》<br>
2.ttps://stackoverflow.com/questions/8824587/what-is-the-purpose-of-the-final-keyword-in-c11-for-functions<br>
3.<a href="https://en.cppreference.com/w/cpp/language/final" target="_blank" rel="noopener">https://en.cppreference.com/w/cpp/language/final</a><br>
4.<a href="https://stackoverflow.com/questions/99297/how-are-virtual-functions-and-vtable-implemented" target="_blank" rel="noopener">https://stackoverflow.com/questions/99297/how-are-virtual-functions-and-vtable-implemented</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/20/UNIX-system-function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/20/UNIX-system-function/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">UNIX system function</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-20 16:42:45 / 修改时间：22:27:16" itemprop="dateCreated datePublished" datetime="2020-02-20T16:42:45+08:00">2020-02-20</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UNIX/" itemprop="url" rel="index"><span itemprop="name">UNIX</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="system">system</h2>
<p>ISO C定义了<code>system</code>函数，它用来执行一个shell命令，对系统的依赖性很强。<code>system</code>库函数调用<code>fork</code>创建一个子进程使用<code>execl</code>执行参数<code>system</code>指定的shell命令。相当于:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execl(<span class="string">"/bin/sh"</span>, <span class="string">"sh"</span>, <span class="string">"-c"</span>, command, (<span class="keyword">char</span> *) <span class="number">0</span>);</span><br></pre></td></tr></table></figure></p>
<p>POSIX.1包括了<code>system</code>接口，扩展了ISO C定义，描述了<code>system</code>在POSIX.1环境中的运行行为。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">system</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *command)</span></span>;</span><br></pre></td></tr></table></figure>
<h2 id="属性">属性</h2>
<p><code>system</code>在其实现中调用了<code>fork</code>, <code>exec</code>和<code>waitpid</code>，可能有以下的返回值：</p>
<ol>
<li>如果<code>command</code>是一个空指针，当前系统是有可用的shell时，<code>system</code>返回非0值，否则返回0。在UNIX的各个实现中，一定提供了shell，当<code>command</code>是空指针时，总是返回非零值。</li>
<li><code>fork</code>失败或者<code>waitpid</code>返回处<code>EINTR</code>之外的出错，返回-1，设置errno。</li>
<li>如果<code>exec</code>失败，表示不能执行shell，返回值如同shell执行了exit(127)一样</li>
<li>所有三个函数都成功，<code>system</code>的返回值和在shell中执行相应命令的的termination status一样。</li>
</ol>
<h2 id="可能实现">可能实现</h2>
<p>其中一种<code>system</code>的可能实现如下所示：<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">system</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *cmdstring)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">pid_t</span> pid;</span><br><span class="line">    <span class="keyword">int</span> status;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(cmdstring == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ((pid = fork()) &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        status = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(pid == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        execl(<span class="string">"/bin/sh"</span>, <span class="string">"sh"</span>,  <span class="string">"-c"</span>, cmdstring, (<span class="keyword">char</span>*)<span class="number">0</span>);</span><br><span class="line">        _exit(<span class="number">127</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(waitpid(pid, &amp;status, <span class="number">0</span>) &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(errno != EINTR)</span><br><span class="line">            &#123;</span><br><span class="line">                status = <span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> status;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>使用<code>system</code>而不是直接使用<code>fork</code>和<code>exec</code>的好处是：<code>system</code>进行了各种所需要的各种出错处理和信号处理。但是早期的系统中，没有<code>waitpid</code>函数，于是父进程使用下列语句等待子进程结束：<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>((lastpid = wait(&amp;status) != pid &amp;&amp; lastpid !=<span class="number">-1</span>)</span><br><span class="line">    ;</span><br></pre></td></tr></table></figure></p>
<p>如果在调用<code>system</code>之前产生了其它子进程，如果这些子进程在<code>system</code>产生的子进程之前结束，那么上面的代码会将这些提前结束的子进程的进程ID和termination都给丢弃。<br>
<strong>system函数还有可能会出现漏洞。如果设置了set UID或者set GID位的程序执行<code>system</code>，那么这个进程的高级别权限可能会保持下来（现代的系统都解决了这个问题）。如果一个进程正在以特殊的权限(set UID和set GID)运行，它又想生成另一个进程执行另一个程序，它应该直接使用<code>fork</code>和<code>exec</code>，而且在<code>fork</code>之后，<code>exec</code>之前要改回普通权限，set UID和set GID程序绝不应该调用<code>system</code>函数。</strong></p>
<h2 id="参考文献">参考文献</h2>
<p>1.《APUE》第三版</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/20/UNIX-interpreter-file/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/20/UNIX-interpreter-file/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">UNIX interpreter file</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-20 16:41:39 / 修改时间：22:00:11" itemprop="dateCreated datePublished" datetime="2020-02-20T16:41:39+08:00">2020-02-20</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UNIX/" itemprop="url" rel="index"><span itemprop="name">UNIX</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="解释器文件">解释器文件</h2>
<p>所有的UNIX系统都支持解释器文件。这种文件是文本文件，起始形式是：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#! pathname [optional-argument]</span><br></pre></td></tr></table></figure></p>
<p>在感叹号和pathname之间的空格是可以选的。常见的解释器文件以下列行开始：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>! /bin/bash</span><br></pre></td></tr></table></figure></p>
<p>pathname通常是绝对路径名，识别这种文件是<code>exec</code>系统调用处理的一部分。内核使调用<code>exec</code>函数的进程实际执行的并不是该<strong>解释器文件</strong>，而是在该解释器文件第一行中pathname指定的文件，即解释器。<br>
<strong>解释器文件是文本文件，它以!#开头，而解释器是二进制文件，由解释器中的文件第一行的pathname指定。</strong></p>
<h2 id="解释器文件的好处">解释器文件的好处</h2>
<p>是否一定需要解释器文件呢？不完全如此，但是它们确实使得用户得到效率方面的好处，代价是内核的额外开销，因为识别解释器文件的是内核。由于下列原因，解释器文件是有用的：</p>
<ol>
<li>有些程序是用某种脚本语言写的脚本，解释器文件可以将这一事实隐藏起来。</li>
<li>解释器脚本在效率方面提供了好处。</li>
<li>解释器脚本使我们可以使用除了/bin/sh以外的其他shell编写shell脚本。</li>
</ol>
<h2 id="参考文献">参考文献</h2>
<ol>
<li>《APUE》第三版</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2020/02/20/UNIX-id/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/02/20/UNIX-id/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/2/index.html">UNIX id</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-20 15:03:12" itemprop="dateCreated datePublished" datetime="2020-02-20T15:03:12+08:00">2020-02-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-21 12:31:42" itemprop="dateModified" datetime="2020-02-21T12:31:42+08:00">2020-02-21</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UNIX/" itemprop="url" rel="index"><span itemprop="name">UNIX</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="和进程相关的id">和进程相关的ID</h2>
<ol>
<li>每个进程都有一个进程ID(pid)，还有一个父进程ID(ppid)。<br>
除此之外，每个进程还有以下ID:</li>
<li>实际用户ID，实际组ID。实际用户ID和实际组ID就是当前用户的UID和GID。</li>
<li>有效用户ID，有效组ID，附属组ID。通常情况下，实际用户ID和有效用户ID是一样的，实际组ID和有效组ID也是一样的。</li>
<li>保存的设置用户ID，保存的设置组ID，它们包含了执行一个程序时有效U(G)ID的副本。可以在st_mode中设置set-user-ID和set-group-ID位（这个和保存的设置U(G)ID不是一个东西），表示，当执此文件时，将进程的有效用户ID设置成文件所有者的UID，或者将进程的有效组ID设置称为文件所有组的GID，通过<code>exec</code>实现。</li>
<li>进程组ID。每一个进程都属于一个进程组。一个进程只能为自己或者它的子进程设置进程组ID，在它的子进程调用了exec之后，它就不能再更改子进程的进程组ID了。</li>
<li>会话ID。一个session可以有多个进程组，一个session可以有一个控制控制（终端设备或者伪终端设备）。如果进程调用setsid()创建一个新的session，那么这个进程没有控制终端。</li>
</ol>
<h2 id="访问进程的各种id">访问进程的各种ID</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pid_t</span> getpid(<span class="keyword">void</span>);</span><br><span class="line"><span class="keyword">pid_t</span> getppid(<span class="keyword">void</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">uid_t</span> getuid(<span class="keyword">void</span>);</span><br><span class="line"><span class="keyword">uid_t</span> geteuid(<span class="keyword">void</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">gid_t</span> getgid(<span class="keyword">void</span>);</span><br><span class="line"><span class="keyword">gid_t</span> getegid(<span class="keyword">void</span>);</span><br></pre></td></tr></table></figure>
<h2 id="修改进程相关的id">修改进程相关的ID</h2>
<h3 id="同时设置实际-有效和保存的设置id">同时设置实际，有效和保存的设置ID</h3>
<ol>
<li>使用<code>setxid</code>设置进程的实际U(G)ID，有效U(G)ID，保存的设置U(G)ID：<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">setuid</span><span class="params">(<span class="keyword">uid_t</span> uid)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">setgid</span><span class="params">(<span class="keyword">gid_t</span> gid)</span></span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>关于修改的规则，有三条：<br>
1. 如果是root用户，可以将三个ID都设置为u(g)id。<br>
2. 如果不是root用户，但是uid和实际用户id一样，可以将有效uid改为uid，其他不变。<br>
3. 否则，出错。</p>
<ol start="2">
<li>使用此外，调用<code>exec</code>也可能会更改有效U(G)ID和保存的设置U(G)ID。无论是否设置set-user(group)-id，实际U(G)ID都不变；当设置U(G)ID位打开时，将有效U(G)ID设置为程序文件的UID，否则有效U(G)ID不变，保存的set-user(group)-id都是从有效U(G)ID复制。</li>
</ol>
<p>总结得到以下的表格：</p>
<table>
<thead>
<tr>
<th style="text-align:center">ID</th>
<th style="text-align:center"></th>
<th style="text-align:center"><code>exec</code></th>
<th style="text-align:center"></th>
<th style="text-align:center"><code>setuid</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">set-user-ID位关闭</td>
<td style="text-align:center">set-user-ID位开启</td>
<td style="text-align:center">超级用户</td>
<td style="text-align:center">非超级用户</td>
</tr>
<tr>
<td style="text-align:center">real UID</td>
<td style="text-align:center">不变</td>
<td style="text-align:center">不变</td>
<td style="text-align:center">设置为uid</td>
<td style="text-align:center">不变</td>
</tr>
<tr>
<td style="text-align:center">effective UID</td>
<td style="text-align:center">不变</td>
<td style="text-align:center">程序文件的UID</td>
<td style="text-align:center">设置为uid</td>
<td style="text-align:center">设置为uid</td>
</tr>
<tr>
<td style="text-align:center">saved set-UID</td>
<td style="text-align:center">从effective ID复制</td>
<td style="text-align:center">从effective ID复制</td>
<td style="text-align:center">设置为uid</td>
<td style="text-align:center">不变</td>
</tr>
</tbody>
</table>
<h3 id="设置有效id">设置有效ID</h3>
<p>设置进程的有效U(G)ID。如果是普通用户，可以将有效U(G)ID设置为实际U(G)ID或者保存的设置U(G)ID，如果是特权用户，可以将有效U(G)ID设置为u(g)id：<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">seteuid</span><span class="params">(<span class="keyword">uid_t</span> uid)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">setegid</span><span class="params">(<span class="keyword">gid_t</span> gid)</span></span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="交换实际id和有效id">交换实际ID和有效ID</h3>
<p>交换进程的实际U(G)ID和有效U(G)ID。对于普通用户，可以交换实际U(G)ID和有效U(G)ID；还可以允许普通用户将有效U(G)ID设置为保存的设置U(G)ID。<br>
某个参数设置为1，表示相应的ID不变。<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">setreuid</span><span class="params">(<span class="keyword">uid_t</span> ruid, <span class="keyword">uid_t</span> euid)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">setregid</span><span class="params">(<span class="keyword">uid_t</span> rgid, <span class="keyword">uid_t</span> egid)</span></span>;</span><br></pre></td></tr></table></figure></p>
<h2 id="参考文献">参考文献</h2>
<p>1.《APUE》</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/34/">34</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/favicon.jpg" alt="马晓鑫爱马荟荟">
            
              <p class="site-author-name" itemprop="name">马晓鑫爱马荟荟</p>
              <p class="site-description motion-element" itemprop="description">记录硕士三年自己的积累</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">334</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">25</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">75</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/mxxhcm" title="GitHub &rarr; https://github.com/mxxhcm" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:mxxhcm@gmail.com" title="E-Mail &rarr; mailto:mxxhcm@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">马晓鑫爱马荟荟</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v6.6.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script src="/js/src/utils.js?v=6.6.0"></script>

  <script src="/js/src/motion.js?v=6.6.0"></script>



  
  


  <script src="/js/src/affix.js?v=6.6.0"></script>

  <script src="/js/src/schemes/pisces.js?v=6.6.0"></script>



  

  


  <script src="/js/src/bootstrap.js?v=6.6.0"></script>



  



  






<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    







  





  

  

  

  

  
  

  
  
    
      
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<style>
.MathJax_Display {
    overflow: auto hidden;
}
</style>

    
  


  
  

  

  

  

  

  

  

</body>
</html>
