<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
































<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">



  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.jpg?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.jpg?v=6.6.0">










<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.6.0',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
<meta property="og:type" content="website">
<meta property="og:title" content="mxxhcm&#39;s blog">
<meta property="og:url" content="http://mxxhcm.github.io/page/14/index.html">
<meta property="og:site_name" content="mxxhcm&#39;s blog">
<meta property="og:description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mxxhcm&#39;s blog">
<meta name="twitter:description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">



  <link rel="alternate" href="/atom.xml" title="mxxhcm's blog" type="application/atom+xml">




  <link rel="canonical" href="http://mxxhcm.github.io/page/14/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>mxxhcm's blog</title>
  












  <noscript>
  <style>
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion .logo-line-before i { left: initial; }
    .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">mxxhcm's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>åˆ†ç±»</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/03/07/tensorflow-problems/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/07/tensorflow-problems/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">tensorflow å¸¸è§é—®é¢˜ï¼ˆä¸å®šæœŸæ›´æ–°ï¼‰</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-03-07 14:51:01" itemprop="dateCreated datePublished" datetime="2019-03-07T14:51:01+08:00">2019-03-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-07-18 20:27:16" itemprop="dateModified" datetime="2019-07-18T20:27:16+08:00">2019-07-18</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/tensorflow/" itemprop="url" rel="index"><span itemprop="name">tensorflow</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="é—®é¢˜1-the-value-of-a-feed-cannot-be-a-tf-tensor-object">é—®é¢˜1-The value of a feed cannot be a tf.Tensor object</h2>
<h3 id="æŠ¥é”™">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypeError: The value of a feed cannot be a tf.Tensor object</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜åŸå› ">é—®é¢˜åŸå› </h3>
<p>sess.run(op, feed_dict={})ä¸­çš„feed valueä¸èƒ½æ˜¯tf.Tensorç±»å‹ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</h3>
<p>sess.run(train, feed_dict={x:images, y:labels}çš„è¾“å…¥ä¸èƒ½æ˜¯tensorï¼Œå¯ä»¥ä½¿ç”¨sess.run(tensor)å¾—åˆ°numpy.arrayå½¢å¼çš„æ•°æ®å†å–‚ç»™feed_dictã€‚</p>
<blockquote>
<p>Once you have launched a sess, you can use your_tensor.eval(session=sess) or sess.run(your_tensor) to get you feed tensor into the format of numpy.array and then feed it to your placeholder.</p>
</blockquote>
<h2 id="é—®é¢˜2-could-not-create-cudnn-handle-cudnn-status-internal-error">é—®é¢˜2-Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR</h2>
<h3 id="é…ç½®">é…ç½®</h3>
<p>ç¯å¢ƒé…ç½®å¦‚ä¸‹ï¼š</p>
<ul>
<li>Ubuntu 18.04</li>
<li>CUDA 10.0</li>
<li>CuDNN 7.4.2</li>
<li>Python3.7.3</li>
<li>Tensorflow 1.13.1</li>
<li>Nvidia Drivers 430.09</li>
<li>RTX2070</li>
</ul>
<h3 id="æŠ¥é”™-v2">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">2019-05-12 14:45:59.355405: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR</span><br><span class="line">2019-05-12 14:45:59.357698: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜åŸå› -v2">é—®é¢˜åŸå› </h3>
<p>GPUä¸å¤Ÿç”¨äº†ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-v2">è§£å†³æ–¹æ³•</h3>
<p>åœ¨ä»£ç ä¸­æ·»åŠ ä¸‹é¢å‡ å¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">config = tf.ConfigProto()</span><br><span class="line">config.gpu_options.allow_growth = <span class="literal">True</span></span><br><span class="line">session = InteractiveSession(config=config)</span><br></pre></td></tr></table></figure>
<h2 id="é—®é¢˜3-libcublas-so-10-0-cannot-open-shared-object-file-no-such-file-or-directory">é—®é¢˜3-libcublas.so.10.0: cannot open shared object file: No such file or directory</h2>
<p>åœ¨å‘½ä»¤è¡Œæˆ–è€…pycharmä¸­import tensorflowæŠ¥é”™</p>
<h3 id="æŠ¥é”™-v3">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ImportError: libcublas.so.10.0: cannot open shared object file: No such file or directory</span><br><span class="line">Failed to load the native TensorFlow runtime.</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜åŸå› -v3">é—®é¢˜åŸå› </h3>
<p>æ²¡æœ‰é…ç½®CUDAç¯å¢ƒå˜é‡</p>
<h3 id="è§£å†³æ–¹æ³•-v3">è§£å†³æ–¹æ³•</h3>
<h4 id="å‘½ä»¤è¡Œä¸­">å‘½ä»¤è¡Œä¸­</h4>
<p>åœ¨.bashrcæ–‡ä»¶ä¸­åŠ å…¥ä¸‹åˆ—è¯­å¥ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/usr/local/cuda/bin$&#123;PATH:+:$&#123;PATH&#125;&#125;</span><br><span class="line">export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$&#123;LD_LIBRARY_PATH:+:$&#123;LD_LIBRARY_PATH&#125;&#125;</span><br><span class="line">export CUDA_HOME=/usr/local/cuda</span><br></pre></td></tr></table></figure>
<h4 id="pycharmä¸­">pycharmä¸­</h4>
<h5 id="æ–¹æ³•1-è¿™ç§æ–¹æ³•æˆ‘æ²¡æœ‰å®éªŒæˆåŠŸ-ä¸çŸ¥é“ä¸ºä»€ä¹ˆ">æ–¹æ³•1ï¼ˆè¿™ç§æ–¹æ³•æˆ‘æ²¡æœ‰å®éªŒæˆåŠŸï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰</h5>
<p>åœ¨å·¦ä¸Šè§’é€‰ä¸­<br>
File&gt;&gt;Settings&gt;&gt;Build.Execution,Deployment&gt;&gt;Console&gt;&gt;Python Console<br>
åœ¨Environmentä¸‹çš„Environment variablesä¸­æ·»åŠ <br>
LD_LIBRARY_PATH=/usr/local/cuda/lib64:${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}å³å¯ã€‚</p>
<h5 id="æ–¹æ³•2">æ–¹æ³•2</h5>
<p>ä¿®æ”¹å®Œ.bashrcæ–‡ä»¶åä»ç»ˆç«¯ä¸­è¿è¡Œpycharmã€‚</p>
<h2 id="é—®é¢˜4-dlerror-libcupti-so-10-0-cannot-open-shared-object-file-no-such-file-or-directory">é—®é¢˜4-dlerror: libcupti.so.10.0: cannot open shared object file: No such file or directory</h2>
<p>æ‰§è¡Œmnist_with_summaryä»£ç æ—¶æŠ¥é”™</p>
<h3 id="æŠ¥é”™-v4">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">I tensorflow/stream_executor/dso_loader.cc:142] Couldn&apos;t open CUDA library libcupti.so.10.0. LD_LIBRARY_PATH: /usr/local/cuda/lib64:</span><br><span class="line">2019-05-13 23:04:10.620149: F tensorflow/stream_executor/lib/statusor.cc:34] Attempting to fetch value instead of handling error Failed precondition: could not dlopen DSO: libcupti.so.10.0; dlerror: libcupti.so.10.0: cannot open shared object file: No such file or directory</span><br><span class="line">Aborted (core dumped)</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜åŸå› ">é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜é—®é¢˜åŸå› </h3>
<p>libcupti.so.10.0åŒ…æ²¡æ‰¾åˆ°</p>
<h3 id="è§£å†³æ–¹æ³•-v4">è§£å†³æ–¹æ³•</h3>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ‰¾åˆ°ç›¸å…³çš„ä¾èµ–åŒ…ï¼š<br>
~$:find /usr/local/cuda/ -name libcupti.so.10.0<br>
è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<blockquote>
<p>/usr/local/cuda/extras/CUPTI/lib64/libcupti.so.10.0</p>
</blockquote>
<p>ç„¶åä¿®æ”¹~/.bashrcæ–‡ä»¶ä¸­ç›¸åº”çš„ç¯å¢ƒå˜é‡:<br>
export LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/ğŸ˜’{LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}<br>
é‡æ–°è¿è¡Œå³å¯ã€‚</p>
<h2 id="é—®é¢˜5-unhashable-type-list">é—®é¢˜5-unhashable type: â€˜listâ€™</h2>
<p>sess.run(op, feed_dict={})ä¸­feedçš„æ•°æ®ä¸­åŒ…å«æœ‰listçš„æ—¶å€™ä¼šæŠ¥é”™ã€‚</p>
<h3 id="æŠ¥é”™-v5">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypeError: unhashable type: &apos;list&apos;</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜åŸå› -v4">é—®é¢˜åŸå› </h3>
<p>feed_dictä¸­ä¸èƒ½çš„valueä¸èƒ½æ˜¯listã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-v5">è§£å†³æ–¹æ³•</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">feed_dict = &#123;</span><br><span class="line">               placeholder : value </span><br><span class="line">                  <span class="keyword">for</span> placeholder, value <span class="keyword">in</span> zip(placeholder_list, inputs_list))</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä»£ç ç¤ºä¾‹">ä»£ç ç¤ºä¾‹</h3>
<p><a href="https://github.com/mxxhcm/code/blob/master/tf/ops/tf_placeholder_list.py" target="_blank" rel="noopener">ä»£ç åœ°å€</a></p>
<h2 id="é—®é¢˜6-attempting-to-use-uninitialized-value">é—®é¢˜6-Attempting to use uninitialized value</h2>
<p>tf.Session()å’Œtf.InteractiveSession()æ··ç”¨é—®é¢˜ã€‚</p>
<h3 id="æŠ¥é”™-v6">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tensorflow.python.framework.errors_impl.FailedPreconditionError: Attempting to use uninitialized value prediction/l1/w</span><br><span class="line">	 [[&#123;&#123;node prediction/l1/w/read&#125;&#125;]]</span><br><span class="line">	 [[&#123;&#123;node prediction/LogSoftmax&#125;&#125;]]</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜åŸå› -v5">é—®é¢˜åŸå› </h3>
<p>å£°æ˜äº†å¦‚ä¸‹session:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sess = tf.Session()</span><br><span class="line">sess.run(tf.global_variables_initializer())</span><br></pre></td></tr></table></figure>
<p>åœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ï¼Œå› ä¸ºæˆ‘å£°æ˜çš„æ˜¯tf.Session()ï¼Œä½¿ç”¨äº†op.eval()å‡½æ•°ï¼Œè¿™ç§ç”¨æ³•æ˜¯tf.InteractiveSessionçš„ç”¨æ³•ï¼Œæ‰€ä»¥å°±ç›¸å½“äºæ²¡æœ‰åˆå§‹åŒ–ã€‚<br>
result = op.eval(feed_dict={})<br>
ç„¶åå°±æŠ¥äº†æœªåˆå§‹åŒ–çš„é”™è¯¯ã€‚<br>
æŠŠä»£ç æ”¹æˆï¼š<br>
result = sess.run([op], feeed_dct={})<br>
å³å¯ï¼Œå³ä¸Šä¸‹æ–‡ä½¿ç”¨çš„sessionåº”è¯¥ä¸€è‡´ã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h3>
<p>ä½¿ç”¨ç»Ÿä¸€çš„sessionç±»å‹</p>
<h2 id="é—®é¢˜7-setting-an-array-element-with-a-sequence">é—®é¢˜7-setting an array element with a sequence</h2>
<p>feed_dicté”®å€¼å¯¹ä¸­ä¸­å€¼å¿…é¡»æ˜¯numpy.ndarrayï¼Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹ã€‚</p>
<h3 id="æŠ¥é”™-v7">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value error setting an array element with a sequence,</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜åŸå› -v6">é—®é¢˜åŸå› </h3>
<p>feed_dictä¸­key-valueçš„valueå¿…é¡»æ˜¯numpy.ndarrayï¼Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹ï¼Œå°¤å…¶ä¸èƒ½æ˜¯tf.Variableã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-v6">è§£å†³æ–¹æ³•</h3>
<p>æ£€æŸ¥sess.run(op, feed_dict={})ä¸­çš„feed_dictï¼Œç¡®ä¿ä»–ä»¬çš„ç±»å‹ï¼Œä¸èƒ½æ˜¯tf.Variable()ç±»å‹çš„å¯¹è±¡ï¼Œéœ€è¦æ˜¯numpy.ndarrayã€‚</p>
<h2 id="é—®é¢˜8-è®¿é—®tf-variable-çš„å€¼">é—®é¢˜8-è®¿é—®tf.Variable()çš„å€¼</h2>
<p>å¦‚ä½•è·å¾—tf.Variable()å¯¹è±¡çš„å€¼</p>
<h3 id="è§£å†³æ–¹æ³•-v7">è§£å†³æ–¹æ³•</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line">x = tf.Varialbe([<span class="number">1.0</span>, <span class="number">2.0</span>])</span><br><span class="line">sess = tf.Session()</span><br><span class="line">sess.run(tf.global_variables_initializer())</span><br><span class="line">value = sess.run(x)</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import tensorflow as tf</span><br><span class="line">x = tf.Varialbe([1.0, 2.0])</span><br><span class="line">sess = tf.InteractiveSession()</span><br><span class="line">sess.run(tf.global_variables_initializer())</span><br><span class="line">x.eval()</span><br></pre></td></tr></table></figure>
<h2 id="é—®é¢˜9-can-not-convert-a-ndarray-into-a-tensor-or-operation">é—®é¢˜9-Can not convert a ndarray into a Tensor or Operation</h2>
<h3 id="æŠ¥é”™-v8">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Can not convert a ndarray into a Tensor or Operation.</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜åŸå› -v7">é—®é¢˜åŸå› </h3>
<p>åŸå› æ˜¯sess.run()å‰åå‚æ•°åé‡äº†ï¼Œæ¯”å¦‚outputs = sess.run(outputs)ï¼Œoutputsæœ¬æ¥æ˜¯è‡ªå·±å®šä¹‰çš„ä¸€ä¸ªopï¼Œä½†æ˜¯sess.run(outputs)ä¹‹åoutputså°±æˆäº†ä¸€ä¸ªå˜é‡ï¼Œå°±æŠŠå®šä¹‰çš„outputs opè¦†ç›–äº†ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-v8">è§£å†³æ–¹æ³•</h3>
<p>æ¢ä¸ªå˜é‡åå­—å°±è¡Œ</p>
<h2 id="é—®é¢˜10-æœ¬åœ°ä½¿ç”¨gpu-serverçš„tensorboard">é—®é¢˜10-æœ¬åœ°ä½¿ç”¨gpu serverçš„tensorboard</h2>
<h3 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h3>
<p>åœ¨gpu serverè·‘çš„å®éªŒç»“æœï¼Œç„¶åsummaryçš„è®°å½•ä¹Ÿåœ¨serverä¸Šï¼Œä½†æ˜¯åˆæ²¡åŠæ³•å¯è§†åŒ–ï¼Œåªå¥½åœ¨æœ¬åœ°å¯è§†åŒ–ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-v9">è§£å†³æ–¹æ³•</h3>
<p>ä½¿ç”¨sshè¿›è¡Œæ˜ å°„å¥½äº†ã€‚</p>
<h4 id="æœ¬æœºè®¾ç½®">æœ¬æœºè®¾ç½®</h4>
<p>~$:ssh -L 12345:10.1.114.50:6006 <a href="mailto:mxxmhh@127.0.0.1" target="_blank" rel="noopener">mxxmhh@127.0.0.1</a><br>
å°†æœ¬æœºçš„12345ç«¯å£æ˜ å°„åˆ°10.1.114.50çš„6006ç«¯å£ï¼Œä¸­é—´æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯æœ¬æœºã€‚<br>
æˆ–è€…å¯ä»¥ä½¿ç”¨10.1.114.50ä½œä¸ºä¸­é—´æœåŠ¡å™¨ã€‚<br>
~$:ssh -L 12345:10.1.114.50:6006 <a href="mailto:liuchi@10.1.114.50" target="_blank" rel="noopener">liuchi@10.1.114.50</a><br>
æˆ–è€…å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š<br>
~$:ssh -L 12345:127.0.0.1:6006 <a href="mailto:liuchi@10.1.114.50" target="_blank" rel="noopener">liuchi@10.1.114.50</a><br>
ä»è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œå¯ä»¥çœ‹å‡º127.0.0.1è¿™ä¸ªipæ˜¯ä¸­é—´æœåŠ¡å™¨å¯ä»¥è®¿é—®çš„ipã€‚<br>
ä»¥ä¸Šä¸‰ç§æ–¹æ³•ä¸­ï¼Œ-Låçš„ç«¯å£å·12345å¯ä»¥éšæ„è®¾ç½®ï¼Œåªè¦ä¸å†²çªå³å¯ã€‚</p>
<h4 id="æœåŠ¡ç«¯è®¾ç½®">æœåŠ¡ç«¯è®¾ç½®</h4>
<p>ç„¶ååœ¨æœåŠ¡ç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br>
~$:tensorboard --logdir logdir -port 6006<br>
è¿™ä¸ªç«¯å£å·ä¹Ÿæ˜¯å¯ä»¥ä»»æ„è®¾ç½®çš„ï¼Œä¸å†²çªå³å¯ã€‚</p>
<h4 id="è¿è¡Œ">è¿è¡Œ</h4>
<p>ç„¶ååœ¨æœ¬æœºè®¿é—®<br>
<a href="https://127.0.0.1:12345" target="_blank" rel="noopener">https://127.0.0.1:12345</a>å³å¯ã€‚</p>
<h2 id="é—®é¢˜11-æ¯ä¸€æ­¥summaryä¸€ä¸ªlistçš„æ¯ä¸€ä¸ªå…ƒç´ ">é—®é¢˜11-æ¯ä¸€æ­¥summaryä¸€ä¸ªlistçš„æ¯ä¸€ä¸ªå…ƒç´ </h2>
<h3 id="é—®é¢˜åŸå› -v8">é—®é¢˜åŸå› </h3>
<p>æœ‰ä¸€ä¸ªtf listçš„placeholderï¼Œä½†æ˜¯æ¯ä¸€æ­¥åªèƒ½ç”Ÿæˆå…¶ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥æ€ä¹ˆæ ·summaryä¸­å…¶ä¸­çš„æŸä¸€ä¸ªï¼Ÿ</p>
<h3 id="è§£å†³æ–¹æ³•-v10">è§£å†³æ–¹æ³•</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import tensorflow as tf</span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line">number = 3</span><br><span class="line">x_ph_list = []</span><br><span class="line">for i in range(number):</span><br><span class="line">    x_ph_list.append(tf.placeholder(tf.float32, shape=None))</span><br><span class="line"></span><br><span class="line">x_summary_list = []</span><br><span class="line">for i in range(number):</span><br><span class="line">    x_summary_list.append(tf.summary.scalar("x%s" % i, x_ph_list[i]))</span><br><span class="line"></span><br><span class="line">writer = tf.summary.FileWriter("./tf_summary/scalar_list_summary/sep")</span><br><span class="line">with tf.Session() as sess:</span><br><span class="line">    scope = 10</span><br><span class="line">    inputs = np.arange(scope*number)</span><br><span class="line">    inputs = inputs.reshape(scope, number)</span><br><span class="line">    # inputs = np.random.randn(scope, number)</span><br><span class="line">    for i in range(scope):</span><br><span class="line">        for j in range(number):</span><br><span class="line">            out, xj_s = sess.run([x_ph_list[j], x_summary_list[j]], feed_dict=&#123;x_ph_list[j]: inputs[i][j]&#125;)</span><br><span class="line">            writer.add_summary(xj_s, global_step=i)</span><br></pre></td></tr></table></figure>
<h2 id="é—®é¢˜12-for-value-in-summary-value-attributeerror-list-object-has-no-attribute-value">é—®é¢˜12- for value in summary.value: AttributeError: â€˜listâ€™ object has no attribute â€˜valueâ€™</h2>
<h3 id="é—®é¢˜æè¿°-v2">é—®é¢˜æè¿°</h3>
<p>writer.add_summaryæ—¶æŠ¥é”™</p>
<h3 id="æŠ¥é”™-v9">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">File &quot;/home/mxxmhh/anaconda3/lib/python3.7/site-packages/tensorflow/python/summary/writer/writer.py&quot;, line 127, in add_summary</span><br><span class="line">    for value in summary.value:</span><br><span class="line">AttributeError: &apos;list&apos; object has no attribute &apos;value&apos;</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜åŸå› -v9">é—®é¢˜åŸå› </h3>
<p>æ‰§è¡Œä»¥ä¸‹ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s_ = sess.run([loss_summary], feed_dict=&#123;p_losses_ph: inputs1, q_losses_ph: inputs2&#125;)</span><br><span class="line">writer.add_summary(s_, global_step=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>å› ä¸º[loss_summary]åŠ äº†æ–¹æ‹¬å·ï¼Œå°±æŠŠå®ƒå½“æˆäº†ä¸€ä¸ªlistã€‚ã€‚è¿”å›å€¼ä¹Ÿæ˜¯listï¼Œå°±æŠ¥é”™äº†</p>
<h3 id="è§£å†³æ–¹æ³•-v11">è§£å†³æ–¹æ³•</h3>
<ul>
<li>æ–¹æ³•1ï¼Œåœ¨ç­‰å·å·¦è¾¹åŠ ä¸€ä¸ªé€—å·ï¼Œå–å‡ºlistä¸­çš„å€¼</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s_, = sess.run([loss_summary], feed_dict=&#123;p_losses_ph: inputs1, q_losses_ph: inputs2&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>æ–¹æ³•2ï¼Œå»æ‰loss_summaryå¤–é¢çš„ä¸­æ‹¬å·ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s_ = sess.run(loss_summary, feed_dict=&#123;p_losses_ph: inputs1, q_losses_ph: inputs2&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="é—®é¢˜13-tf-get-default-session-always-returns-none-type">é—®é¢˜13- tf.get_default_session() always returns None type:</h2>
<h3 id="é—®é¢˜æè¿°-v3">é—®é¢˜æè¿°</h3>
<p>è°ƒç”¨tf.get_default_session()æ—¶ï¼Œè¿”å›çš„æ˜¯None</p>
<h3 id="æŠ¥é”™-v10">æŠ¥é”™</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    tf.get_default_session().run(y)</span><br><span class="line">AttributeError: &apos;NoneType&apos; object has no attribute &apos;run&apos;</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜åŸå› -v10">é—®é¢˜åŸå› </h3>
<p>åªæœ‰åœ¨è®¾å®šdefault sessionä¹‹åï¼Œæ‰èƒ½ä½¿ç”¨tf.get_default_session()è·å¾—å½“å‰çš„é»˜è®¤sessionï¼Œåœ¨æˆ‘ä»¬å†™ä»£ç çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šæŒ‰ç…§ä¸‹é¢çš„æ–¹å¼å†™ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    some operations</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p>è¿™ç§æƒ…å†µä¸‹å·²ç»æŠŠtf.Session()ç”Ÿæˆçš„sessionå½“åšäº†é»˜è®¤sessionï¼Œä½†æ˜¯å¦‚æœä»…ä»…ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">sess =  tf.Session()</span><br><span class="line">sess.run(some operations)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>æ˜¯æ²¡æœ‰æŠŠtf.Session()å½“æˆé»˜è®¤sessionçš„ï¼Œå³åªæœ‰åœ¨with blockå†…ï¼Œæ‰ä¼šå°†è¿™ä¸ªsessionå½“åšé»˜è®¤sessionã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ-v2">è§£å†³æ–¹æ¡ˆ</h3>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<p>1.<a href="https://github.com/tensorflow/tensorflow/issues/4842" target="_blank" rel="noopener">https://github.com/tensorflow/tensorflow/issues/4842</a><br>
2.<a href="https://github.com/tensorflow/tensorflow/issues/24496" target="_blank" rel="noopener">https://github.com/tensorflow/tensorflow/issues/24496</a><br>
3.<a href="https://github.com/tensorflow/tensorflow/issues/9530" target="_blank" rel="noopener">https://github.com/tensorflow/tensorflow/issues/9530</a><br>
4.<a href="https://stackoverflow.com/questions/51128427/how-to-feed-list-of-values-to-a-placeholder-list-in-tensorflow" target="_blank" rel="noopener">https://stackoverflow.com/questions/51128427/how-to-feed-list-of-values-to-a-placeholder-list-in-tensorflow</a><br>
5.<a href="https://github.com/tensorflow/tensorflow/issues/11897" target="_blank" rel="noopener">https://github.com/tensorflow/tensorflow/issues/11897</a><br>
6.<a href="https://stackoverflow.com/questions/34156639/tensorflow-python-valueerror-setting-an-array-element-with-a-sequence-in-t" target="_blank" rel="noopener">https://stackoverflow.com/questions/34156639/tensorflow-python-valueerror-setting-an-array-element-with-a-sequence-in-t</a><br>
7.<a href="https://stackoverflow.com/questions/33679382/how-do-i-get-the-current-value-of-a-variable" target="_blank" rel="noopener">https://stackoverflow.com/questions/33679382/how-do-i-get-the-current-value-of-a-variable</a><br>
8.<a href="https://blog.csdn.net/michael__corleone/article/details/79007425" target="_blank" rel="noopener">https://blog.csdn.net/michael__corleone/article/details/79007425</a><br>
9.<a href="https://stackoverflow.com/questions/47721792/tensorflow-tf-get-default-session-after-sess-tf-session-is-none" target="_blank" rel="noopener">https://stackoverflow.com/questions/47721792/tensorflow-tf-get-default-session-after-sess-tf-session-is-none</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/03/04/lycheeå›¾åºŠæ­å»º/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/04/lycheeå›¾åºŠæ­å»º/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">lycheeå›¾åºŠæ­å»º</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-03-04 21:03:55" itemprop="dateCreated datePublished" datetime="2019-03-04T21:03:55+08:00">2019-03-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-07 00:22:27" itemprop="dateModified" datetime="2019-05-07T00:22:27+08:00">2019-05-07</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/å·¥å…·/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å®‰è£…">å®‰è£…</h2>
<h3 id="åŸºæœ¬è¦æ±‚">åŸºæœ¬è¦æ±‚</h3>
<ol>
<li>web server (Apache, nginx, etc)</li>
<li>A MySQL database (MariaDB also works)</li>
<li>PHP 7.1 or later with the following extensions: session, exif, mbstring, gd, mysqli, json, zip, and optionally, imagick<br>
~#:apt install nginx<br>
~#:apt install mysql-server<br>
~#:apt install php</li>
</ol>
<h3 id="é…ç½®nginx">é…ç½®nginx</h3>
<p>é‡æ–°å®‰è£…nginxå‡ºç°é—®é¢˜ï¼Œè§å‚è€ƒæ–‡çŒ®2ã€‚</p>
<h3 id="é…ç½®mysql">é…ç½®mysql</h3>
<p>~#:mysql -u root -p<br>
é»˜è®¤å¯†ç æ˜¯å›è½¦ï¼Ÿï¼Ÿï¼Ÿ<br>
ä¿®æ”¹å¯†ç <br>
~#:</p>
<h3 id="é…ç½®php">é…ç½®php</h3>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<p>1.<a href="https://juejin.im/post/5c1b869b6fb9a049ad770424" target="_blank" rel="noopener">https://juejin.im/post/5c1b869b6fb9a049ad770424</a><br>
2.<a href="https://segmentfault.com/a/1190000014027697?utm_source=tag-newest" target="_blank" rel="noopener">https://segmentfault.com/a/1190000014027697?utm_source=tag-newest</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/03/04/linux-æŸ¥çœ‹python-packageçš„å®‰è£…ä½ç½®/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/04/linux-æŸ¥çœ‹python-packageçš„å®‰è£…ä½ç½®/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">linux-æŸ¥çœ‹python packageçš„å®‰è£…ä½ç½®</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-03-04 14:52:16" itemprop="dateCreated datePublished" datetime="2019-03-04T14:52:16+08:00">2019-03-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-12 12:03:26" itemprop="dateModified" datetime="2019-05-12T12:03:26+08:00">2019-05-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä½¿ç”¨pip install package-nameä¹‹åï¼Œä¸çŸ¥é“è¯¥åŒ…å­˜åœ¨äº†å“ªä¸ªè·¯å¾„ä¸‹ã€‚<br>
å¯ä»¥å†æ¬¡ä½¿ç”¨pip install package-nameï¼Œè¿™æ—¶å€™å°±ä¼šç»™å‡ºè¯¥åŒ…å­˜æ”¾åœ¨å“ªä¸ªè·¯å¾„ä¸‹ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<ol>
<li><a href="https://blog.csdn.net/weixin_41712059/article/details/82940516" target="_blank" rel="noopener">https://blog.csdn.net/weixin_41712059/article/details/82940516</a></li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/03/04/linux-shadowsocksæœåŠ¡ç«¯ä»¥åŠå®¢æˆ·ç«¯é…ç½®/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/04/linux-shadowsocksæœåŠ¡ç«¯ä»¥åŠå®¢æˆ·ç«¯é…ç½®/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">shadowsocksæœåŠ¡ç«¯ä»¥åŠå®¢æˆ·ç«¯é…ç½®</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-03-04 13:03:57" itemprop="dateCreated datePublished" datetime="2019-03-04T13:03:57+08:00">2019-03-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-06-19 11:39:56" itemprop="dateModified" datetime="2019-06-19T11:39:56+08:00">2019-06-19</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="æœåŠ¡å™¨ç«¯é…ç½®">æœåŠ¡å™¨ç«¯é…ç½®</h2>
<p>é¦–å…ˆéœ€è¦æœ‰ä¸€ä¸ªVPSè´¦å·ï¼Œvultr,digitalocean,æ¬ç“¦å·¥ç­‰ç­‰éƒ½è¡Œã€‚<br>
é¦–å…ˆåˆ°ä¸‹é¢ä¸¤ä¸ªç½‘ç«™æ£€æµ‹22ç«¯å£æ˜¯å¦å¼€å¯ï¼Œå¦‚æœå…³é—­çš„è¯ï¼Œvpsæ¢ä¸ªipæŠŠã€‚ã€‚<br>
<a href="http://tool.chinaz.com/port" target="_blank" rel="noopener">http://tool.chinaz.com/port</a><br>
<a href="https://www.yougetsignal.com/tools/open-ports/" target="_blank" rel="noopener">https://www.yougetsignal.com/tools/open-ports/</a></p>
<h3 id="å¯ç”¨bbråŠ é€Ÿ">å¯ç”¨BBRåŠ é€Ÿ</h3>
<p>~#:apt update<br>
~#:apt upgrade<br>
~#:echo â€œnet.core.default_qdisc=fqâ€ &gt;&gt; /etc/sysctl.conf<br>
~#:echo â€œnet.ipv4.tcp_congestion_control=bbrâ€ &gt;&gt; /etc/sysctl.conf<br>
~#:sysctl -p<br>
ä¸Šè¿°å‘½ä»¤å°±å®Œæˆäº†BBRåŠ é€Ÿï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯ï¼š<br>
~#:lsmod |grep bbr<br>
çœ‹åˆ°è¾“å‡ºåŒ…å«tcp_bbrå°±è¯´æ˜å·²ç»æˆåŠŸäº†ã€‚</p>
<h3 id="æ­å»ºshadowsocks-server">æ­å»ºshadowsocks server</h3>
<h4 id="å®‰è£…shadowsocks-server">å®‰è£…shadowsocks server</h4>
<p>~#:apt install python-pip<br>
~#:pip install shadowsocks<br>
éœ€è¦è¯´ä¸€ä¸‹çš„æ˜¯ï¼Œshadowsocksç›®å‰è¿˜ä¸æ”¯æŒpython3.5åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œä¸Šæ¬¡æˆ‘æŠŠ/usr/bin/pythonæŒ‡å‘äº†python3.6ï¼Œå°±æ˜¯ç³»ç»Ÿé»˜è®¤çš„pythonæŒ‡å‘äº†python3.6ï¼Œç„¶åå°±ggäº†ã€‚ä¸€å®šè¦ä½¿ç”¨Python 2.6,2.7,3.3,3.4ä¸­çš„ä¸€ä¸ªç‰ˆæœ¬æ‰èƒ½ä½¿ç”¨ã€‚ã€‚</p>
<h4 id="åˆ›å»ºshadowsocksé…ç½®æ–‡ä»¶">åˆ›å»ºshadowsocksé…ç½®æ–‡ä»¶</h4>
<p>å¦‚æœä½ çš„VPSæ”¯æŒipv6çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥å¼€å¤šè¿›ç¨‹åˆ†åˆ«è¿è¡Œipv4å’Œipv6çš„shadowsocks serverã€‚æœ¬åœ°åªæœ‰ipv4çš„è¯ï¼Œå¯ä»¥ç”¨æœ¬åœ°ipv4è®¿é—®ipv6ï¼Œä»è€Œè®¿é—®byrç­‰ç½‘ç«™ï¼Œä½†æ˜¯å…­ç»´ç©ºé—´å¯¹æ­¤åšäº†å±è”½ã€‚å¦‚æœæœ¬åœ°æœ‰ipv6çš„è¯ï¼Œè¿˜å¯ä»¥ç”¨æœ¬åœ°çš„ipv6è®¿é—®ipv6å®ç°æ ¡å›­ç½‘ä¸èµ°ipv4æµé‡ã€‚</p>
<h5 id="ipv4é…ç½®">ipv4é…ç½®</h5>
<p>~#:vim /etc/shadowsocks_v4.json<br>
é…ç½®æ–‡ä»¶å¦‚ä¸‹</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"server"</span>:<span class="string">"0.0.0.0"</span>,</span><br><span class="line"><span class="attr">"server_port"</span>:<span class="string">"ä½ çš„ç«¯å£å·"</span>,</span><br><span class="line"><span class="attr">"local_address"</span>:<span class="string">"127.0.0.1"</span>,</span><br><span class="line"><span class="attr">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line"><span class="attr">"password"</span>:<span class="string">"ä½ çš„å¯†ç "</span>,</span><br><span class="line"><span class="attr">"timeout"</span>:<span class="number">600</span>,</span><br><span class="line"><span class="attr">"method"</span>:<span class="string">"aes-256-cfb"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="ipv6é…ç½®">ipv6é…ç½®</h5>
<p>~#:vim /etc/shadowsocks_v6.json<br>
é…ç½®æ–‡ä»¶å¦‚ä¸‹</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"server"</span>:<span class="string">"::"</span>,</span><br><span class="line"><span class="attr">"server_port"</span>:<span class="string">"ä½ çš„ç«¯å£å·"</span>,</span><br><span class="line"><span class="attr">"local_address"</span>:<span class="string">"127.0.0.1"</span>,</span><br><span class="line"><span class="attr">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line"><span class="attr">"password"</span>:<span class="string">"ä½ çš„å¯†ç "</span>,</span><br><span class="line"><span class="attr">"timeout"</span>:<span class="number">600</span>,</span><br><span class="line"><span class="attr">"method"</span>:<span class="string">"aes-256-cfb"</span></span><br><span class="line">&#125;</span><br><span class="line">``` </span><br><span class="line">æ³¨æ„è¿™ä¸¤ä¸ªæ–‡ä»¶çš„server_portä¸€å®šè¦ä¸åŒï¼Œä»¥åŠåŒå¼•å·å¿…é¡»æ˜¯è‹±æ–‡å¼•å·ã€‚</span><br><span class="line">##### 1.2.2.3.æ‰‹åŠ¨è¿è¡Œshadowsocks server</span><br><span class="line">~#:ssserver -c /etc/shadowsock_v4.json -d start --pid-file ss1.pid</span><br><span class="line">~#:ssserver -c /etc/shadowsock_v6.json -d start --pid-file ss2.pid</span><br><span class="line">æ³¨æ„è¿™é‡Œè¦ç»™ä¸¤æ¡å‘½ä»¤åˆ†é…ä¸åŒçš„è¿›ç¨‹å·ã€‚</span><br><span class="line"></span><br><span class="line">### è®¾ç½®shadowsocks serverå¼€æœºè‡ªå¯</span><br><span class="line">å¦‚æœé‡å¯æœåŠ¡å™¨çš„è¯ï¼Œå°±éœ€è¦é‡æ–°æ‰‹åŠ¨æ‰§è¡Œä¸Šè¿°å‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒå†™æˆå¼€æœºè‡ªå¯è„šæœ¬ã€‚</span><br><span class="line">~#:vim /etc/init.d/shadowsocks_v4</span><br><span class="line">å†…å®¹å¦‚ä¸‹ï¼š</span><br><span class="line">``` shell</span><br><span class="line">#!/bin/sh</span><br><span class="line">### BEGIN INIT INFO</span><br><span class="line"># Provides:          apache2</span><br><span class="line"># Required-Start:    $local_fs $remote_fs $network $syslog</span><br><span class="line"># Required-Stop:     $local_fs $remote_fs $network $syslog</span><br><span class="line"># Default-Start:     2 3 4 5</span><br><span class="line"># Default-Stop:      0 1 6</span><br><span class="line"># Short-Description: apache2 service</span><br><span class="line"># Description:       apache2 service daemon</span><br><span class="line">### END INIT INFO</span><br><span class="line">start()&#123;</span><br><span class="line">  ssserver -c /etc/shadowsocks_v4.json -d start --pid-file ss2.pid</span><br><span class="line">&#125;</span><br><span class="line">stop()&#123;</span><br><span class="line">  ssserver -c /etc/shadowsocks_v4.json -d stop --pid-file ss2.pid</span><br><span class="line">&#125;</span><br><span class="line">case "$1" in</span><br><span class="line">start)</span><br><span class="line">  start</span><br><span class="line">  ;;</span><br><span class="line">stop)</span><br><span class="line">  stop</span><br><span class="line">  ;;</span><br><span class="line">restart)</span><br><span class="line">  stop</span><br><span class="line">  start</span><br><span class="line">  ;;</span><br><span class="line">*)</span><br><span class="line">  echo "Uasage: $0 &#123;start|reload|stop&#125;$"</span><br><span class="line">  exit 1</span><br><span class="line">  ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>
<p>~#:vim /etc/init.d/shadowsocks_v6<br>
å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/sh</span><br><span class="line"><span class="meta">#</span>## BEGIN INIT INFO</span><br><span class="line"><span class="meta">#</span> Provides:          apache2</span><br><span class="line"><span class="meta">#</span> Required-Start:    $local_fs $remote_fs $network $syslog</span><br><span class="line"><span class="meta">#</span> Required-Stop:     $local_fs $remote_fs $network $syslog</span><br><span class="line"><span class="meta">#</span> Default-Start:     2 3 4 5</span><br><span class="line"><span class="meta">#</span> Default-Stop:      0 1 6</span><br><span class="line"><span class="meta">#</span> Short-Description: apache2 service</span><br><span class="line"><span class="meta">#</span> Description:       apache2 service daemon</span><br><span class="line"><span class="meta">#</span>## END INIT INFO</span><br><span class="line">start()&#123;</span><br><span class="line">  ssserver -c /etc/shadowsocks_v6.json -d start --pid-file ss1.pid</span><br><span class="line">&#125;</span><br><span class="line">stop()&#123;</span><br><span class="line">  ssserver -c /etc/shadowsocks_v6.json -d stop --pid-file ss1.pid</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">case "$1" in</span><br><span class="line">start)</span><br><span class="line">  start</span><br><span class="line">  ;;</span><br><span class="line">stop)</span><br><span class="line">  stop</span><br><span class="line">  ;;</span><br><span class="line">restart)</span><br><span class="line">  stop</span><br><span class="line">  start</span><br><span class="line">  ;;</span><br><span class="line">*)</span><br><span class="line">  echo "Uasage: $0 &#123;start|reload|stop&#125;$"</span><br><span class="line">  exit 1</span><br><span class="line">  ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ‰§è¡Œä¸‹åˆ—å‘½ä»¤å³å¯ï¼š<br>
~#:chmod a+x /etc/init.d/shadowsocks_v4<br>
~#:chmod a+x /etc/init.d/shadowsocks_v6<br>
~#:update-rc.d shadowsocks_v4 defaults<br>
~#:update-rc.d shadowsocks_v6 defaults</p>
<p>è‡³æ­¤ï¼ŒæœåŠ¡å™¨ç«¯é…ç½®å®Œæˆã€‚</p>
<h2 id="æœåŠ¡ç«¯è‡ªåŠ¨é…ç½®è„šæœ¬">æœåŠ¡ç«¯è‡ªåŠ¨é…ç½®è„šæœ¬</h2>
<p><a href="https://github.com/mxxhcm/code/tree/master/shell/ss" target="_blank" rel="noopener">åœ°å€</a><br>
é¦–å…ˆå°†è¯¥æ–‡ä»¶ä¸­æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°vpsä¸Šï¼Œç„¶åæ‰§è¡Œ<br>
~#:sh install_ss_server.sh<br>
å³å¯</p>
<h3 id="è¡¥å……è¯´æ˜">è¡¥å……è¯´æ˜</h3>
<p>è¯¥æ–‡ä»¶å¤¹å…±åŒ…å«äº”ä¸ªæ–‡ä»¶<br>
shadowsocks_v4.jsonä¸ºipv4 ssé…ç½®æ–‡ä»¶ï¼Œå¯æ ¹æ®è‡ªå·±çš„éœ€è¦ä¿®æ”¹ç«¯å£å·å’Œå¯†ç <br>
shadowsocks_v6.jsonä¸ºipv6 ssé…ç½®æ–‡ä»¶ï¼Œå¯æ ¹æ®è‡ªå·±çš„éœ€è¦ä¿®æ”¹ç«¯å£å·å’Œå¯†ç <br>
shadowsocks_v4ä¸ºipv4 ssè‡ªå¯åŠ¨æ–‡ä»¶ï¼Œæ— éœ€ä¿®æ”¹<br>
shadowsocks_v6ä¸ºipv6 ssè‡ªå¯åŠ¨æ–‡ä»¶ï¼Œæ— éœ€ä¿®æ”¹<br>
install_ss_server.shä¸ºå®‰è£…è„šæœ¬ï¼Œè¯¥è„šæœ¬åŒæ—¶é…ç½®ipv4å’Œipv6 ss serverã€‚å¯æ ¹æ®è‡ªå·±éœ€è¦è‡ªè¡Œé€‰æ‹©ã€‚</p>
<h2 id="å®¢æˆ·ç«¯é…ç½®">å®¢æˆ·ç«¯é…ç½®</h2>
<h3 id="windowså®¢æˆ·ç«¯é…ç½®">Windowså®¢æˆ·ç«¯é…ç½®</h3>
<h4 id="å®‰è£…shadowsockå®¢æˆ·ç«¯">å®‰è£…shadowsockå®¢æˆ·ç«¯</h4>
<p>åˆ°è¯¥ç½‘å€ <a href="https://github.com/shadowsocks/shadowsocks-windows/releases" target="_blank" rel="noopener">https://github.com/shadowsocks/shadowsocks-windows/releases</a> ä¸‹è½½ç›¸åº”çš„windowså®¢æˆ·ç«¯ç¨‹åºã€‚<br>
ç„¶åé…ç½®æœåŠ¡å™¨å³å¯ï½</p>
<h3 id="linuxå®¢æˆ·ç«¯é…ç½®">Linuxå®¢æˆ·ç«¯é…ç½®</h3>
<h4 id="å®‰è£…shadowsocksç¨‹åº">å®‰è£…shadowsocksç¨‹åº</h4>
<p>~$:sudo pip install shadowsocks</p>
<h4 id="è¿è¡Œshadowsockså®¢æˆ·ç«¯ç¨‹åº">è¿è¡Œshadowsockså®¢æˆ·ç«¯ç¨‹åº</h4>
<p>~$:sudo vim /etc/shadowsocks.json<br>
å¡«å…¥ä»¥ä¸‹é…ç½®æ–‡ä»¶<br>
{<br>
â€œserverâ€:â€œå¡«ä¸Šè‡ªå·±çš„shadowsocks server ipåœ°å€â€,<br>
â€œserver_portâ€:â€œ8888â€,//å¡«ä¸Šè‡ªå·±çš„shadowsocks server ç«¯å£&quot;<br>
â€œlocal_portâ€:1080,<br>
â€œpasswordâ€:â€œmxxhcm150929â€,<br>
â€œtimeoutâ€:600,<br>
â€œmethodâ€:â€œaes-256-cfbâ€<br>
}</p>
<p>æ¥ä¸‹æ¥å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿è¡Œshadowsockså®¢æˆ·ç«¯ï¼š<br>
~$:sudo sslocal -c /etc/shadowsocks.json<br>
ç„¶åæŠ¥é”™ï¼š</p>
<blockquote>
<p>INFO: loading config from /etc/shadowsocks.json<br>
2019-03-04 14:37:49 INFO     loading libcrypto from libcrypto.so.1.1<br>
Traceback (most recent call last):<br>
File â€œ/usr/local/bin/sslocalâ€, line 11, in <module><br>
load_entry_point(â€˜shadowsocks==2.8.2â€™, â€˜console_scriptsâ€™, â€˜sslocalâ€™)()<br>
File â€œ/usr/local/lib/python2.7/dist-packages/shadowsocks/local.pyâ€, line 39, in main<br>
config = shell.get_config(True)<br>
File â€œ/usr/local/lib/python2.7/dist-packages/shadowsocks/shell.pyâ€, line 262, in get_config<br>
check_config(config, is_local)<br>
File â€œ/usr/local/lib/python2.7/dist-packages/shadowsocks/shell.pyâ€, line 124, in check_config<br>
encrypt.try_cipher(config[â€˜passwordâ€™], config[â€˜methodâ€™])<br>
File â€œ/usr/local/lib/python2.7/dist-packages/shadowsocks/encrypt.pyâ€, line 44, in try_cipher<br>
Encryptor(key, method)<br>
File â€œ/usr/local/lib/python2.7/dist-packages/shadowsocks/encrypt.pyâ€, line 83, in <strong>init</strong><br>
random_string(self._method_info[1]))<br>
File â€œ/usr/local/lib/python2.7/dist-packages/shadowsocks/encrypt.pyâ€, line 109, in get_cipher<br>
return m[2](method, key, iv, op)<br>
File â€œ/usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.pyâ€, line 76, in <strong>init</strong><br>
load_openssl()<br>
File â€œ/usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.pyâ€, line 52, in load_openssl<br>
libcrypto.EVP_CIPHER_CTX_cleanup.argtypes = (c_void_p,)<br>
File â€œ/usr/lib/python2.7/ctypes/<strong>init</strong>.pyâ€, line 379, in <strong>getattr</strong><br>
func = self.<strong>getitem</strong>(name)<br>
File â€œ/usr/lib/python2.7/ctypes/<strong>init</strong>.pyâ€, line 384, in <strong>getitem</strong><br>
func = self._FuncPtr((name_or_ordinal, self))<br>
AttributeError: /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER_CTX_cleanup</module></p>
</blockquote>
<p>æŒ‰ç…§å‚è€ƒæ–‡çŒ®4çš„åšæ³•ï¼Œæ˜¯åœ¨openssl 1.1.0ç‰ˆæœ¬ä¸­æ”¾å¼ƒäº†EVP_CIPHER_CTX_cleanupå‡½æ•°</p>
<blockquote>
<p>EVP_CIPHER_CTX was made opaque in OpenSSL 1.1.0. As a result, EVP_CIPHER_CTX_reset() appeared and EVP_CIPHER_CTX_cleanup() disappeared.<br>
EVP_CIPHER_CTX_init() remains as an alias for EVP_CIPHER_CTX_reset().</p>
</blockquote>
<p>å°†opensslåº“ä¸­çš„EVP_CIPHER_CTX_cleanupæ”¹ä¸ºEVP_CIPHER_CTX_resetå³å¯ã€‚<br>
å†æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹shadowsockså®‰è£…ä½ç½®<br>
~#:pip install shadowsocks<br>
Requirement already satisfied: shadowsocks in /usr/local/lib/python2.7/dist-packages<br>
~#:cd /usr/local/lib/python2.7/dist-packages/shadowsocks<br>
~#:vim crypto/openssl.py<br>
æœç´¢cleanupï¼Œå°†å…¶æ›¿æ¢ä¸ºreset<br>
å…·ä½“ä½ç½®åœ¨ç¬¬52è¡Œlibcrypto.EVP_CIPHER_CTX_cleanup.argtypes = (c_void_p,)å’Œç¬¬111è¡Œlibcrypto.EVP_CIPHER_CTX_cleanup(self._ctx)</p>
<h4 id="æ‰‹åŠ¨è¿è¡Œåå°æŒ‚èµ·">æ‰‹åŠ¨è¿è¡Œåå°æŒ‚èµ·</h4>
<p>å°†æ‰€æœ‰çš„logé‡å®šå‘åˆ°~/.log/sslocal.logæ–‡ä»¶ä¸­<br>
~$:mkdir ~/.log<br>
~$:touch ~/.log/ss-local.log<br>
~$:nohup sslocal -c /etc/shadowsocks_v6.json &lt;/dev/null &amp;&gt;&gt;~/.log/ss-local.log &amp;</p>
<h4 id="å¼€æœºè‡ªå¯shadowsocks-client">å¼€æœºè‡ªå¯shadowsocks client</h4>
<p>ä½†æ˜¯è¿™æ ·å­çš„è¯ï¼Œæ¯æ¬¡å¼€æœºéƒ½è¦é‡æ–°è¿è¡Œä¸Šè¿°å‘½ä»¤ï¼Œå¤ªéº»çƒ¦äº†ã€‚å¯ä»¥å†™ä¸ªå¼€æœºè‡ªå¯è„šæœ¬ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br>
~$:sudo vim /etc/init.d/shadowsocks<br>
å†…å®¹ä¸ºä»¥ä¸‹shellè„šæœ¬</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>## BEGIN INIT INFO</span><br><span class="line"><span class="meta">#</span> Provides:          shadowsocks local</span><br><span class="line"><span class="meta">#</span> Required-Start:    $local_fs $remote_fs $network $syslog</span><br><span class="line"><span class="meta">#</span> Required-Stop:     $local_fs $remote_fs $network $syslog</span><br><span class="line"><span class="meta">#</span> Default-Start:     2 3 4 5</span><br><span class="line"><span class="meta">#</span> Default-Stop:      0 1 6</span><br><span class="line"><span class="meta">#</span> Short-Description: shadowsocks service</span><br><span class="line"><span class="meta">#</span> Description:       shadowsocks service daemon</span><br><span class="line"><span class="meta">#</span>## END INIT INFO</span><br><span class="line">start()&#123;</span><br><span class="line">ã€€ã€€  sslocal -c /etc/shadowsocks.json -d start</span><br><span class="line">&#125;</span><br><span class="line">stop()&#123;</span><br><span class="line">ã€€ã€€  sslocal -c /etc/shadowsocks.json -d stop</span><br><span class="line">&#125;</span><br><span class="line">case â€œ$1â€ in</span><br><span class="line">start)</span><br><span class="line">ã€€ã€€ã€€start</span><br><span class="line">ã€€ã€€ã€€;;</span><br><span class="line">stop)</span><br><span class="line">ã€€ã€€ã€€stop</span><br><span class="line">ã€€ã€€ã€€;;</span><br><span class="line">reload)</span><br><span class="line">ã€€ã€€ã€€stop</span><br><span class="line">ã€€ã€€ã€€start</span><br><span class="line">ã€€ã€€ã€€;;</span><br><span class="line">\*)</span><br><span class="line">ã€€ã€€ã€€echo â€œUsage: $0 &#123;start|reload|stop&#125;â€</span><br><span class="line">ã€€ã€€ã€€exit 1</span><br><span class="line">ã€€ã€€ã€€;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š<br>
~$:sudo chomod a+x /etc/init.d/shadowsocks<br>
~$:sudo update_rc.d shadowsocks defaults<br>
ä¸Šè¿°å‘½ä»¤æ‰§è¡Œå®Œæˆä»¥åï¼Œè¿›è¡Œæµ‹è¯•<br>
~$:sudo service shadosowcks start</p>
<h4 id="é…ç½®ä»£ç†">é…ç½®ä»£ç†</h4>
<p>ä¸Šä¸€æ­¥çš„ç›®çš„æ˜¯å»ºç«‹äº†shadowsocksæœåŠ¡çš„æœ¬åœ°å®¢æˆ·ç«¯ï¼Œsocks5æµé‡ä¼šèµ°è¯¥é€šé“ï¼Œä½†æ˜¯æµè§ˆå™¨çš„ç½‘é¡µçš„æµé‡æ˜¯httpsçš„ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®ç›¸åº”çš„ä»£ç†ï¼Œå°†httpsæµé‡è½¬æ¢ä¸ºsocks5æµé‡ï¼Œèµ°sså®¢æˆ·ç«¯åˆ°è¾¾ssæœåŠ¡ç«¯ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æŠŠå…¶ä»–å„ç§æµé‡ï¼Œå¦‚tcp,udpç­‰å„ç§æµé‡éƒ½è½¬æ¢ä¸ºsocks5æµé‡ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡å…¨å±€ä»£ç†å®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ ç‰¹å®šçš„ä»£ç†è§„åˆ™å®ç°ã€‚</p>
<h5 id="é…ç½®å…¨å±€ä»£ç†">é…ç½®å…¨å±€ä»£ç†</h5>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ·»åŠ ubuntu socks5ç³»ç»Ÿä»£ç†ï¼š</p>
<p>ç„¶åå°±å¯ä»¥æˆåŠŸä¸Šç½‘äº†ã€‚</p>
<h5 id="ä½¿ç”¨switchyomegaé…ç½®chromeä»£ç†">ä½¿ç”¨SwitchyOmegaé…ç½®chromeä»£ç†</h5>
<p>é¦–å…ˆåˆ° <a href="https://github.com/FelisCatus/SwitchyOmega/releases" target="_blank" rel="noopener">https://github.com/FelisCatus/SwitchyOmega/releases</a> ä¸‹è½½SyitchyOmega.crxã€‚ç„¶ååœ¨chromeçš„åœ°å€æ è¾“å…¥chrome://extensionsï¼Œå°†åˆšæ‰ä¸‹è½½çš„æ’ä»¶æ‹–è¿›å»ã€‚<br>
ç„¶ååœ¨æµè§ˆå™¨å³ä¸Šè§’å°±æœ‰äº†è¿™ä¸ªæ’ä»¶ï¼Œæ¥ä¸‹æ¥é…ç½®æ’ä»¶ã€‚å¦‚ä¸‹å›¾ï¼š<br>
<img src="https:" alt="mxx"><br>
ç›´æ¥é…ç½®proxyï¼Œæ·»åŠ å¦‚å›¾æ‰€ç¤ºçš„è§„åˆ™ï¼Œè¿™æ ·chromeæ‰“å¼€çš„æ‰€æœ‰ç½‘ç«™éƒ½æ˜¯èµ°ä»£ç†çš„ã€‚</p>
<h4 id="ä½¿ç”¨privoxyè®©terminalèµ°socks5">ä½¿ç”¨privoxyè®©terminalèµ°socks5</h4>
<p>~$:sudo apt install privoxy<br>
~$:sudo vim /etc/privoxy/config<br>
å–æ¶ˆä¸‹åˆ—è¡Œçš„æ³¨é‡Šï¼Œæˆ–è€…æ·»åŠ ç›¸åº”æ¡ç›®<br>
forward-socks5 / 127.0.0.1:1080 . # SOCKS5ä»£ç†åœ°å€<br>
listen-address 127.0.0.1:8118     # HTTPä»£ç†åœ°å€<br>
forward 10.*.*.*/ .               # å†…ç½‘åœ°å€ä¸èµ°ä»£ç†<br>
forward .abc.com/ .             # æŒ‡å®šåŸŸåä¸èµ°ä»£ç†<br>
é‡å¯privoxyæœåŠ¡<br>
~$:sudo service privoxy restart<br>
åœ¨bashrcä¸­æ·»åŠ å¦‚ä¸‹ç¯å¢ƒå˜é‡<br>
export http_proxy=&quot;<a href="http://127.0.0.1:8118" target="_blank" rel="noopener">http://127.0.0.1:8118</a>&quot;<br>
export https_proxy=â€œ<a href="http://127.0.0.1:8118" target="_blank" rel="noopener">http://127.0.0.1:8118</a>â€</p>
<p>~$:source ~/.bashrc<br>
~$:curl.gs</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<ol>
<li><a href="http://godjose.com/2017/06/14/new-article/" target="_blank" rel="noopener">http://godjose.com/2017/06/14/new-article/</a></li>
<li><a href="https://www.polarxiong.com/archives/%E6%90%AD%E5%BB%BAipv6-VPN-%E8%AE%A9ipv4%E4%B8%8Aipv6-%E4%B8%8B%E8%BD%BD%E9%80%9F%E5%BA%A6%E6%8F%90%E5%8D%87%E5%88%B0100M.html" target="_blank" rel="noopener">https://www.polarxiong.com/archives/æ­å»ºipv6-VPN-è®©ipv4ä¸Šipv6-ä¸‹è½½é€Ÿåº¦æå‡åˆ°100M.html</a></li>
<li><a href="https://blog.csdn.net/li1914309758/article/details/86510127" target="_blank" rel="noopener">https://blog.csdn.net/li1914309758/article/details/86510127</a></li>
<li><a href="https://blog.csdn.net/blackfrog_unique/article/details/60320737" target="_blank" rel="noopener">https://blog.csdn.net/blackfrog_unique/article/details/60320737</a></li>
<li><a href="https://blog.csdn.net/qq_31851531/article/details/78410146" target="_blank" rel="noopener">https://blog.csdn.net/qq_31851531/article/details/78410146</a></li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/03/02/dqn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/02/dqn/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">DQN</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-03-02 19:29:35" itemprop="dateCreated datePublished" datetime="2019-03-02T19:29:35+08:00">2019-03-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-06-01 10:17:51" itemprop="dateModified" datetime="2019-06-01T10:17:51+08:00">2019-06-01</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/å¼ºåŒ–å­¦ä¹ /" itemprop="url" rel="index"><span itemprop="name">å¼ºåŒ–å­¦ä¹ </span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="dqn">DQN</h2>
<p>è®ºæ–‡åç§°<a href="https://arxiv.org/pdf/1312.5602.pdf" target="_blank" rel="noopener">Playing Atari with Deep Reinforcement Learning</a></p>
<h3 id="æ¦‚è¿°">æ¦‚è¿°</h3>
<p>ç”¨ä¸€ä¸ªCNNè¡¨ç¤ºå€¼å‡½æ•°ï¼Œç›´æ¥ä»é«˜ç»´çš„è¾“å…¥ä¸­å­¦ä¹ æ§åˆ¶ç­–ç•¥ã€‚ç”¨Q-learningçš„å˜ç§æ¥è®­ç»ƒè¿™ä¸ªCNNã€‚ç½‘ç»œçš„è¾“å…¥æ˜¯åŸå§‹çš„å›¾ç‰‡ï¼Œè¾“å‡ºæ˜¯å›¾ç‰‡å¯¹åº”çš„stateå¯èƒ½é‡‡å–çš„actionçš„$Q$å€¼ã€‚<br>
Atari 2600æ˜¯ä¸€ä¸ªRLçš„benchmarkï¼Œæœ‰2600ä¸ªæ¸¸æˆï¼Œæ¯ä¸ªagentä¼šå¾—åˆ°ä¸€ä¸ªå›¾åƒè¾“å…¥(210 x 160 RGBè§†é¢‘60Hz)ã€‚æœ¬æ–‡çš„ç›®æ ‡æ˜¯è®¾è®¡ä¸€ä¸ªNNæ¶æ„å°½å¯èƒ½å­¦ä¼šæ›´å¤šæ¸¸æˆï¼Œç½‘ç»œçš„è¾“å…¥åªæœ‰è§†é¢‘ä¿¡æ¯ï¼Œrewardå’Œterminalä¿¡å·ä»¥åŠå¯èƒ½é‡‡å–çš„actionï¼Œå’Œäººç±»ç©å®¶å¾—åˆ°çš„ä¿¡æ¯æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œå½“ç„¶æ˜¯è®¡ç®—æœºèƒ½çœ‹å¾—æ‡‚çš„ä¿¡å·ã€‚</p>
<h3 id="éœ€è¦è§£å†³çš„é—®é¢˜">éœ€è¦è§£å†³çš„é—®é¢˜</h3>
<ol>
<li>å¤§é‡æœ‰æ ‡è®°çš„è®­ç»ƒæ•°æ®ã€‚</li>
<li>å¼ºåŒ–å­¦ä¹ éœ€è¦ä»ä¸€ä¸ªç¨€ç–çš„ï¼Œæœ‰å™ªéŸ³çš„ï¼Œé€šå¸¸æ˜¯time-delayed(å»¶è¿Ÿçš„)æ ‡é‡ä¿¡å·ä¸­å­¦ä¹ ã€‚è¿™ä¸ªdelayå­˜åœ¨äºactionå’Œrewardä¹‹é—´ï¼Œè€Œä¸”å¯ä»¥è¾¾åˆ°å‡ åƒä¸ªtimestepsé‚£ä¹ˆè¿œï¼Œå’Œsupervised learnignä¸­è¾“å…¥å’Œè¾“å…¥ä¹‹é—´ç›´æ¥çš„å…³ç³»ç›¸æ¯”è¦å¤æ‚çš„å¤šã€‚</li>
<li>å¤§å¤šæ•°æ·±åº¦å­¦ä¹ ç®—æ³•å‡è®¾æ ·æœ¬ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç„¶è€Œå¼ºåŒ–å­¦ä¹ çš„ä¸€ä¸ªsequence(åºåˆ—)é€šå¸¸æ˜¯é«˜åº¦ç›¸å…³çš„ã€‚</li>
<li>å¼ºåŒ–å­¦ä¹ ç®—æ³•å­¦ä¹ åˆ°çš„policyå˜åŒ–æ—¶ï¼Œæ•°æ®æœä»çš„åˆ†å¸ƒé€šå¸¸ä¼šæ”¹å˜ï¼Œç„¶è€Œæ·±åº¦å­¦ä¹ é€šå¸¸å‡è®¾æ•°æ®æœä»ä¸€ä¸ªå›ºå®šçš„åˆ†å¸ƒã€‚</li>
</ol>
<h3 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h3>
<h4 id="èƒŒæ™¯">èƒŒæ™¯</h4>
<ol>
<li>agentä¸Atariæ¨¡æ‹Ÿå™¨ä¸æ–­äº¤äº’ï¼Œagentä¸èƒ½è§‚æµ‹åˆ°æ¨¡æ‹Ÿå™¨çš„å†…éƒ¨çŠ¶æ€ï¼Œåªèƒ½å¾—åˆ°å½“å‰å±å¹•ä¿¡æ¯çš„ä¸€ä¸ªå›¾ç‰‡ã€‚è¿™ä¸ªtaskå¯ä»¥è®¤ä¸ºæ˜¯éƒ¨åˆ†å¯è§‚æµ‹çš„ï¼Œå› ä¸ºä»…ä»…ä»å½“å‰çš„å±å¹•å›¾åƒ$x_t$ä¸Šæ˜¯ä¸èƒ½å®Œå…¨ç†è§£æ•´ä¸ªæ¸¸æˆçŠ¶å†µçš„ã€‚æ‰€æœ‰çš„åºåˆ—éƒ½è®¤ä¸ºåœ¨æœ‰é™æ­¥éª¤å†…æ˜¯ä¼šç»“æŸçš„ã€‚</li>
<li>æ³¨æ„agentå½“å‰çš„å¾—åˆ†å–å†³äºæ•´ä¸ªsequenceçš„actionå’Œobservationã€‚ä¸€ä¸ªactionçš„feedbackå¯èƒ½ç­‰åˆ°å¥½å‡ åƒä¸ªtimestepsä¹‹åæ‰èƒ½å¾—åˆ°ã€‚</li>
<li>agentçš„ç›®æ ‡æ˜¯é€šè¿‡é‡‡å–actionå’Œenväº¤äº’æœ€å¤§åŒ–ç´¯è®¡rewardã€‚å®šä¹‰$t$æ—¶åˆ»çš„å›æŠ¥returnä¸º$R_t = \sum^T_{tâ€™=t} \gamma^{tâ€™-t}r_{tâ€™}$ï¼Œå…¶ä¸­$\gamma$æ˜¯æŠ˜æ‰£å› å­ï¼Œ$T$æ˜¯æ¸¸æˆç»ˆæ­¢çš„æ—¶é—´æ­¥ã€‚</li>
<li>å®šä¹‰æœ€ä¼˜çš„åŠ¨ä½œå€¼å‡½æ•°$Q^{*}(s,a)$æ˜¯éµå¾ªæœ€ä¼˜ç­–ç•¥åœ¨çŠ¶æ€$s$å¤„é‡‡å–åŠ¨ä½œ$a$èƒ½è·å¾—çš„æœ€å¤§çš„æœŸæœ›å›æŠ¥ï¼Œ$Q^{*}(s,a) = max_{\pi}E[R_t|s_t=s,a_t=a,\pi]$ã€‚</li>
<li>æœ€ä¼˜çš„åŠ¨ä½œå€¼å‡½æ•°éµå¾ªBellman optimal equationã€‚å¦‚æœåœ¨ä¸‹ä¸ªæ—¶é—´æ­¥çš„çŠ¶æ€$sâ€™$å¤„ï¼Œå¯¹äºæ‰€æœ‰å¯èƒ½çš„$aâ€™$ï¼Œ$Q^{*}(sâ€™,aâ€™)$çš„æœ€ä¼˜å€¼æ˜¯å·²çŸ¥çš„ï¼ˆè¿™é‡Œå°±æ˜¯å¯¹äºæ¯ä¸€ä¸ª$aâ€™$ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªæœ€ä¼˜çš„$Q(sâ€™,aâ€™)$ï¼Œæœ€ä¼˜çš„ç­–ç•¥å°±æ˜¯é€‰æ‹©æœ€å¤§åŒ–$r+Q^{*}(sâ€™,aâ€™)$çš„åŠ¨ä½œ$aâ€™$ï¼š<br>
$$Q^{*}(s,a) = E_{s\sim E}[r+ \gamma max_{aâ€™} Q^{*}(sâ€™,aâ€™)|s,a], \tag{1}$$<br>
å¼ºåŒ–å­¦ä¹ çš„ä¸€ä¸ªæ€è·¯å°±æ˜¯ä½¿ç”¨Bellman optimal equationæ›´æ–°åŠ¨ä½œå€¼å‡½æ•°ï¼Œ$Q_{i+1}(s,a) = E[r + \gamma Q_i(sâ€™,aâ€™)|s,a]$ï¼Œå½“$i\rightarrow \infty$æ—¶ï¼Œ$Q_i \rightarrow Q^{*}$ã€‚</li>
<li>ä¸Šè¿°ä¾‹å­æ˜¯state-action pairå¾ˆå°‘çš„æƒ…å†µï¼Œå½“æœ‰æ— ç©·å¤šä¸ªçš„æ—¶å€™ï¼Œæ˜¯æ— æ³•ç²¾ç¡®è®¡ç®—çš„ã€‚è¿™æ—¶å€™å¯ä»¥é‡‡ç”¨å‡½æ•°æ¥ä¼°è®¡åŠ¨ä½œå€¼å‡½æ•°ï¼Œ$Q(s,a;\theta) \approx Q^{*}(s,a)$ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé€šå¸¸é‡‡ç”¨çº¿æ€§å‡½æ•°è¿›è¡Œä¼°è®¡ï¼Œå½“ç„¶å¯ä»¥é‡‡ç”¨éçº¿æ€§çš„å‡½æ•°ï¼Œå¦‚ç¥ç»ç½‘ç»œç­‰ç­‰ã€‚è¿™é‡Œé‡‡ç”¨çš„æ˜¯ç¥ç»ç½‘ç»œï¼Œç”¨$\theta$è¡¨ç¤ºç½‘ç»œçš„å‚æ•°ï¼Œè¿™ä¸ªç½‘ç»œå«åšQç½‘ç»œï¼ŒQç½‘ç»œé€šè¿‡æœ€å°åŒ–ä¸‹åˆ—lossè¿›è¡Œè®­ç»ƒï¼š<br>
$$L_i(\theta_i) = E_{s,a\sim \rho(\cdot)}\left[(y_i - Q(s,a;\theta_i))^2\right]\tag{2}$$<br>
å…¶ä¸­$y_i = E_{sâ€™\sim E}[r+\gamma max_{aâ€™}Q(sâ€™,aâ€™;\theta_{i-1})]$æ˜¯ç¬¬$i$æ¬¡è¿­ä»£çš„targetå€¼ï¼Œå…¶ä¸­$\rho(s,a)$æ˜¯$(s,a)$æœä»çš„æ¦‚ç‡åˆ†å¸ƒã€‚</li>
<li>æ³¨æ„åœ¨ä¼˜åŒ–$L_i(\theta_i)$æ—¶ï¼Œä¸Šä¸€æ¬¡è¿­ä»£çš„$\theta_{i-1}$æ˜¯ä¸å˜çš„ï¼Œtargetå–å†³äºç½‘ç»œå‚æ•°ï¼Œå’Œç›‘ç£å­¦ä¹ ä½œå¯¹æ¯”ï¼Œç›‘ç£å­¦ä¹ çš„targetå’Œç½‘ç»œå‚æ•°æ— å…³ã€‚</li>
<li>å¯¹Losså‡½æ•°è¿›è¡Œæ±‚å¯¼ï¼Œå¾—åˆ°ä¸‹åˆ—çš„gradientä¿¡æ¯ï¼š<br>
$$\nabla_{\theta_i}L_i(\theta_i) = E_{s,a\sim \rho(\cdot),sâ€™\sim E}\left[(r+\gamma max_{aâ€™}Q(sâ€™,aâ€™;\theta_{i-1})-Q(s,a;\theta_i))\nabla_{\theta_i}Q(s,a;\theta_i)\right]\tag{3}$$<br>
é€šè¿‡SGDä¼˜åŒ–losså‡½æ•°ã€‚å¦‚æœæƒé‡æ˜¯æ¯éš”å‡ ä¸ªtimestepè¿›è¡Œæ›´æ–°ï¼Œå¹¶ä¸”ç”¨ä»åˆ†å¸ƒ$\rho$å’Œç¯å¢ƒ$E$ä¸­é‡‡æ ·å¾—åˆ°çš„æ ·æœ¬å–ä»£æœŸæœ›ï¼Œå°±å¯ä»¥å¾—åˆ°ç†Ÿæ‚‰çš„Q-learningç®—æ³•[2]ã€‚(è¿™ä¸ªå…·ä½“ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·ï¼Œæˆ‘ä¹Ÿä¸æ¸…æ¥šï¼Œå¯ä»¥çœ‹å‚è€ƒæ–‡çŒ®2)</li>
<li>dqnæ˜¯Model-Freeçš„ï¼Œå®ƒç›´æ¥ä»ç¯å¢ƒ$E$ä¸­é‡‡æ ·ï¼Œå¹¶æ²¡æœ‰æ˜¾å¼çš„å¯¹ç¯å¢ƒè¿›è¡Œå»ºæ¨¡ã€‚</li>
<li>dqnæ˜¯ä¸€ä¸ªonlineçš„æ–¹æ³•ï¼Œå³è®­ç»ƒæ•°æ®ä¸æ–­å¢åŠ ã€‚offlineæ˜¯è®­ç»ƒæ•°æ®å›ºå®šã€‚</li>
<li>dqnæ˜¯ä¸€ä¸ªoff-policyç®—æ³•ï¼Œtarget policy æ˜¯greedy policyï¼Œbehaviour policyæ˜¯$\varepsilon$ greedy policyï¼Œtarget policyå’Œgreedy policyç­–ç•¥ä¸åŒã€‚</li>
</ol>
<blockquote>
<p>On-policy methods attempt to evaluate or improve the policy that is used to make decisions, whereasÂ  off-policy methods evaluate or improve a policy different from that used to generate the data.</p>
</blockquote>
<p>Sarsaå’ŒQ-learningçš„åŒºåˆ«åœ¨äºæ›´æ–°Qå€¼æ—¶çš„target policyå’Œbehaviour policyæ˜¯å¦ç›¸åŒã€‚å…¶å®å°±æ˜¯policy evaluationå’Œvalue iterationçš„åŒºåˆ«ï¼Œpolicy evaluationä½¿ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•æ›´æ–°$V(s)$ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹å˜è¡Œä¸ºç­–ç•¥ï¼Œæ›´æ–°è¿­ä»£ç”¨çš„æ•°æ®éƒ½æ˜¯åˆ©ç”¨ä¹‹å‰çš„è¡Œä¸ºç­–ç•¥ç”Ÿæˆçš„ã€‚è€Œå€¼è¿­ä»£æ˜¯policy evaluation+policy improvementï¼Œæ¯ä¸€æ­¥éƒ½ç”¨è´ªå¿ƒç­–ç•¥é€‰æ‹©å‡ºæœ€å¤§çš„$a$æ›´æ–°$V(s)$ï¼Œtarget policyï¼ˆgreedyï¼‰å’Œbehaviour policyï¼ˆ$\varepsilon$-greedyï¼‰æ˜¯ä¸åŒçš„ã€‚</p>
<h4 id="åˆ›æ–°å’ŒæŠ€å·§">åˆ›æ–°å’ŒæŠ€å·§</h4>
<ol>
<li>DQNä½¿ç”¨äº†experience replayï¼Œå°†å¤šä¸ªepisodesä¸­çš„ç»éªŒå­˜å‚¨åˆ°ä¸€ä¸ªå¤§å°ä¸º$N$çš„replay bufferä¸­ã€‚åœ¨æ›´æ–°$Q$å€¼çš„æ—¶å€™ï¼Œä»replay bufferä¸­è¿›è¡Œé‡‡æ ·æ›´æ–°ã€‚behaviour policyæ˜¯$\varepsilon$-greedyç­–ç•¥ï¼Œä¿æŒæ¢ç´¢ã€‚target policyæ˜¯$\varepsilon$ greedy ç®—æ³•ï¼Œå› ä¸ºreplay bufferä¸­å­˜æ”¾çš„éƒ½æ˜¯behaviour policyç”Ÿæˆçš„experienceï¼Œæ‰€ä»¥æ˜¯off-policyç®—æ³•ã€‚<br>
é‡‡ç”¨experience replayçš„onlineç®—æ³•[5]å’Œæ ‡å‡†çš„onlineç®—æ³•ç›¸æ¯”æœ‰ä¸‰ä¸ªå¥½å¤„[4]ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸€ä¸ªexperienceå¯ä»¥å¤šæ¬¡ç”¨æ¥æ›´æ–°å‚æ•°ï¼Œæé«˜äº†æ•°æ®è®­ç»ƒæ•ˆç‡ï¼›ç¬¬äºŒä¸ªæ˜¯ç›´æ¥ä»è¿ç»­çš„æ ·æœ¬ä¸­è¿›è¡Œå­¦ä¹ æ˜¯ä½æ•ˆçš„ï¼Œå› ä¸ºæ ·æœ¬ä¹‹é—´å­˜åœ¨å¼ºå…³è”æ€§ã€‚ç¬¬ä¸‰ä¸ªæ˜¯on-policyçš„å­¦ä¹ ä¸­ï¼Œå½“å‰çš„å‚æ•°å†³å®šä¸‹ä¸€æ¬¡é‡‡æ ·çš„æ ·æœ¬ï¼Œå°±å¯èƒ½ä½¿å­¦ä¹ å‡ºæ¥çš„ç»“æœå‘ç”Ÿåç§»ã€‚</li>
<li>replay bufferä¸­åªå­˜å‚¨æœ€è¿‘Nä¸ªexperienceã€‚</li>
<li>åŸå§‹å›¾åƒæ˜¯$210\times 160$çš„RGBå›¾åƒï¼Œé¢„å¤„ç†é¦–å…ˆå°†å®ƒå˜ä¸ºç°åº¦å›¾ï¼Œå¹¶è¿›è¡Œä¸‹é‡‡æ ·å¾—åˆ°ä¸€ä¸ª$110\times 84$çš„å›¾åƒï¼Œç„¶åä»è¿™ä¸ªå›¾åƒä¸­æˆªå–ä¸€ä¸ª$84\times 84$çš„å›¾åƒã€‚</li>
<li>ä½œè€…ä½¿ç”¨é¢„å¤„ç†å‡½æ•°$\phi$å¤„ç†è¿ç»­å››å¼ çš„å›¾åƒè€Œä¸æ˜¯ä¸€å¼ ï¼Œç„¶åå°†è¿™ä¸ªé¢„å¤„ç†åçš„ç»“æœè¾“å…¥$Q$å‡½æ•°ã€‚</li>
<li>é¢„å¤„ç†å‡½æ•°$\phi$æ˜¯ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œï¼Œè¾“å…¥æ˜¯$84\times 84\times 4$çš„å›¾åƒçŸ©é˜µï¼Œç»è¿‡$16$ä¸ªstrideä¸º$4$çš„$8\times 8$filterï¼Œç»è¿‡reluæ¿€æ´»å‡½æ•°ï¼Œå†ç»è¿‡$32$ä¸ªstrideä¸º$2$çš„$4\times 4$filterï¼Œç»è¿‡reluæ¿€æ´»å‡½æ•°ï¼Œæœ€åæ¥ä¸€ä¸ª256ä¸ªå•å…ƒçš„å…¨è¿æ¥å±‚ã€‚è¾“å‡ºå±‚çš„å¤§å°æ ¹æ®ä¸åŒæ¸¸æˆçš„åŠ¨ä½œä¸ªæ•°å†³å®šã€‚</li>
<li>$Q$ç½‘ç»œçš„è¾“å…¥æ˜¯é¢„å¤„ç†åçš„å›¾åƒstateï¼Œè¾“å‡ºæ˜¯æ‰€æœ‰å½“å‰stateå¯èƒ½é‡‡å–çš„actionçš„$Q$å€¼ã€‚</li>
<li>DQNæ˜¯ä¸æ”¶æ•›çš„ã€‚</li>
</ol>
<h3 id="ä¼ªä»£ç ">ä¼ªä»£ç </h3>
<p>ç®—æ³• 1 Deep Q-learning with Experience Replay<br>
Initialize replay memory D to capacity N<br>
Initialize action-value function Q with random weights<br>
for episode = $1, M$ do<br>
$\ \ \ \ \ \ \ \ $Initialize sequence $s_1 = {x_1}$ and preprocessed sequenced $\phi_1 = \phi(s_1)$<br>
$\ \ \ \ \ \ \ \ $for $t = 1,T$ do<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $With probability $\varepsilon$ select a random action $a_t$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $otherwise select $a_t = max_a Q^{âˆ—}(\phi(s_t), a; Î¸)$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Execute action $a_t$ in emulator and observe reward $r_t$ and image $x_{t+1}$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Set $s_{t+1} = s_t, a_t, x_{t+1}$ and preprocess $\phi_{t+1} = \phi(s_{t+1})$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Store transition $(\phi_t, a_t, r_t, \phi_{t+1})$ in D<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Sample random minibatch of transitions $(\phi_j, a_j, r_j, \phi_{j+1})$ from D<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Set $y_j = \begin{cases}r_j&amp;\ \ \ \ for\ terminal\ \phi_{j+1}\\r_j+\gamma max_{aâ€™}Q(\phi_{j+1},aâ€™|\theta)&amp;\ \ \ \ for\ non-terminal\ \phi_{j+1}\end{cases}$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Perform a gradient descent step on $(y_j âˆ’ Q(\phi_j, a_j|Î¸))^2$<br>
$\ \ \ \ \ \ \ \ $end for<br>
end for</p>
<h3 id="å®éªŒ">å®éªŒ</h3>
<h4 id="datasets">Datasets</h4>
<p>ä¸ƒä¸ªAtari 2600 games: B.Rider, Breakout, Enduro, Pong, Q bert, Seaquest, S.Invadersã€‚<br>
åœ¨å…­ä¸ªæ¸¸æˆä¸ŠDQNçš„è¡¨ç°è¶…è¿‡äº†ä¹‹å‰æ‰€æœ‰çš„æ–¹æ³•ï¼Œåœ¨ä¸‰ä¸ªæ¸¸æˆä¸ŠDQNçš„è¡¨ç°è¶…è¿‡äº†äººç±»ã€‚</p>
<h4 id="settings">Settings</h4>
<ol>
<li>ä¸åŒæ¸¸æˆçš„rewardå˜åŒ–å¾ˆå¤§ï¼Œè¿™é‡ŒæŠŠæ­£çš„rewardå…¨éƒ¨è®¾ç½®ä¸º$1$ï¼ŒæŠŠè´Ÿçš„rewardå…¨éƒ¨è®¾ç½®ä¸º$-1$ï¼Œrewardä¸º$0$çš„ä¿æŒä¸å˜ã€‚è¿™æ ·å­åœ¨ä¸åŒæ¸¸æˆä¸­ä¹Ÿå¯ä»¥ç»Ÿä¸€å­¦ä¹ ç‡ã€‚</li>
<li>é‡‡ç”¨RMSPropä¼˜åŒ–ç®—æ³•ï¼Œbatchsizeä¸º$32$ï¼Œbehaviour policyé‡‡ç”¨çš„æ˜¯$\varepsilon$-greedyï¼Œåœ¨å‰$100$ä¸‡æ­¥å†…ï¼Œ$\varepsilon$ä»$1$å˜åˆ°$0.1$ï¼Œæ¥ä¸‹æ¥ä¿æŒä¸å˜ã€‚</li>
<li>ä½¿ç”¨äº†è·³å¸§æŠ€æœ¯ï¼Œæ¯éš”$k$æ­¥ï¼Œagentæ‰é€‰æ‹©ä¸€ä¸ªactionï¼Œåœ¨ä¸­é—´çš„$k-1$æ­¥ä¸­ï¼Œä¿æŒåŸæ¥çš„actionä¸å˜ã€‚è¿™é‡Œé€‰æ‹©äº†$k=4$ï¼Œæœ‰çš„æ¸¸æˆè®¾ç½®çš„ä¸º$k=3$ã€‚</li>
</ol>
<h4 id="metrics">Metrics</h4>
<h5 id="average-reward">average reward</h5>
<p>ç¬¬ä¸€ä¸ªmetricæ˜¯åœ¨ä¸€ä¸ªepisodeæˆ–è€…ä¸€æ¬¡æ¸¸æˆå†…total rewardçš„å¹³å‡å€¼ã€‚è¿™ä¸ªmetricå¸¦æœ‰å¾ˆå¤§å™ªéŸ³ï¼Œå› ä¸ºpolicyæƒå€¼ä¸€ä¸ªå¾ˆå°çš„æ”¹å˜å¯èƒ½å°±ä¼šå¯¹policyè®¿é—®statesçš„åˆ†å¸ƒé€ æˆå¾ˆå¤§çš„å½±å“ã€‚</p>
<h5 id="action-value-function">action value function</h5>
<p>ç¬¬äºŒä¸ªmetricæ˜¯ä¼°è®¡çš„action-value functionï¼Œè¿™é‡Œä½œè€…çš„åšæ³•æ˜¯åœ¨è®­ç»ƒå¼€å§‹å‰ä½¿ç”¨random policyæ”¶é›†ä¸€ä¸ªå›ºå®šçš„states setï¼Œç„¶åtrackè¿™ä¸ªsetä¸­statesæœ€å¤§é¢„æµ‹$Q$å€¼çš„å¹³å‡ã€‚</p>
<h4 id="baselines">Baselines</h4>
<ol>
<li>Sarsa</li>
<li>Contingency</li>
<li>DQN</li>
<li>Human</li>
</ol>
<h3 id="ä»£ç ">ä»£ç </h3>
<p><a href="https://github.com/devsisters/DQN-tensorflow" target="_blank" rel="noopener">https://github.com/devsisters/DQN-tensorflow</a></p>
<h2 id="nature-dqn">Nature DQN</h2>
<h3 id="éçº¿æ€§æ‹Ÿåˆå‡½æ•°ä¸æ”¶æ•›çš„åŸå› ">éçº¿æ€§æ‹Ÿåˆå‡½æ•°ä¸æ”¶æ•›çš„åŸå› </h3>
<ol>
<li>åºåˆ—ä¸­çŠ¶æ€çš„é«˜åº¦ç›¸å…³æ€§ã€‚</li>
<li>$Q$å€¼çš„ä¸€ç‚¹æ›´æ–°å°±ä¼šå¯¹policyæ”¹å˜é€ æˆå¾ˆå¤§çš„å½±å“ï¼Œä»è€Œæ”¹å˜æ•°æ®çš„åˆ†å¸ƒã€‚</li>
<li>å¾…ä¼˜åŒ–çš„$Q$å€¼å’Œtarget value(ç›®æ ‡Qå€¼)ä¹‹é—´çš„å…³ç³»ï¼Œæ¯æ¬¡ä¼˜åŒ–æ—¶çš„ç›®æ ‡Qå€¼éƒ½æ˜¯å›ºå®šä¸Šæ¬¡çš„å‚æ•°å¾—æ¥çš„ï¼Œä¼˜åŒ–ç›®æ ‡éšç€ä¼˜åŒ–è¿‡ç¨‹ä¸€ç›´åœ¨å˜ã€‚<br>
å‰ä¸¤ä¸ªé—®é¢˜æ˜¯é€šè¿‡DQNä¸­æå‡ºçš„replay bufferè§£å†³çš„ï¼Œç¬¬ä¸‰ä¸ªé—®é¢˜æ˜¯Natura DQNä¸­è§£å†³çš„ï¼Œåœ¨ä¸€å®šæ—¶é—´æ­¥å†…ï¼Œå›ºå®štarget networkå‚æ•°ï¼Œæ›´æ–°å¾…networkçš„å‚æ•°ï¼Œç„¶åæ¯éš”å›ºå®šæ­¥æ•°å°†networkçš„å‚æ•°æ‹·è´ç»™target networkã€‚</li>
</ol>
<blockquote>
<p>This instability has several causes: the correlations present in the sequence of observations, the fact that small updates to Q may significantly change the policy and therefore change the data distribution, and the correlations between the action-values (Q) and the target values $r+\gamma max_{aâ€™}Q(sâ€™,aâ€™)$.<br>
We address these instabilities with a novel variant of Q-learning, which uses two key ideas. First, we used a biologically inspired mechanism termed experience replay that randomizes over the data, thereby removing correlations in the observation sequence and smoothing over changes in the data distribution. Second, we used an iterative update that adjusts the action-values (Q) towards target values that are only periodically updated, thereby reducing correlations with the target.</p>
</blockquote>
<h3 id="nature-dqnæ”¹è¿›">Nature DQNæ”¹è¿›</h3>
<ol>
<li>é¢„å¤„ç†çš„ç»“æ„å˜äº†,CNNçš„å±‚æ•°å¢åŠ äº†ä¸€å±‚ï¼Œ</li>
<li>åŠ äº†target networkï¼Œ</li>
<li>å°†erroré™åˆ¶åœ¨$[-1,1]$ä¹‹é—´ã€‚</li>
</ol>
<blockquote>
<p>clip the error term from the update $r + \gamma max_{aâ€™} Q(sâ€™,aâ€™;\theta_i^{-} - Q(s,a;\theta_i)$ to be between $-1$ and $1$. Because the absolute value loss function $|x|$ has a derivative of $-1$ for all negative values of $x$ and a derivative of $1$ for all positive values of $x$, clipping the squared error to be between $-1$ and $1$ corresponds to using an absolute value loss function for errors outside of the $(-1,1)$ interval.</p>
</blockquote>
<h3 id="æ¡†æ¶">æ¡†æ¶</h3>
<p>DNQçš„æ¡†æ¶å¦‚ä¸‹æ‰€ç¤º<br>
<img src="/2019/03/02/dqn/nature-dqn.png" alt="ndqn"></p>
<h3 id="ä¼ªä»£ç -v2">ä¼ªä»£ç </h3>
<p>ç®—æ³• 2 deep Q-learning with experience replay, target network<br>
Initialize replay memory D to capacity N<br>
Initialize action-value function Q with random weights $\theta$<br>
Initialize target action-value function $\hat{Q}$ with weights $\theta^{-}=\theta$<br>
for episode = $1, M$ do<br>
$\ \ \ \ \ \ \ \ $Initialize sequence $s_1 = {x_1}$ and preprocessed sequenced $\phi_1 = \phi(s_1)$<br>
$\ \ \ \ \ \ \ \ $for $t = 1,T$ do<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $With probability $\varepsilon$ select a random action $a_t$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $otherwise select $a_t = max_a Q^{âˆ—}(\phi(s_t), a; Î¸)$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Execute action $a_t$ in emulator and observe reward $r_t$ and image $x_{t+1}$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Set $s_{t+1} = s_t, a_t, x_{t+1}$ and preprocess $\phi_{t+1} = \phi(s_{t+1})$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Store transition $(\phi_t, a_t, r_t, \phi_{t+1})$ in D<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Sample random minibatch of transitions $(\phi_j, a_j, r_j, \phi_{j+1})$ from D<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Set $y_j = \begin{cases}r_j&amp;\ \ \ \ for\ terminal\ \phi_{j+1}\\r_j+\gamma max_{aâ€™}Q(\phi_{j+1},aâ€™|\theta^{-})&amp;\ \ \ \ for\ non-terminal\ \phi_{j+1}\end{cases}$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Perform a gradient descent step on $(y_j âˆ’ Q(\phi_j, a_j|Î¸))^2$ with respect to the network parameters $\theta$<br>
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $Every $C$ steps reset $\hat{Q} = Q$<br>
$\ \ \ \ \ \ \ \ $end for<br>
end for</p>
<h2 id="double-dqn">Double DQN</h2>
<h3 id="ç›®çš„">ç›®çš„</h3>
<p>è§£å†³overestimateé—®é¢˜ï¼ŒQ-learningä¸­åœ¨estimated valuesä¸Šè¿›è¡Œäº†maxæ“ä½œï¼Œå¯èƒ½ä¼šå¯¼è‡´æŸäº›æ›´åçˆ±overestimated valueè€Œä¸æ˜¯underestimated valuesã€‚<br>
æœ¬æ–‡å°†Double Q-learningçš„æƒ³æ³•æ¨å¹¿åˆ°äº†dqnä¸Šå½¢æˆäº†double-dqnã€‚å®éªŒç»“æœè¡¨æ˜äº†overestimated valueå¯¹äºpolicyæœ‰å½±å“ï¼Œdouble ä¼šäº§ç”Ÿå¥½çš„action valueï¼ŒåŒæ—¶åœ¨ä¸€äº›æ¸¸æˆä¸Šä¼šå¾—åˆ°æ›´é«˜çš„scoresã€‚</p>
<h3 id="contributions">Contributions</h3>
<ol>
<li>è§£é‡Šäº†åœ¨large scale é—®é¢˜ä¸Šï¼ŒQ-learningè¢«overoptimisticçš„åŸå› æ˜¯å­¦ä¹ å›ºæœ‰çš„estimation errorsã€‚</li>
<li>overestimationåœ¨å®è·µä¸­æ˜¯å¾ˆå¸¸è§ï¼Œä¹Ÿå¾ˆä¸¥é‡çš„ã€‚</li>
<li>Double Q-learningå¯ä»¥å‡å°‘overoptimism</li>
<li>æå‡ºäº†double-dqnã€‚</li>
<li>double-dqnåœ¨æŸäº›æ¸¸æˆä¸Šå¯ä»¥æ‰¾åˆ°æ›´å¥½çš„policyã€‚</li>
</ol>
<h3 id="double-q-learning">Double Q-learning</h3>
<p>Q-learningç®—æ³•è®¡ç®—target value $y$çš„å…¬å¼å¦‚ä¸‹ï¼š<br>
$$y = r + \gamma max_aâ€™ Q(sâ€™, aâ€™|\theta_t)\tag{4}$$<br>
åœ¨è®¡ç®—target valueçš„æ—¶å€™ï¼Œä½¿ç”¨åŒä¸€ä¸ªç½‘ç»œé€‰æ‹©å’Œè¯„ä¼°action $aâ€™$ï¼Œè¿™å¯èƒ½ä¼šè®©ç½‘ç»œé€‰æ‹©ä¸€ä¸ªoverestimated valueï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªoveroptimistic value estimateã€‚æ‰€æœ‰å°±æœ‰äº†double Q-learningï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<br>
$$y = r + \gamma Q(sâ€™, argmax_aâ€™ Q(sâ€™,a;\theta_t);\thetaâ€™_t)\tag{5}$$<br>
target policyè¿˜æ˜¯greedy policyï¼Œé€šè¿‡ä½¿ç”¨$\theta$å¯¹åº”çš„ç½‘ç»œé€‰æ‹©actionï¼Œç„¶ååœ¨è®¡ç®—target valueçš„æ—¶å€™ä½¿ç”¨$\thetaâ€™$å¯¹åº”çš„ç½‘ç»œã€‚<br>
åŸæœ‰çš„å…¬å¼å¯ä»¥å†™æˆä¸‹å¼ï¼Œ<br>
$$y = r + \gamma Q(sâ€™, argmax_aâ€™ Q(sâ€™,a;\theta_t);\theta_t)\tag{6}$$<br>
å³é€‰æ‹©actionå’Œè®¡ç®—target valueéƒ½æ˜¯ä½¿ç”¨çš„åŒä¸€ä¸ªç½‘ç»œã€‚</p>
<h3 id="double-dqn-v2">Double dqn</h3>
<p><img src="/2019/03/02/dqn/double-dqn.png" alt="double-dqn"><br>
Double Q-learnignçš„åšæ³•æ˜¯åˆ†è§£target actionä¸­çš„max opearationä¸ºé€‰æ‹©å’Œevaluationã€‚è€Œåœ¨Nature-dqnä¸­ï¼Œæå‡ºäº†target networkï¼Œæ‰€ä»¥åˆ†åˆ«ä½¿ç”¨networkå’Œtarget networkå»é€‰æ‹©å’Œevaluation actionæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ï¼Œè¿™æ ·å­å…¬å¼å°±å˜æˆäº†<br>
$$y = r + \gamma Q(sâ€™, argmax_aâ€™ Q(sâ€™,a;\theta_t);\theta^{-}_t)\tag{7}$$<br>
å’ŒQ-learnignç›¸æ¯”ï¼Œå°†$\thetaâ€™$æ¢æˆäº†$\theta^{-}$ evaluate actionï¼Œtarget networkçš„æ›´æ–°å’Œnature-dqnä¸€æ ·ï¼Œè¿‡ä¸€æ®µæ—¶é—´å¤åˆ¶networkçš„å‚æ•°ã€‚</p>
<h3 id="double-q-learning-vs-q-learning">Double Q learning vs Q-learning</h3>
<p>å¯ä»¥åœ¨æ•°å­¦ä¸Šè¯æ˜ï¼ŒQ-learningæ˜¯overestimationçš„ï¼Œä½†æ˜¯double q leraingæ˜¯æ— åçš„ã€‚ã€‚ã€‚è¯æ˜ç•™å¾…ä»¥åå†è¯´ã€‚<br>
<todo><br>
<to do></to></todo></p>
<h3 id="ä¼ªä»£ç -v3">ä¼ªä»£ç </h3>
<p>ç®—æ³• 3: Double DQN Algorithm.<br>
è¾“å…¥: replay buffer $D$, åˆå§‹networkå‚æ•°$\theta$,target networkå‚æ•°$\theta^{-}$<br>
è¾“å…¥ : replay bufferçš„å¤§å°$N_r$, batch size $N_b$, target networkæ›´æ–°é¢‘ç‡$N^{-}$<br>
<strong>for</strong> episode $e \in {1, 2,\cdots, M}$ do<br>
$\qquad$åˆå§‹åŒ–frame sequence $\mathbf{x} \leftarrow ()$<br>
$\qquad$<strong>for</strong> $t \in {0, 1, \cdots}$ do<br>
$\qquad\qquad$è®¾ç½®state $s \leftarrow \mathbf{x}$, é‡‡æ · action $a \sim\pi_B$<br>
$\qquad\qquad$ç»™å®š$(s, a)$ï¼Œä»ç¯å¢ƒ$E$ä¸­é‡‡æ ·æ¥ä¸‹æ¥çš„frame $x_t$,æ¥æ”¶reward $r$,åœ¨åºåˆ—$\mathbf{x}$ä¸Šæ‹¼æ¥$x$<br>
$\qquad\qquad$<strong>if</strong> $|\mathbf{x}| \gt N_f$<br>
$\qquad\qquad$<strong>then</strong><br>
$\qquad\qquad\qquad$ä»$\mathbf{x}$ä¸­åˆ é™¤æœ€è€çš„frame $x_{t_min}$<br>
$\qquad\qquad$è®¾ç½®$sâ€™ \leftarrow \mathbf{x}$,æ·»åŠ transition tuple (s, a, r, s 0 ) åˆ°buffer Dä¸­ï¼Œå¦‚æœ$|D| \ge N_r$æ›¿æ¢æœ€è€çš„tuple<br>
$\qquad\qquad$é‡‡æ ·$N_b$ä¸ªtuples $(s, a, r, sâ€™) \sim Unif(D)$<br>
$\qquad\qquad$è®¡ç®—target values, one for each of $N_b$ tuples:<br>
$\qquad\qquad$å®šä¹‰$a^{max}(sâ€™; \theta) = arg max_{aâ€™} Q(sâ€™, aâ€™;\theta)$<br>
$\qquad\qquad y_j = \begin{cases}r&amp;\qquad if\ \ sâ€™\ \ is\ \ terminal\\ r+\gamma Q(sâ€™, a^{max}(sâ€™;\theta);\theta^{-}, &amp;\qquad otherwise\end{cases}$<br>
$\qquad\qquad$åˆ©ç”¨loss $||y_j âˆ’ Q(s, a; \theta)||^2$çš„æ¢¯åº¦æ›´æ–°<br>
$\qquad\qquad$æ¯éš”$N^{-}$ä¸ªæ­¥éª¤æ›´æ–°ä¸€ä¸‹target network å‚æ•°$\theta^{-}$<br>
$\qquad$<strong>end</strong><br>
<strong>end</strong></p>
<h3 id="å®éªŒ-v2">å®éªŒ</h3>
<p>æå‡ºäº†ä¸€ä¸ªæŒ‡æ ‡ï¼Œnormalized scoreï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<br>
$$score_{normalized} = \frac{score_{agent}- score_{random}}{score_{human}-score_{random}}\tag{8}$$<br>
åˆ†æ¯æ˜¯humanå’Œrandomä¹‹å·®ï¼Œå¯¹åº”$100%$ã€‚</p>
<h2 id="prioritized-dqn-per">Prioritized DQN(PER)</h2>
<h3 id="contributions-v2">contributions</h3>
<p>æœ¬æ–‡æå‡ºä¸€ç§äº†proritizing experienceçš„æ¡†æ¶ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¤šæ¬¡ä½¿ç”¨é‡è¦çš„transtions replayè¿›è¡Œæ›´æ–°ï¼Œè®©è®­ç»ƒå˜å¾—çš„æ›´æœ‰æ•ˆç‡ã€‚<br>
ä½¿ç”¨TD-errorsä½œä¸ºprioritization mechanismï¼Œç»™å‡ºäº†ä¸¤ç§protitizationè®¡ç®—æ–¹å¼ï¼Œæå‡ºäº†ä¸€ç§stochastic prioritizationä»¥åŠimportance samplingæ–¹æ³•ã€‚</p>
<h3 id="prioritized-replay">Prioritized replay</h3>
<p>å¯ä»¥ä»ä¸¤ä¸ªç»´åº¦ä¸Šè€ƒè™‘replay memeoryçš„æ”¹è¿›ï¼Œä¸€ä¸ªæ˜¯å­˜å“ªäº›experiencesï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨å“ªäº›experiencesè¿›è¡Œå›æ”¾ã€‚æœ¬æ–‡æ˜¯ä»ç¬¬äºŒä¸ªæ–¹å‘ä¸Šè¿›è¡Œçš„è€ƒè™‘ã€‚</p>
<p>ä»bufferä¸­éšæœºæŠ½æ ·çš„æ–¹æ³•ä¸­ï¼Œupdate stepså’Œmemory sizeæ˜¯çº¿æ€§å…³ç³»ï¼Œä½œè€…æƒ³æ‰¾ä¸€ä¸ªupdate stepså’Œmemory sizeæ˜¯logå…³ç³»çš„oracleï¼Œä½†æ˜¯å¾ˆé—æ†¾ï¼Œè¿™æ˜¯ä¸ç°å®çš„ï¼Œæ‰€ä»¥ä½œè€…æƒ³è¦æ‰¾ä¸€ç§æ¯”uniform random replayå¥½å°½é‡æ¥è¿‘oracleçš„æ–¹æ³•ã€‚</p>
<h4 id="prioritizion-with-td-error">Prioritizion with TD-error</h4>
<p>prioritized replayæœ€é‡è¦çš„éƒ¨åˆ†æ˜¯å¦‚ä½•è¯„ä»·æ¯ä¸€ä¸ªtransitionçš„é‡è¦ç¨‹åº¦ã€‚ä¸€ä¸ªç†æƒ³çš„criterionæ˜¯agentåœ¨å½“å‰çš„stateå¯ä»¥ä»æŸä¸ªtransitionä¸­å­¦åˆ°å¤šå°‘ã€‚è¿™ä¸ªmeasure metricæ˜¯ä¸ç¡®å®šçš„ï¼Œä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆæ˜¯ä½¿ç”¨TD error $\delta$ï¼Œè¡¨ç¤ºhow â€˜suprisingâ€™ æˆ–è€…upexpected the transitionï¼šå°±æ˜¯å½“å‰çš„valueç¦»next-step bootstrapå¾—åˆ°çš„valueç›¸å·®å¤šå°‘ï¼Œbooststrapå°±æ˜¯åŸºäºå…¶ä»–ä¼°è®¡å€¼è¿›è¡Œè®¡ç®—ã€‚ã€‚è¿™ä¸­æ–¹æ³•å¯¹äºincremental,online RLæ–¹æ³•ï¼Œä¾‹å¦‚SARSAä»¥åŠQ-learningæ¥è¯´éƒ½æ˜¯å¾ˆåˆé€‚çš„ï¼Œå› ä¸ºä»–ä»¬ä¼šè®¡ç®—TD-errorï¼Œç„¶åç»™TD-errorä¸€ä¸ªæ¯”ä¾‹ç³»æ•°ç”¨æ¥æ›´æ–°å‚æ•°ã€‚ç„¶åå½“rewardæ˜¯noisyçš„æ—¶å€™ï¼ŒTD-erroræ•ˆæœå¯èƒ½å¾ˆå·®ã€‚<br>
ä½œè€…åœ¨ä¸€ä¸ªäººå·¥è®¾è®¡çš„ç¯å¢ƒä¸­ä½¿ç”¨äº†greedy TD-error prioritizationç®—æ³•ï¼Œç®—æ³•åœ¨æ¯æ¬¡å­˜transitionåˆ°replay bufferçš„æ—¶å€™ï¼ŒåŒæ—¶è¿˜ä¼šå­˜ä¸€ä¸‹è¯¥transitionæœ€æ–°çš„TD-errorï¼Œç„¶ååœ¨æ›´æ–°çš„æ—¶å€™ä»memoryä¸­é€‰æ‹©TD-erroræœ€å¤§çš„transitionã€‚æœ€æ–°çš„transition TD-erroræ²¡æœ‰ç®—å‡ºæ¥ï¼Œå°±ç»™å®ƒä¸€ä¸ªæœ€å¤§çš„priorityï¼Œä¿è¯æ‰€æœ‰çš„experienceéƒ½è‡³å°‘è¢«çœ‹åˆ°è¿‡ä¸€æ¬¡ã€‚<br>
é‡‡ç”¨äºŒå‰å †ç”¨å®ç°ä¼˜å…ˆé˜Ÿåˆ—ï¼ŒæŸ¥æ‰¾å¤æ‚åº¦æ˜¯$O(1)$ï¼Œæ›´æ–°prioritiesçš„å¤æ‚åº¦æ˜¯$O(logN)$ã€‚</p>
<h4 id="stochastic-prioritization">Stochastic prioritization</h4>
<p>ä¸Šè¿°æ–¹æ³•æœ‰å¾ˆå¤šé—®é¢˜ã€‚ç¬¬ä¸€ï¼Œæ¯æ¬¡éƒ½sweepæ•´ä¸ªreplay memoryçš„è®¡ç®—é‡å¾ˆå¤§ï¼Œæ‰€ä»¥åªæœ‰è¢«replayedçš„experiencesçš„TD-errorsæ‰ä¼šè¢«æ›´æ–°ã€‚å¼€å§‹æ—¶ä¸€ä¸ªTD errorå¾ˆå°çš„transitionå¯èƒ½å¾ˆé•¿ä¸€æ®µäº‹ä»¶ä¸ä¼šè¢«replayedï¼Œè¿™å°±å¯¼è‡´äº†replay bufferçš„sliding windowä¸èµ·ä½œç”¨äº†ã€‚ç¬¬äºŒï¼ŒTD-errorå¯¹äºnoise spikeå¾ˆæ•æ„Ÿï¼Œè¿˜ä¼šè¢«bootstrapåŠ å‰§ï¼Œä¼°è®¡è¯¯å·®å¯èƒ½ä¼šæ˜¯å¦ä¸€ä¸ªnoiseã€‚ç¬¬ä¸‰ï¼Œgreedy prioritizationé›†ä¸­åœ¨experiencesçš„ä¸€ä¸ªsubsetï¼šerrorså‡å°çš„å¾ˆæ…¢ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨function appriximationæ—¶ï¼Œè¿™å°±æ„å‘³ç€åˆå§‹çš„é«˜errorçš„transitionsä¼šè¢«replayedçš„å¾ˆé¢‘ç¹ï¼Œç„¶åä¼šover-fittingå› ä¸ºç¼ºä¹diversityã€‚<br>
ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œå¼•å…¥äº†ä¸€ä¸ªä»‹äºpure greedy prioritizaitonä»¥åŠuniform random samplingä¹‹é—´çš„stochasticé‡‡æ ·æ–¹æ³•ï¼Œpriorityé«˜çš„transitionæœ‰æ›´å¤§çš„æ¦‚ç‡è¢«é‡‡æ ·ï¼Œè€Œlowest-priorityçš„transitionä¹Ÿæœ‰æ¦‚ç‡è¢«é€‰ä¸­ï¼Œå…·ä½“çš„å®šä¹‰transition $i$çš„æ¦‚ç‡å¦‚ä¸‹ï¼š<br>
$$P(i) = \frac{p_i^{\alpha}}{\sum_kp_k^{\alpha}}\tag{9}$$<br>
$\alpha$ç¡®å®šprioritizaitonçš„æ¯”é‡ï¼Œå¦‚æœ$\alpha=0$å°±æ˜¯unifromã€‚</p>
<p>æœ‰ä¸¤ç§$p_i$çš„è®¡ç®—æ–¹æ³•ï¼Œä¸€ç§æ˜¯ç›´æ¥çš„proportional prioritizationï¼Œ$p_i = |\delta_i| + \varepsilon$ï¼Œå…¶ä¸­$\varepsilon$æ˜¯ä¸€ä¸ªå°çš„æ­£æ•´æ•°ï¼Œç¡®å®šå½“$p_i=0$æ—¶ï¼Œè¯¥transitionä»èƒ½è¢«replayï¼›ç¬¬äºŒç§æ˜¯é—´æ¥çš„ï¼Œ$p_i = \frac{1}{rank(i)}$ï¼Œå…¶ä¸­$rank(i)$æ˜¯æ‰€æœ‰replay memoryä¸­çš„experiencesæ ¹æ®$|\delta_i|$æ’åºåçš„rankã€‚ç¬¬äºŒç§æ–¹æ³•çš„é²æ£’æ€§æ›´å¥½ã€‚<br>
åœ¨å®ç°ä¸Šï¼Œä¸¤ç§æ–¹æ³•éƒ½æœ‰ç›¸åº”çš„trickï¼Œè®©å¤æ‚åº¦ä¸ä¾èµ–äºmemory å¤§å°$N$ã€‚Proportional prioritizationé‡‡ç”¨äº†â€™sum-treeâ€™æ•°æ®ç»“æ„ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å®ƒçš„å­èŠ‚ç‚¹çš„childrenï¼Œprioritiesæ˜¯leaf nodesã€‚è€Œrank-basedæ–¹æ³•ï¼Œä½¿ç”¨çº¿æ€§å‡½æ•°ä¼°è®¡ç´¯è®¡å¯†åº¦å‡½æ•°ï¼Œå…·ä½“æ€ä¹ˆå®ç°æ²¡æœ‰ç»†çœ‹ã€‚</p>
<h4 id="annealing-the-bias">annealing the bias</h4>
<p>å› ä¸ºrandom sampleæ–¹æ³•ï¼Œsamplesä¹‹é—´æ²¡æœ‰ä¸€ç‚¹è”ç³»ï¼Œé€‰æ‹©æ¯ä¸€ä¸ªsampleçš„æ¦‚ç‡éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œä½†æ˜¯å¦‚æœåŠ ä¸Šäº†priorityï¼Œå°±æœ‰ä¸€ä¸ªbias towardé«˜priorityçš„samplesã€‚ISå’Œprioritized replayçš„ç»„åˆåœ¨non-learn FAä¸­æœ‰ä¸€ä¸ªç”¨å¤„ï¼Œlarge stepså¯èƒ½ä¼šäº§ç”Ÿä¸å¥½çš„å½±å“ï¼Œå› ä¸ºæ¢¯åº¦ä¿¡æ¯å¯èƒ½æ˜¯å±€éƒ¨reliableï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ä¸€ä¸ªå°ç‚¹çš„step-sizeã€‚<br>
åœ¨æœ¬æ–‡ä¸­ï¼Œhigh-errorçš„æ ·æœ¬å¯èƒ½ä¼šè§‚æµ‹åˆ°å¾ˆå¤šæ¬¡ï¼Œä½¿ç”¨ISå‡å°gradientçš„å¤§å°ï¼Œå¯¹åº”äºé«˜priorityçš„samplesçš„weightè¢«å¾®è°ƒäº†ä¸€ä¸‹ï¼Œè€Œå¯¹åº”äºä½priorityçš„æ ·æœ¬åŸºæœ¬ä¸å˜ã€‚<br>
weigthçš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<br>
$$w_i = (\frac{1}{N}\cdot \frac{1}{P(i)})^{\beta}\tag{10}$$<br>
OK,è¿™é‡ŒISçš„ä½œç”¨æœ‰äº›ä¸æ˜ç™½ã€‚ã€‚ã€‚ã€‚<todo></todo></p>
<h3 id="ä¼ªä»£ç -v4">ä¼ªä»£ç </h3>
<p>ç®—æ³• 4<br>
è¾“å…¥: minibatch $k$, å­¦ä¹ ç‡ï¼ˆæ­¥é•¿ï¼‰$\eta$, replay period $K$ and size $N$ , exponents $\alpha$ and $\beta$, budget $T$.<br>
åˆå§‹åŒ–replay memory $H = \emptyset, \Delta = 0, p_1 = 1$<br>
æ ¹æ®$S_0$é€‰æ‹© $A_0 \sim \pi_{\theta}|(S_0)$<br>
<strong>for</strong> $t = 1,\cdots, T$ do<br>
$\qquad$è§‚æµ‹$S_t, R_t, \gamma_t$<br>
$\qquad$å­˜å‚¨transition $(S_{tâˆ’1}, A_{tâˆ’1}, R_t , \gamma_t, S_t)$ åˆ°replay memoryï¼Œä»¥åŠ$p_t$çš„æœ€å¤§priority $p_t = max {i\lt t} p_i$<br>
$\qquad$<strong>if</strong> $t â‰¡ 0$ mod $K$ then<br>
$\qquad\qquad$<strong>for</strong> j = 1 to k do<br>
$\qquad\qquad\qquad$Sample transition $j \sim P(j) = \frac{p_j^{\alpha}}{\sum_i p_i^{\alpha}}$<br>
$\qquad\qquad\qquad$è®¡ç®—importance-sampling weight $w_j = \frac{(N \cdot P(j))^{\beta}}{max_i w_i}$<br>
$\qquad\qquad\qquad$è®¡ç®—TD-error $\delta_j = R_j + \gamma_j Q_{target} (S_j$, $arg max_a Q(S_j, a)) âˆ’ Q(S_{jâˆ’1} , A\ {jâˆ’1})$<br>
$\qquad\qquad\qquad$æ›´æ–°transitionçš„priority $p_j \leftarrow |\delta_j|$<br>
$\qquad\qquad\qquad$ç´¯è®¡weight-change $\Delta \leftarrow \Delta + w_j \cdot \delta_j \cdot \nabla_{\theta} Q(S_{jâˆ’1}, A_{jâˆ’1})$<br>
$\qquad\qquad$<strong>end for</strong><br>
$\qquad\qquad$æ›´æ–°weights $\theta\leftarrow \theta+ \eta\cdot\Delta$, é‡ç½®$\Delta = 0$<br>
$\qquad\qquad$æ¯éš”ä¸€æ®µæ—¶é—´æ›´æ–°target network $\theta_{target} \leftarrow \theta$<br>
$\qquad$<strong>end if</strong><br>
$\qquad$é€‰æ‹©action $A_t \sim \pi_{\theta}(S_t)$<br>
<strong>end for</strong></p>
<h3 id="å®éªŒ-v3">å®éªŒ</h3>
<p>ä¸¤ç»„å®éªŒï¼Œ<br>
ä¸€ç»„æ˜¯DQNå’Œproportional prioritizationä½œæ¯”è¾ƒã€‚<br>
ä¸€ç»„æ˜¯tuned Double DQNå’Œrank-basedä»¥åŠproportional prioritizaitonã€‚</p>
<h4 id="metrics-v2">Metrics</h4>
<p>ç”¨çš„æ˜¯double dqnæå‡ºæ¥çš„nomalized scoreï¼Œè¿™é‡Œåœ¨åˆ†æ¯ä¸ŠåŠ äº†ç»å¯¹å€¼ã€‚<br>
ä¸»è¦ç”¨çš„median scoreså’Œmean scoresã€‚</p>
<h2 id="dueling-dqn">Dueling DQN</h2>
<h3 id="ä»‹ç»">ä»‹ç»</h3>
<p>æœ¬æ–‡ä½œè€…æå‡ºæ¥å°†duelingç½‘ç»œæ¡†æ¶åº”ç”¨åœ¨model-freeç®—æ³•ä¸Šã€‚The dueling architectureèƒ½ç”¨ä¸€ä¸ªdeep modelåŒæ—¶è¡¨ç¤º$V(s)$å’Œä¼˜åŠ¿å‡½æ•°$A(s,a)$ï¼Œç½‘ç»œçš„è¾“å‡ºå°†$V$å’Œ$A$ç»“åˆäº§ç”Ÿ$Q(s,a)$ã€‚å’Œadvantageä¸ä¸€æ ·çš„æ˜¯ï¼Œè¿™ç§æ–¹å¼åœ¨æ„å»ºæ—¶å°±å°†ä»–ä»¬è¿›è¡Œäº†è§£è€¦ï¼Œå› æ­¤ï¼Œdueling architectureå¯ä»¥åº”ç”¨åœ¨å„ç§å„æ ·çš„model free RLç®—æ³•ä¸Šã€‚<br>
æœ¬æ–‡çš„æ¶æ„æ˜¯å¯¹ç®—æ³•åˆ›æ–°çš„è¡¥å……ï¼Œå®ƒå¯ä»¥å¯¹ä¹‹å‰å·²æœ‰çš„å„ç§DQNç®—æ³•è¿›è¡Œç»“åˆã€‚</p>
<h3 id="dueling-network-architecture">dueling network architecture</h3>
<p>è¿™ä¸ªæ–°çš„architectureçš„æ ¸å¿ƒæƒ³æ³•æ˜¯ï¼Œæ²¡æœ‰å¿…è¦ä¼°è®¡æ‰€æœ‰statesçš„aaction valueã€‚åœ¨ä¸€äº›statesï¼Œéœ€è¦action valueå»ç¡®å®šæ‰§è¡Œå“ªä¸ªactionï¼Œä½†æ˜¯åœ¨è®¸å¤šå…¶ä»–statesï¼Œaction valueså¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚å½“ç„¶ï¼Œå¯¹äºbootstrapç®—æ³•æ¥é¦–ï¼Œæ¯ä¸€ä¸ªstateçš„value estimationéƒ½å¾ˆé‡è¦ã€‚<br>
<img src="/2019/03/02/dqn/deuling-dqn.png" alt="dueling-dqn"><br>
ä½œè€…ç»™å‡ºäº†ä¸€ä¸ªsingle Q-networkçš„architectureï¼Œå¦‚å›¾æ‰€ç¤ºã€‚<br>
ç½‘ç»œç»“æ„å’Œnature-dqnä¸€æ ·ï¼Œä½†æ˜¯è¿™é‡ŒåŠ äº†ä¸¤ä¸ªfully connected layersï¼Œä¸€ä¸ªç”¨äºè¾“å‡º$V$ï¼Œä¸€ä¸ªç”¨äºè¾“å‡º$A$ã€‚ç„¶å$A$å’Œ$V$ç»“åˆåœ¨ä¸€èµ·ï¼Œäº§ç”Ÿ$Q$ï¼Œç½‘ç»œçš„è¾“å‡ºå’Œnature dqnä¸€æ ·ï¼Œå¯¹åº”äºæŸä¸ªstateçš„ä¸€ç³»åˆ—action valueã€‚<br>
ä»$Q$å‡½æ•°çš„å®šä¹‰$Q^{\pi}(s,a) = V^{\pi}(s)+A^{\pi}(s,a)$ä»¥åŠ$Q$å’Œ$V$ä¹‹é—´çš„å…³ç³»$V^{\pi}(s) = \mathbb{E}_{a\sim\pi(s)}\left[Q^{\pi}(s,a)\right] = \pi(a|s)Q^{\pi}(s,a)$ï¼Œæ‰€ä»¥æœ‰$\mathbb{E}_{a\sim\pi(s)}\left[A^{\pi}(s,a)\right]=0$ã€‚æ­¤å¤–ï¼Œå¯¹äºdeterministic policyï¼Œ$a^{*} = arg max_{aâ€™\in A}Q(s,aâ€™)$ï¼Œæœ‰$V(s) = Q(s,a^{*})$ï¼Œå³$A(s,a^{*}) = 0$ã€‚<br>
å¦‚å›¾æ‰€ç¤ºçš„networkä¸­ï¼Œä¸€ä¸ªç½‘ç»œè¾“å‡ºscalar $V(s;\theta, \beta)$ï¼Œä¸€ä¸ªç½‘ç»œè¾“å‡ºä¸€ä¸ª$|A|$ç»´çš„vector $A(s,a;\theta, \alpha)$ï¼Œå…¶ä¸­$\theta$æ˜¯ç½‘ç»œå‚æ•°ï¼Œ$\alpha$å’Œ$\beta$æ˜¯ä¸¤ä¸ªå…¨è¿æ¥å±‚çš„å‚æ•°ã€‚<br>
æ ¹æ®advantageçš„å®šä¹‰ï¼Œå¯ä»¥ç›´æ¥å°†ä»–ä»¬åŠ èµ·æ¥ï¼Œå³ï¼š<br>
$$Q(s,a;\theta, \alpha, \beta) = V(s;\theta, \beta) + A(s,a;\theta, \alpha) \tag{11}$$<br>
ä½†æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“çš„ä¸€ç‚¹æ˜¯ï¼Œ$Q(s, a;\theta, \alpha, \beta)$ä»…ä»…æ˜¯$Q$çš„ä¸€ä¸ªå‚æ•°åŒ–ä¼°è®¡ã€‚å®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯$V$ï¼Œä¸€éƒ¨åˆ†æ˜¯$A$ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„$V$å’Œ$Q$åªæ˜¯æˆ‘ä»¬å«å®ƒ$V$å’Œ$A$ï¼Œå®ƒçš„å®é™…æ„ä¹‰å¹¶ä¸æ˜¯$V$å’Œ$A$ã€‚ç»™äº†$Q$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»»æ„çš„$Q(s, a) = V(s) + A(s,a)$ï¼Œè€Œ$V$å’Œ$Q$å¹¶ä¸ä»£è¡¨value functionå’Œadvantage functinoã€‚<br>
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…æå‡ºäº†é€‰æ‹©è®©advantageä¸º$0$çš„actionï¼Œå³ï¼š<br>
$$Q(s, a; \theta,\alpha, \beta) = V(s; \theta, \beta) + \left(A(s,a;\theta,\alpha)-max_{aâ€™\in |A|}A(s, aâ€™; \theta, \alpha)\right)\tag{12}$$<br>
é€‰æ‹©$a^{*} = arg max_{aâ€™\in A} Q(s, aâ€™; \theta, \alpha, \beta) = arg max_{aâ€™\in A}A(s, aâ€™;\theta, \alpha)$ï¼Œæˆ‘ä»¬å¾—åˆ°$Q(s,a^{*}; \theta, \alpha,\beta) = V(s;\theta, \beta)$ã€‚è¿™ä¸ªæ—¶å€™ï¼Œè¾“å‡º$V$çš„ç½‘ç»œç»™å‡ºçš„çœŸçš„æ˜¯state valueçš„ä¼°è®¡$V(s;\theta, \beta)$ï¼Œå¦ä¸€ä¸ªç½‘ç»œçœŸçš„ç»™å‡ºçš„æ˜¯advantageçš„ä¼°è®¡ã€‚<br>
å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨meanå–ä»£maxæ“ä½œï¼š<br>
$$Q(s, a; \theta,\alpha, \beta) = V(s; \theta, \beta) + \left(A(s,a;\theta,\alpha)- \frac{1}{|A|}\sum_{aâ€™}A(s, aâ€™; \theta, \alpha)\right)\tag{13}$$<br>
ä¸€æ–¹é¢è¿™ç§æ–¹æ³•å¤±å»äº†$V$å’Œ$A$çš„åŸå§‹è¯­ä¹‰ï¼Œå› ä¸ºå®ƒä»¬æœ‰ä¸€ä¸ªå¸¸æ•°çš„off-targetï¼Œä½†æ˜¯å¦ä¸€æ–¹é¢å®ƒå¢åŠ äº†ä¼˜åŒ–çš„ç¨³å®šæ€§ï¼Œå› ä¸ºä¸Šå¼ä¸­advantageçš„æ”¹å˜åªéœ€è¦å’Œmeanä¿æŒä¸€è‡´å³å¯ï¼Œä¸éœ€è¦optimal actionâ€™s advantangeä¸€æœ‰å˜åŒ–å°±è¦æ”¹å˜ã€‚</p>
<h3 id="ä¼ªä»£ç -v5">ä¼ªä»£ç </h3>
<h2 id="distributed-dqn">Distributed DQN</h2>
<h2 id="noisy-dqn">Noisy DQN</h2>
<h3 id="ä»‹ç»-v2">ä»‹ç»</h3>
<p>å·²æœ‰æ–¹æ³•çš„explorationéƒ½æ˜¯é€šè¿‡agent policyçš„random perturbationsï¼Œæ¯”å¦‚å¸¸è§çš„$\varepsilon$-greedyç­‰æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ä¸èƒ½æ‰¾å‡ºç¯å¢ƒä¸­efficient explorationçš„behavioural patternsã€‚å¸¸è§çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§:<br>
ç¬¬ä¸€ç§æ–¹æ³•æ˜¯optimism in the face of uncertaintyï¼Œç†è®ºä¸Šè¯æ˜å¯è¡Œï¼Œä½†æ˜¯é€šå¸¸åº”ç”¨åœ¨state-action spaceså¾ˆå°çš„æƒ…å†µä¸‹æˆ–è€…linear FAï¼Œå¾ˆéš¾å¤„ç†non-linearn FAï¼Œè€Œä¸”non-linearæƒ…å†µä¸‹æ”¶æ•›æ€§æ²¡æœ‰ä¿è¯ã€‚<br>
å¦ä¸€ç§æ–¹æ³•æ˜¯æ·»åŠ é¢å¤–çš„intrinsic motivation termï¼Œè¯¥æ–¹æ³•çš„é—®é¢˜æ˜¯å°†ç®—æ³•çš„generalisation mechanismå’Œexplorationåˆ†å‰²å¼€ï¼Œå³æœ‰instrinsic rewardå’Œenvironment rewardï¼Œå®ƒä»¬çš„æ¯”ä¾‹å¦‚ä½•å»è®¾ç½®ï¼Œéœ€è¦è®¤ä¸ºæŒ‡å®šã€‚å¦‚æœä¸ä»”ç»†è°ƒæ•´ï¼Œoptimal policyå¯èƒ½ä¼šå—intrinsic rewardå½±å“å¾ˆå¤§ã€‚æ­¤å¤–ä¸ºäº†å¢åŠ explorationçš„é²é‚¦æ€§ï¼Œæ‰°åŠ¨é¡¹ä»ç„¶æ˜¯éœ€è¦çš„ã€‚è¿™äº›ç®—æ³•å¾ˆå…·ä½“ä¹Ÿèƒ½åº”ç”¨åœ¨å‚æ•°åŒ–policyä¸Šï¼Œä½†æ˜¯å¾ˆä½æ•ˆï¼Œè€Œä¸”éœ€è¦å¾ˆå¤šæ¬¡policy evaluationã€‚<br>
æœ¬æ–‡æå‡ºNoisyNetå­¦ä¹ ç½‘ç»œå‚æ•°çš„perturbationsï¼Œä¸»è¦æƒ³æ³•æ˜¯å‚æ•°çš„ä¸€ç‚¹æ”¹å˜å¯èƒ½ä¼šå¯¼è‡´policyåœ¨å¾ˆå¤šä¸ªtimstepsä¸Šçš„consistentï¼Œcomplex, state-dependentçš„å˜åŒ–ï¼Œè€Œå¦‚$\varepsilon$-greedyçš„ditheringç®—æ³•ä¸­ï¼Œæ¯ä¸€æ­¥æ·»åŠ åˆ°policyä¸Šçš„noiseéƒ½æ˜¯ä¸ç›¸å…³çš„ã€‚pertubationsä»ä¸€ä¸ªnoiseåˆ†å¸ƒä¸­è¿›è¡Œé‡‡æ ·ï¼Œå®ƒçš„varianceå¯ä»¥çœ‹æˆnoiseçš„energyï¼Œvarianceçš„å‚æ•°å’Œç½‘ç»œå‚æ•°éƒ½æ˜¯é€šè¿‡lossçš„æ¢¯åº¦è¿›è¡Œæ›´æ–°ã€‚ç½‘ç»œå‚æ•°ä¸­ä»…ä»…åŠ å…¥äº†å™ªéŸ³ï¼Œæ²¡æœ‰distributionï¼Œå¯ä»¥è‡ªåŠ¨å­¦ä¹ ã€‚<br>
åœ¨é«˜ç»´åº¦ä¸Šï¼Œæœ¬æ–‡çš„ç®—æ³•æ˜¯ä¸€ä¸ªrandomised value functionï¼Œè¿™ä¸ªå‡½æ•°æ˜¯neural networkï¼Œç½‘ç»œçš„å‚æ•°å¹¶æ²¡æœ‰åŠ å€ï¼Œlinear çš„å‚æ•°åŠ å€ï¼Œè€Œå‚æ•°æ˜¯noiseçš„ä¸€ä¸ªç®€å•å˜æ¢ã€‚<br>
è¿˜æœ‰äººæ·»åŠ constant Gaussian nioseåˆ°ç½‘ç»œå‚æ•°ï¼Œè€Œæ–‡æœ¬çš„ç®—æ³•æ·»åŠ çš„noiseå¹¶ä¸æ˜¯é™åˆ¶åœ¨Gaussion noise distributionsã€‚æ·»åŠ noiseè¾…åŠ©è®­ç»ƒåœ¨ç›‘ç£å­¦ä¹ ç­‰ä»»åŠ¡ä¸­ä¸€ç›´éƒ½æœ‰ï¼Œä½†æ˜¯è¿™äº›å™ªéŸ³éƒ½æ˜¯ä¸èƒ½è®­ç»ƒçš„ï¼Œè€ŒNoisyNetä¸­çš„å™ªéŸ³æ˜¯å¯ä»¥æ¢¯åº¦ä¸‹é™æ›´æ–°çš„ã€‚</p>
<h3 id="noisynets">NoisyNets</h3>
<p><img src="/2019/03/02/dqn/noisy_linear_layer.png" alt="noisy_linear_layer"><br>
ç”¨$\theta$è¡¨ç¤ºnoisy netçš„å‚æ•°ï¼Œè¾“å…¥æ˜¯$x$ï¼Œè¾“å‡ºæ˜¯$y$ï¼Œå³$y=f_{\theta}(x)$ã€‚$\theta$å®šä¹‰ä¸º$\theta=\mu+\Sigma\odot\varepsilon$ï¼Œå…¶ä¸­$\zeta=(\mu,\Sigma)$è¡¨ç¤ºå¯ä»¥å­¦ä¹ çš„å‚æ•°ï¼Œ$\varepsilon$è¡¨ç¤ºæœä»å›ºå®šåˆ†å¸ƒçš„å‡å€¼ä¸º$0$çš„å™ªéŸ³,$\varepsilon$æ˜¯random variableã€‚$\odot$è¡¨ç¤ºelement-wiseä¹˜æ³•ã€‚æœ€åçš„losså‡½æ•°æ˜¯å…³äº$\varepsilon$çš„æœŸæœ›ï¼š$\bar{L}(\zeta)=\mathbb{E}\left[L(\theta)\right]$ï¼Œç„¶åä¼˜åŒ–ç›¸åº”çš„$\zeta$ï¼Œ$\varepsilon$ä¸èƒ½è¢«ä¼˜åŒ–ï¼Œå› ä¸ºå®ƒæ˜¯random variableã€‚<br>
ä¸€ä¸ªæœ‰$p$ä¸ªè¾“å…¥å•å…ƒï¼Œ$q$ä¸ªè¾“å‡ºå•å…ƒçš„fully-connected layerè¡¨ç¤ºå¦‚ä¸‹ï¼š<br>
$$y=wx+b \tag{14}$$<br>
å…¶ä¸­$w\in \mathbb{R}^{q\times p}$ï¼Œ$x\in \mathbb{R}^{p}$,$b\in \mathbb{R}^{q}$ï¼Œå¯¹åº”çš„noisy linear layerå®šä¹‰å¦‚ä¸‹ï¼š<br>
$$y=(\mu^w+\sigma^w\odot\varepsilon^w)x + \mu^b+\sigma^b\odot\varepsilon^b \tag{15}$$<br>
å°±æ˜¯ç”¨$\mu^w+\sigma^w\odot\varepsilon^w$å–ä»£$w$ï¼Œç”¨$\mu^b+\sigma^b\odot\varepsilon^b$å–ä»£$b$ã€‚å…¶ä¸­$\mu^w,\sigma^w\in \mathbb{R}^{q\times p} $ï¼Œè€Œ$\mu^b,\sigma^b\in\mathbb{R}^{q}$æ˜¯å¯ä»¥å­¦ä¹ çš„å‚æ•°ï¼Œè€Œ$\varepsilon^w\in \mathbb{R}^{p\times q},\varepsilon^b \in \mathbb{R}^{q}$æ˜¯random variableã€‚<br>
ä½œè€…æå‡ºäº†ä¸¤ç§æ·»åŠ noiseçš„æ–¹å¼ï¼Œä¸€ç§æ˜¯Independent Gaussian noiseï¼Œä¸€ç§æ˜¯Factorised Gaussion noiseã€‚ä½¿ç”¨Factorisedçš„åŸå› æ˜¯å‡å°‘éšæœºå˜é‡çš„è®¡ç®—æ—¶é—´ï¼Œè¿™äº›æ—¶é—´å¯¹äºå•çº¿ç¨‹çš„ä»»åŠ¡æ¥è¯´è¿˜æ˜¯å¾ˆå¤šçš„ã€‚</p>
<h4 id="independent-gaussian-noise">Independent Gaussian noise</h4>
<p>åº”ç”¨åˆ°æ¯ä¸€ä¸ªweightå’Œbiasçš„noiseéƒ½æ˜¯independentçš„ï¼Œå¯¹äº$\varepsilon^w$çš„æ¯ä¸€é¡¹$\varepsilon_{i,j}^w$æ¥è¯´ï¼Œå®ƒä»¬çš„å€¼éƒ½æ˜¯ä»ä¸€ä¸ªunit Gaussion distributionä¸­é‡‡æ ·å¾—åˆ°çš„ï¼›$varepsilon^b$åŒç†ã€‚æ‰€ä»¥å¯¹äºä¸€ä¸ª$p$ä¸ªè¾“å…¥,$q$ä¸ªè¾“å‡ºçš„noisy linear layeræ€»å…±æœ‰$pq+q$ä¸ªnoise å˜é‡ã€‚</p>
<h4 id="factorised-gaussian-noise">Factorised Gaussian noise</h4>
<p>é€šè¿‡å¯¹$\varepsilon_{i,j}^w$æ¥è¯´ï¼Œå¯ä»¥å°†å…¶åˆ†è§£æˆ$p$ä¸ª$\varepsilon_i$ç”¨äº$p$ä¸ªè¾“å…¥å’Œ$q$ä¸ª$\varepsilon_j$ç”¨äº$q$ä¸ªè¾“å‡ºï¼Œæ€»å…±æœ‰$p+q$ä¸ªnoisså˜é‡ã€‚æ¯ä¸€ä¸ª$\varepsilon_{i,j}^w$å’Œ$\varepsilon_{j}^b$å¯ä»¥å†™æˆï¼š<br>
$$\varepsilon_{i,j}^w = f(\varepsilon_i)f(\varepsilon_j) \tag{16}$$<br>
$$\varepsilon_{j}^b = f(\varepsilon_j)\tag{17}$$<br>
å…¶ä¸­$f$æ˜¯ä¸€ä¸ªå®å‡½æ•°ï¼Œåœ¨ç¬¬ä¸€ä¸ªå¼å­ä¸­$f(x) = sng(x)\sqrt{|x|}$ï¼Œåœ¨ç¬¬äºŒä¸ªå¼å­ä¸­å¯ä»¥å–$f(x)=x$ï¼Œè¿™é‡Œé€‰æ‹©äº†å’Œç¬¬ä¸€ä¸ªå¼å­ä¸­ä¸€è‡´ã€‚<br>
å› ä¸ºnoisy networkçš„losså‡½æ•°æ˜¯$\bar{L}(\zeta)=\mathbb{E}\left[L(\theta)\right]$ï¼Œæ˜¯å…³äºnoiseçš„ä¸€ä¸ªæœŸæœ›ï¼Œæ¢¯åº¦å¦‚ä¸‹ï¼š<br>
$$\nabla\bar{L}(\zeta)=\nabla\mathbb{E}\left[L(\theta)\right]=\mathbb{E}\left[\nabla_{\mu,\Sigma}L(\mu+\Sigma\odot\varepsilon)\right] \tag{18}$$<br>
ä½¿ç”¨Monte Carloä¼°è®¡ä¸Šè¿°æ¢¯åº¦ï¼Œåœ¨æ¯ä¸€ä¸ªstepé‡‡æ ·ä¸€ä¸ªsampleè¿›è¡Œoptimization:<br>
$$\nabla\bar{L}(\zeta)\approx\nabla_{\mu,\Sigma}L(\mu+\Sigma\odot\varepsilon) \tag{19}$$</p>
<h3 id="noisy-dqn-and-dueling">Noisy DQN and dueling</h3>
<p>ç›¸å¯¹äºDQNå’Œdueling DQNæ¥è¯´ï¼Œnoisy DQN and duelingä¸»è¦åšäº†ä¸¤æ–¹é¢çš„æ”¹è¿›ï¼š</p>
<ol>
<li>ä¸å†ä½¿ç”¨$\varepsilon$-greedy behaviour policyäº†ï¼Œè€Œæ˜¯ä½¿ç”¨greedy behaviour policyé‡‡æ ·ä¼˜åŒ–randomised action-value functionã€‚</li>
<li>ç½‘ç»œä¸­çš„fully connected layerså…¨éƒ½æ¢æˆäº†å‚æ•°åŒ–çš„noisy networkï¼Œnoisy networkçš„å‚æ•°åœ¨æ¯ä¸€æ¬¡replayä¹‹åä»noiseæœä»çš„distributionä¸­è¿›è¡Œé‡‡æ ·ã€‚è¿™é‡Œä½¿ç”¨çš„noseæ˜¯factorised Gaussian noiseã€‚</li>
</ol>
<p>åœ¨replay æ•´ä¸ªbatchçš„è¿‡ç¨‹ä¸­ï¼Œnoisy network parameter sampleä¿æŒä¸å˜ã€‚å› ä¸ºDQNå’ŒDuelingæ¯æ‰§è¡Œä¸€ä¸ªaction stepä¹‹åéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡optimizationï¼Œæ¯æ¬¡é‡‡æ ·actionä¹‹å‰éƒ½è¦é‡æ–°é‡‡æ ·noisy network parametersã€‚</p>
<h4 id="loss">Loss</h4>
<p>$Q(s,a,\epsilon;\zeta)$å¯ä»¥çœ‹æˆ$\zeta$çš„ä¸€ä¸ªrandom variableï¼ŒNoisyNet-DQN losså¦‚ä¸‹ï¼š<br>
$$\bar{L}(\zeta) = \mathbb{E}\left[\mathbb{E}_{(x,a,r,y)}\sim D\left[r + \gamma max_{b\in A}Q(y, b, \varepsilonâ€™;\zeta^{-}) - Q(x,a,\varepsilon;\zeta)\right]^2\right]\tag{20}$$<br>
å…¶ä¸­å¤–å±‚çš„æœŸæœ›æ˜¯$\varepsilon$ç›¸å¯¹äºnoisy value function $Q(x,a, \varepsilon;\zeta)$å’Œ$\varepsilonâ€™$ç›¸å¯¹äºnoisy target value function $Q(x,a, \varepsilonâ€™;\zeta^{-}$ã€‚å¯¹äºbufferä¸­çš„æ¯ä¸€ä¸ªtransitionï¼Œè®¡ç®—lossçš„æ— åä¼°è®¡ï¼Œåªéœ€è¦è®¡ç®—target valueå’Œtrue valueå³å¯ï¼Œä¸ºäº†è®©target valueå’Œtrueä¹‹é—´æ²¡æœ‰å…³è”ï¼Œtarget networkå’Œonline networké‡‡ç”¨independent noisesã€‚<br>
å°±double dqnä¸­çš„actioné€‰æ‹©æ¥è¯´ï¼Œé‡‡æ ·ä¸€ä¸ªæ–°çš„independent sample $\varepsilon^{â€™â€™}$è®¡ç®—action valueï¼Œç„¶åä½¿ç”¨greedyæ“ä½œï¼ŒNoisyNet-Duelingçš„losså¦‚ä¸‹ï¼š<br>
$$\bar{L}(\zeta) = \mathbb{E}\left[\mathbb{E}_{(x,a,r,y)}\sim D\left[r + \gamma Q(y, b^{*}(y), \varepsilonâ€™;\zeta^{-} - Q(x,a,\varepsilon;\zeta)\right]^2\right]\tag{21}$$<br>
$$b^{*}(y) = arg max_{b\in A} Q(y, b(y), \varepsilon^{â€™â€™};\zeta)\tag{22}$$</p>
<h3 id="noisy-a3c">Noisy-A3C</h3>
<p>Noisy-A3Cç›¸å¯¹äºA3Cæœ‰ä»¥ä¸‹çš„æ”¹è¿›ï¼š</p>
<ol>
<li>entropyé¡¹è¢«å»æ‰äº†;</li>
<li>fully-connected layerè¢«æ›¿æ¢æˆäº†noisy networkã€‚</li>
</ol>
<p>A3Cç®—æ³•ä¸­æ²¡æœ‰åƒ$\epsilon$-greedyè¿™æ ·è¿›è¡Œaction explorationï¼Œé€‰ä¸­çš„actioné€šå¸¸æ˜¯ä»current policyä¸­é€‰çš„ï¼ŒåŠ å…¥entropyæ˜¯ä¸ºäº†é¼“åŠ±explorationï¼Œè€Œä¸æ˜¯é€‰æ‹©ä¸€ä¸ªdeterministic policyã€‚å½“æ·»åŠ äº†noisy weightsæ—¶ï¼Œå¯¹å‚æ•°è¿›è¡Œé‡‡æ ·å°±è¡¨ç¤ºé€‰æ‹©ä¸åŒçš„current policyï¼Œå°±å·²ç»ä»£è¡¨äº†explorationã€‚NoisyNetç›¸å½“äºç›´æ¥åœ¨policy spaceä¸­è¿›è¡Œexplorationï¼Œè€Œentropyé¡¹å°±å¯ä»¥å»æ‰äº†ã€‚</p>
<h3 id="noisy-networksçš„åˆå§‹åŒ–">Noisy Networksçš„åˆå§‹åŒ–</h3>
<p>åœ¨unfactorised noisy networksä¸­ï¼Œæ¯ä¸ª$\mu_{i,j}$ä»ç‹¬ç«‹çš„å‡åŒ€åˆ†å¸ƒ$U\left[-\sqrt{\frac{3}{p}}, \sqrt{\frac{3}{p}}\right]$ä¸­é‡‡æ ·åˆå§‹åŒ–ï¼Œå…¶ä¸­$p$æ˜¯å¯¹åº”linear layerçš„è¾“å…¥ä¸ªæ•°ï¼Œ$\sigma_{i,j}$è®¾ç½®ä¸ºä¸€ä¸ªå¸¸æ•°$0.0017$ï¼Œè¿™æ˜¯ä»ç›‘ç£å­¦ä¹ çš„ä»»åŠ¡ä¸­å€Ÿé‰´çš„ã€‚<br>
åœ¨factorised noisy netowrksä¸­ï¼Œæ¯ä¸ª$\mu_{i,j}$ä»ç‹¬ç«‹çš„å‡åŒ€åˆ†å¸ƒ$U\left[-\sqrt{\frac{1}{p}}, \sqrt{\frac{1}{p}}\right]$ä¸­è¿›è¡Œé‡‡æ ·ï¼Œ$\sigma_{i,j}$è®¾ç½®ä¸º$\frac{\sigma_0}{p}$ï¼Œè¶…å‚æ•°$\sigma_0$è®¾ç½®ä¸º$0.5$ã€‚</p>
<h3 id="ä¼ªä»£ç -v6">ä¼ªä»£ç </h3>
<p>ç®—æ³•5 NoisyNet-DQN / NoisyNet-Dueling<br>
è¾“å…¥: Env Environment; $\varepsilon$ random variables of the networkçš„é›†åˆ<br>
è¾“å…¥: DUELING Boolean; &quot;true&quot;ä»£è¡¨NoisyNet-Dueling and &quot;false&quot;ä»£è¡¨ NoisyNet-DQN<br>
è¾“å…¥: $B$ç©ºreplay buffer; $\zeta$åˆå§‹çš„network parameters; $\zeta^{-}$åˆå§‹çš„target network parameters<br>
è¾“å…¥: replay bufferå¤§å°$N_B$; batch size $N_T$; target networkæ›´æ–°é¢‘ç‡$N^{-}$<br>
è¾“å‡º: $Q(\cdot, \varepsilon; \zeta)$ action-value function<br>
<strong>for</strong> episode $e\in  {1,\cdots , M}$ do<br>
$\qquad$åˆå§‹åŒ–state sequence $x_0 \sim Env$<br>
$\qquad$<strong>for</strong> $t \in {1,\cdots }$ do<br>
$\qquad\qquad$è®¾ç½®$x \leftarrow x_0$<br>
$\qquad\qquad$é‡‡æ · a noisy network  $\xi\sim \varepsilon$<br>
$\qquad\qquad$é€‰æ‹©an action $a \leftarrow arg max_{b\in A} Q(x, b, \xi; \zeta)$<br>
$\qquad\qquad$é‡‡æ · next state $y \sim  P (\cdot|x, a)$, æ¥æ”¶ reward $r \leftarrow R(x, a) $ä»¥åŠ$x_0 \leftarrow y$<br>
$\qquad\qquad$å°†transition (x, a, r, y)æ·»åŠ åˆ°replay buffer<br>
$\qquad\qquad$<strong>if</strong> $|B| \gt N_B$ then<br>
$\qquad\qquad\qquad$åˆ æ‰æœ€è€çš„transition<br>
$\qquad\qquad$<strong>end if</strong><br>
$\qquad$é‡‡æ ·ä¸€ä¸ªå¤§å°ä¸º$N_T$çš„batch, transitions $((x_j, a_j, r_j, y_j) \sim D)_{j=1}^{N_T}$<br>
$\qquad\qquad$é‡‡æ ·noisy variablesç”¨äºonline network $\xi \sim\varepsilon$<br>
$\qquad\qquad$é‡‡æ ·noisy variablesç”¨äºtarget network $\xiâ€™\sim\varepsilon$<br>
$\qquad\qquad\qquad$<strong>if</strong> DUELING then<br>
$\qquad\qquad\qquad$é‡‡æ ·noisy variablesç”¨äºé€‰æ‹©actionçš„network $\xi\sim\varepsilon$<br>
$\qquad\qquad$<strong>end if</strong><br>
$\qquad\qquad$<strong>for</strong> $j \in {1,\cdots, N_T}$ do<br>
$\qquad\qquad\qquad$<strong>if</strong> $y_j$ is a terminal state then<br>
$\qquad\qquad\qquad\qquad$$\hat{Q}\leftarrow r_j$<br>
$\qquad\qquad\qquad$<strong>end if</strong><br>
$\qquad\qquad\qquad$<strong>if</strong> DUELING then<br>
$\qquad\qquad\qquad\qquad b^{*}(y_j) = arg max_{b\in A} Q(y_j, b, \xi^{â€™â€™}; \zeta)$<br>
$\qquad\qquad\qquad\qquad\qquad \hat{Q}\leftarrow r_j + \gamma Q(y_j, b^{*}(y_j), \xiâ€™;\zeta^{-})$<br>
$\qquad\qquad\qquad$<strong>else</strong><br>
$\qquad\qquad\qquad\qquad$$\hat{Q}\leftarrow r_j + \gamma max_{b\in A} Q(y_j, b, \xiâ€™;\zeta^{-})$<br>
$\qquad\qquad$<strong>end if</strong><br>
$\qquad\qquad\qquad$åˆ©ç”¨loss $(\hat{Q}-Q(x_j,a_j, \xi;\zeta))^2$çš„æ¢¯åº¦æ›´æ–°$\zeta$<br>
$\qquad\qquad$<strong>end for</strong><br>
$\qquad\qquad$æ¯éš”$N^{-}$æ­¥æ›´æ–°target network:$ \zeta^{âˆ’}\leftarrow \zeta$<br>
$\qquad$<strong>end for</strong><br>
<strong>end for</strong></p>
<p>ç®—æ³•6 NoisyNet-A3C for each actor-learner thread<br>
è¾“å…¥: Environment Env, å…¨å±€å…±äº«å‚æ•°$(\zeta_{\pi},\zeta_{V})$ , å…¨å±€å…±äº«counter $T$å’Œmaximal time $T_{max}$<br>
è¾“å…¥: æ¯ä¸ªçº¿ç¨‹çš„å‚æ•° $(\zetaâ€™_{\pi},\zetaâ€™_{V})$, random variables $\varepsilon$çš„é›†åˆ, æ¯ä¸ªçº¿ç¨‹çš„counter $t$å’ŒTD-$\gamma$çš„é•¿åº¦$t_{max}$<br>
è¾“å‡º: policy $\pi(\cdot; \zeta_{\pi}, \varepsilon)$å’Œvalue $V(\cdot; \zeta_{V}, \varepsilon)$<br>
åˆå§‹åŒ–çº¿ç¨‹counter $t \leftarrow 1$<br>
<strong>repeat</strong><br>
$\qquad$é‡ç½®acumulative gradients: $d\zeta_{\pi}\leftarrow 0$å’Œ$d\zeta_V \leftarrow 0$<br>
$\qquad$Synchroniseæ¯ä¸ªçº¿ç¨‹çš„parameters: $\zetaâ€™_{\pi}\leftarrow \zeta_{\pi}$å’Œ$\zeta_V\leftarrow \zeta_V$<br>
$\qquad$counter $\leftarrow 0$<br>
$\qquad$ä»Envä¸­å¾—åˆ°state $x_t$<br>
$\qquad$é‡‡æ ·noise: $\xi\sim\varepsilon$<br>
$\qquad r \leftarrow []$<br>
$\qquad a \leftarrow []$<br>
$\qquad x \leftarrow []$å’Œ$x[0] \leftarrow x_t$<br>
$\qquad$<strong>repeat</strong><br>
$\qquad\qquad$é‡‡æ ·action: $a_t \sim\pi(\cdot|x_t;\zetaâ€™_{\pi};\xi)$<br>
$\qquad\qquad$$a[âˆ’1]\leftarrow a_t$<br>
$\qquad\qquad$æ¥æ”¶reward $r_t$å’Œnext state $x_{t+1}$<br>
$\qquad\qquad$$r[âˆ’1]\leftarrow r_t$å’Œ$x[âˆ’1]\leftarrow x_t+1$<br>
$\qquad\qquad$$t\leftarrow t + 1$å’Œ $T\leftarrow T + 1$<br>
$\qquad\qquad$$counter = counter + 1$<br>
$\qquad\qquad$<strong>until</strong> $x_t\ \ terminal\ \ or\ \ counter == t_{max} + 1$<br>
$\qquad$<strong>if</strong> $x_t$ is a terminal state then<br>
$\qquad\qquad$$Q = 0$<br>
$\qquad$<strong>else</strong><br>
$\qquad\qquad$$Q = V(x_t; \zetaâ€™_{V}, \xi)$<br>
$\qquad$<strong>end if</strong><br>
$\qquad$<strong>for</strong> $i \in {counter âˆ’ 1, \cdots, 0}$ do<br>
$\qquad\qquad$æ›´æ–°Q: $Q\leftarrow r[i] + \gamma Q$<br>
$\qquad\qquad$ç´¯ç§¯policy-gradient: $d\zeta_{\pi} \leftarrow d\zeta_{\pi} + \nabla \zetaâ€™_{\pi}log(\pi(a[i]|x[i]; \zetaâ€™_{\pi}, \xi))[Q âˆ’ V(x[i]; \zetaâ€™_{\pi}V, \xi)]$<br>
$\qquad\qquad$ç´¯ç§¯ value-gradient: $d\zeta_V \leftarrow â† d\zeta_V+ \nabla \zetaâ€™_{V}[Q âˆ’ V(x[i]; \zetaâ€™_{V}, \xi)]^2$<br>
$\qquad$<strong>end for</strong><br>
$\qquad$æ‰§è¡Œ$\zeta_{\pi}$çš„asynchronous update: $\zeta_{\pi}\leftarrow \zeta_{\pi} + \alpha_{\pi}d\zeta_{\pi}$<br>
$\qquad$æ‰§è¡Œ$\zeta_{V}$çš„asynchronous update: $\zeta_{V}\leftarrow \zeta_{V} âˆ’ \alpha_VdV\zeta_{V}$<br>
<strong>until</strong> $T \gt T_{max}$</p>
<h2 id="rainbow">Rainbow</h2>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<p>1.<a href="https://blog.csdn.net/yangshaokangrushi/article/details/79774031" target="_blank" rel="noopener">https://blog.csdn.net/yangshaokangrushi/article/details/79774031</a><br>
2.<a href="https://link.springer.com/article/10.1007%2FBF00992698" target="_blank" rel="noopener">https://link.springer.com/article/10.1007%2FBF00992698</a><br>
3.<a href="https://www.jianshu.com/p/b92dac7a4225" target="_blank" rel="noopener">https://www.jianshu.com/p/b92dac7a4225</a><br>
4.<a href="https://datascience.stackexchange.com/questions/20535/what-is-experience-replay-and-what-are-its-benefits/20542#20542" target="_blank" rel="noopener">https://datascience.stackexchange.com/questions/20535/what-is-experience-replay-and-what-are-its-benefits/20542#20542</a><br>
5.<a href="https://stats.stackexchange.com/questions/897/online-vs-offline-learning" target="_blank" rel="noopener">https://stats.stackexchange.com/questions/897/online-vs-offline-learning</a><br>
6.<a href="https://www.freecodecamp.org/news/improvements-in-deep-q-learning-dueling-double-dqn-prioritized-experience-replay-and-fixed-58b130cc5682/" target="_blank" rel="noopener">https://www.freecodecamp.org/news/improvements-in-deep-q-learning-dueling-double-dqn-prioritized-experience-replay-and-fixed-58b130cc5682/</a><br>
7.<a href="https://jaromiru.com/2016/11/07/lets-make-a-dqn-double-learning-and-prioritized-experience-replay/" target="_blank" rel="noopener">https://jaromiru.com/2016/11/07/lets-make-a-dqn-double-learning-and-prioritized-experience-replay/</a><br>
8.<a href="https://datascience.stackexchange.com/questions/32873/prioritized-replay-what-does-importance-sampling-really-do" target="_blank" rel="noopener">https://datascience.stackexchange.com/questions/32873/prioritized-replay-what-does-importance-sampling-really-do</a><br>
9.<a href="https://papers.nips.cc/paper/5249-weighted-importance-sampling-for-off-policy-learning-with-linear-function-approximation.pdf" target="_blank" rel="noopener">https://papers.nips.cc/paper/5249-weighted-importance-sampling-for-off-policy-learning-with-linear-function-approximation.pdf</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/01/29/Modeling-Others-using-Oneself-in-Multi-Agent-Reinforcement-Learning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/29/Modeling-Others-using-Oneself-in-Multi-Agent-Reinforcement-Learning/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">Modeling Others using Oneself in Multi-Agent Reinforcement Learning</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-29 13:19:33" itemprop="dateCreated datePublished" datetime="2019-01-29T13:19:33+08:00">2019-01-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-07 00:22:27" itemprop="dateModified" datetime="2019-05-07T00:22:27+08:00">2019-05-07</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/å¼ºåŒ–å­¦ä¹ /" itemprop="url" rel="index"><span itemprop="name">å¼ºåŒ–å­¦ä¹ </span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="æ‘˜è¦">æ‘˜è¦</h2>
<p>æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ä¸å®Œå…¨ä¿¡æ¯çš„å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ é—®é¢˜ï¼Œæ¯ä¸ªæ™ºèƒ½ä½“çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–è‡ªèº«çš„æ•ˆç”¨ã€‚å¥–åŠ±å‡½æ•°å–å†³äºä¸¤ä¸ªæ™ºèƒ½ä½“çš„éšè—çŠ¶æ€ï¼ˆæˆ–è€…ç›®æ ‡ï¼‰ï¼Œæ¯ä¸€ä¸ªæ™ºèƒ½ä½“å¿…é¡»ä»å®ƒè§‚å¯Ÿåˆ°çš„è¡Œä¸ºä¸­æ¨æ–­å‡ºå…¶ä»–ç©å®¶çš„éšè—ç›®æ ‡ä»è€Œå®Œæˆä»»åŠ¡ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°çš„æ–¹æ³•åœ¨è¿™äº›é¢†åŸŸä¸­è¿›è¡Œå­¦ä¹ ï¼šè‡ªæˆ‘å…¶ä»–å»ºæ¨¡ï¼ˆSOMï¼‰ï¼Œæ™ºèƒ½ä½“ä½¿ç”¨è‡ªå·±çš„ç­–ç•¥æ¥é¢„æµ‹å…¶ä»–æ™ºèƒ½ä½“çš„åŠ¨ä½œå¹¶å®æ—¶æ›´æ–°å…¶ä»–æ™ºèƒ½ä½“éšè—çŠ¶æ€çš„ç½®ä¿¡åº¦ã€‚æˆ‘ä»¬åœ¨ä¸‰ä¸ªä¸åŒçš„ä»»åŠ¡ä¸Šå¯¹è¯¥æ–¹æ³•è¿›è¡Œäº†è¯„ä¼°ï¼Œç»“æœè¡¨æ˜æ™ºèƒ½ä½“æ— è®ºåœ¨åˆä½œè¿˜æ˜¯å¯¹æŠ—ç¯å¢ƒä¸­éƒ½èƒ½ä½¿ç”¨ä»–ä»¬å¯¹å…¶ä»–ç©å®¶éšè—çŠ¶æ€çš„ä¼°è®¡æ¥å­¦ä¹ åˆ°æ›´å¥½çš„ç­–ç•¥ã€‚</p>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>åœ¨å¤šæ™ºèƒ½ä½“ç³»ç»Ÿä¸­æ¨ç†å…¶ä»–æ™ºèƒ½ä½“çš„æ„å›¾å¹¶é¢„æµ‹å®ƒä»¬çš„è¡Œä¸ºæ˜¯å¾ˆé‡è¦çš„ï¼Œè¿™äº›æ™ºèƒ½ä½“å¯èƒ½æœ‰ä¸åŒçš„ç”šè‡³æ˜¯ç«äº‰çš„ç›®æ ‡é›†ã€‚ç”±äºå¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„ä¸ç¨³å®šæ€§ï¼Œè¿™ä»ç„¶æ˜¯ä¸€ä¸ªéå¸¸å…·æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ã€‚<br>
åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ç§ä»å…¶ä»–æ™ºèƒ½ä½“çš„è¡Œä¸ºä¸­ä¼°è®¡å¯¹åº”çš„æœªçŸ¥çš„ç›®æ ‡å’Œå¹¶åˆ©ç”¨è¿™äº›ä¼°è®¡çš„ç›®æ ‡é€‰æ‹©åŠ¨ä½œçš„æ–°æ–¹æ³•ã€‚æˆ‘ä»¬è¯æ˜äº†åœ¨æœ¬æ–‡æåˆ°çš„ä»»åŠ¡ä¸­ï¼Œåœ¨æ¸¸æˆä¸­æ˜¾å¼çš„å¯¹å…¶ä»–ç©å®¶è¿›è¡Œå»ºæ¨¡æ¯”å°†å…¶ä»–æ™ºèƒ½ä½“çœ‹åšç¯å¢ƒçš„ä¸€éƒ¨åˆ†ä¼šæœ‰æ›´å¥½çš„æ€§èƒ½ã€‚æˆ‘ä»¬å°†é—®é¢˜å®šä¹‰ä¸ºåŒäººéšæœºæ¸¸æˆï¼Œä¹Ÿå«åŒäººé©¬å°”å¯å¤«æ¸¸æˆï¼Œå…¶ä¸­ç¯å¢ƒå¯¹äºæ™ºèƒ½ä½“æ˜¯å®Œå…¨å¯è§çš„ï¼Œä½†æ˜¯æ²¡æœ‰å…³äºå…¶ä»–æ™ºèƒ½ä½“ç›®æ ‡çš„æ˜ç¡®çŸ¥è¯†è€Œä¸”æ²¡æœ‰æ²Ÿé€šä¿¡é“ã€‚æ¯ä¸ªæ™ºèƒ½ä½“åœ¨å›åˆç»“æŸæ—¶æ”¶åˆ°çš„å¥–åŠ±å–å†³äºä¸¤ä¸ªæ™ºèƒ½ä½“çš„ç›®æ ‡ï¼Œå› æ­¤æ˜¯æ¯ä¸ªæ™ºèƒ½ä½“æœ€ä¼˜çš„ç­–ç•¥éƒ½å¿…é¡»è€ƒè™‘åˆ°æ‰€æœ‰æ™ºèƒ½ä½“çš„ç›®æ ‡ã€‚<br>
è®¤çŸ¥ç§‘å­¦ç ”ç©¶è¡¨æ˜ï¼Œäººç±»ç»´æŒä¸ä»–ä»¬è”ç³»çš„å…¶ä»–äººçš„æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹ç”¨æ¥æ•æ‰é‚£äº›äººçš„ç›®æ ‡ï¼Œä¿¡ä»°æˆ–åå¥½ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œäººç±»åˆ©ç”¨è‡ªå·±çš„å¿ƒç†è¿‡ç¨‹æ¥æ¨¡æ‹Ÿä»–äººçš„è¡Œä¸ºã€‚è¿™ä½¿ä»–ä»¬èƒ½å¤Ÿç†è§£å…¶ä»–äººçš„æ„å›¾æˆ–åŠ¨æœºï¼Œå¹¶èƒ½åœ¨ç¤¾äº¤åœºåˆé‡‡å–ç›¸åº”çš„è¡ŒåŠ¨ã€‚å—è¿™äº›ç ”ç©¶çš„å¯å‘ï¼Œå…³é”®æƒ³æ³•æ˜¯è¦ç†è§£æ¸¸æˆä¸­å…¶ä»–ç©å®¶æ­£åœ¨åšä»€ä¹ˆï¼Œæ™ºèƒ½ä½“åº”è¯¥é—®è‡ªå·±â€œå¦‚æœæˆ‘æ‰®æ¼”å¦ä¸€ä¸ªç©å®¶çš„è§’è‰²ï¼Œæˆ‘çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿâ€ã€‚æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå¤šå±‚å¾ªç¯ç¥ç»ç½‘ç»œå‚æ•°åŒ–æ™ºèƒ½ä½“çš„åŠ¨ä½œå’Œå€¼å‡½æ•°æ¥å®ç°è¿™ä¸ªæƒ³æ³•ï¼Œè¯¥ç¥ç»ç½‘ç»œå°†çŠ¶æ€å’Œç›®æ ‡ä½œä¸ºè¾“å…¥ã€‚å½“æ™ºèƒ½ä½“ç©æ¸¸æˆæ—¶ï¼Œå®ƒé€šè¿‡ç›´æ¥ä½¿ç”¨è‡ªå·±çš„åŠ¨ä½œå‡½æ•°ä¼˜åŒ–ç›®æ ‡æ¥æœ€å¤§åŒ–å¯¹æ–¹è¡ŒåŠ¨çš„å¯èƒ½æ€§ï¼Œä»è€Œæ¨æ–­å‡ºå…¶ä»–æ™ºèƒ½ä½“çš„æœªçŸ¥ç›®æ ‡ã€‚</p>
<h2 id="æ–¹æ³•">æ–¹æ³•</h2>
<p><strong>èƒŒæ™¯</strong> ä¸¤ä¸ªæ™ºèƒ½ä½“çš„é©¬å°”å¯å¤«æ¸¸æˆç”±æè¿°æ‰€æœ‰æ™ºèƒ½ä½“çš„å¯èƒ½é…ç½®çš„ä¸€ç»„çŠ¶æ€é›†åˆ$S$ï¼Œä¸¤ç»„åŠ¨ä½œé›†åˆ$A_1$ï¼Œ$A_2$å’Œä¸¤ä¸ªæ™ºèƒ½ä½“çš„è§‚å¯Ÿ$O_1$ï¼Œ$O_2$ä»¥åŠè½¬æ¢å‡½æ•°$\Tau$ï¼š$S\times A_1 \times A_2 \rightarrow S$ä½œä¸ºå½“å‰çŠ¶æ€å’ŒåŠ¨ä½œçš„å‡½æ•°ç»™å‡ºä¸‹ä¸€ä¸ªçŠ¶æ€çš„æ¦‚ç‡åˆ†å¸ƒã€‚æ¯ä¸ªæ™ºèƒ½ä½“$i$é€šè¿‡ä»éšæœºç­–ç•¥$\pi_{\theta_i}:S\times A_i\rightarrow [0,1]$ä¸­é‡‡æ ·é€‰æ‹©åŠ¨ä½œã€‚æ¯ä¸ªæ™ºèƒ½ä½“éƒ½æœ‰ä¸€ä¸ªå¥–åŠ±å‡½æ•°ï¼Œå®ƒå–å†³äºæ™ºèƒ½ä½“çš„çŠ¶æ€å’ŒåŠ¨ä½œï¼š$r_iï¼šS\times A_i\rightarrow R$ã€‚æ¯ä¸ªæ™ºèƒ½ä½“$i$è¯•å›¾æœ€å¤§åŒ–è‡ªå·±çš„æ€»é¢„æœŸæ”¶ç›Š$R_i = \sum_{t =0}<sup>T\gamma</sup>tr_i^t$ï¼Œå…¶ä¸­$\gamma$æ˜¯æŠ˜æ‰£å› å­ï¼Œ$T$æ˜¯æ—¶é—´èŒƒå›´ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘äº†åˆä½œä»¥åŠç«äº‰ç¯å¢ƒã€‚<br>
æ¥ä¸‹æ¥ä»‹ç»è‡ªæˆ‘å…¶ä»–æ¨¡å‹ï¼ˆSOMï¼‰ï¼Œè¿™æ˜¯ä¸€ç§åœ¨ä¸€ä¸ªå›åˆå†…ä»¥å®æ—¶æ–¹å¼æ¨æ–­å…¶ä»–æ™ºèƒ½ä½“çš„ç›®æ ‡å¹¶ä½¿ç”¨è¿™äº›ä¼°è®¡æ¥é€‰æ‹©åŠ¨ä½œçš„æ–°æ–¹æ³•ã€‚ä¸ºäº†å†³å®šä¸€ä¸ªåŠ¨ä½œå¹¶ä¼°è®¡ä¸€ä¸ªçŠ¶æ€çš„å€¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œ$f$å°†å®ƒè‡ªå·±çš„ç›®æ ‡$z_{self}$ï¼Œå¦ä¸€ä¸ªç©å®¶çš„ä¼°è®¡ç›®æ ‡$\hat{z}<em>{self}$ï¼Œå¹¶ä¸”ä»–è‡ªå·±çš„è§’åº¦çš„è§‚å¯ŸçŠ¶æ€$s</em>{self}$ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºåŠ¨ä½œ$\pi$çš„ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒå’Œå€¼ä¼°è®¡$V$ï¼Œå³å¯¹äºæ¯ä¸ªç©æ¸¸æˆçš„æ™ºèƒ½ä½“ï¼Œæœ‰ï¼š<br>
$$\begin{bmatrix}\pi<sup>i\V</sup>i\end{bmatrix}=f<sup>i(s_{self}</sup>i,z_{self}<sup>i,\hat{z}_{other}</sup>i;\theta^i)$$<br>
å…¶ä¸­$\theta_i$æ˜¯æ™ºèƒ½ä½“$i$çš„ç¥ç»ç½‘ç»œ$f$çš„å‚æ•°ï¼ŒåŒ…æ‹¬ä¸€ä¸ªsoftmaxå±‚è¾“å‡ºç­–ç•¥ï¼Œä¸€ä¸ªçº¿æ€§å±‚è¾“å‡ºå€¼å‡½æ•°ï¼Œæ‰€æœ‰éè¾“å‡ºå±‚æ˜¯å…±äº«çš„ã€‚åŠ¨ä½œæ˜¯ä»ç­–ç•¥$\pi$ä¸­é‡‡æ ·å¾—åˆ°çš„ã€‚è§‚å¯ŸçŠ¶æ€$s_{self}<sup>i$åŒ…å«$f</sup>i$æ™ºèƒ½ä½“çš„ä½ç½®ï¼Œä»¥åŠå…¶ä»–æ™ºèƒ½ä½“çš„ä½ç½®ã€‚æ¯ä¸ªæ™ºèƒ½ä½“éƒ½æœ‰ä¸¤ä¸ªç½‘ç»œï¼ˆä¸ºäº†ç®€æ´ï¼Œçœç•¥äº†æ™ºèƒ½ä½“ä¸Šæ ‡$i$ï¼‰ï¼Œä¸€ä¸ªè®¡ç®—å®ƒè‡ªå·±çš„åŠ¨ä½œå’Œå€¼å‡½æ•°ï¼Œä¸€ä¸ªè®¡ç®—å…¶ä»–æ™ºèƒ½ä½“çš„ä¼°è®¡å€¼ï¼Œå¦‚ä¸‹ï¼š<br>
\begin{equation}<br>
f_{self}(s_{self},z_{self},\hat{z}<em>{other};\theta</em>{self})<br>
\end{equation}<br>
\begin{equation}<br>
f_{other}(s_{other},\hat{z}<em>{other},z</em>{self};\theta_{self})<br>
\end{equation}<br>
è¿™ä¸¤ä¸ªç½‘ç»œä½¿ç”¨çš„æ–¹å¼ä¸åŒï¼š$f_{self}$ç”¨äºè®¡ç®—æ™ºèƒ½ä½“è‡ªå·±çš„è¡Œä¸ºå’Œä»·å€¼ï¼Œå¹¶ä»¥å‰é¦ˆæ–¹å¼è¿è¡Œã€‚ç»™å‡ºå…¶ä»–æ™ºèƒ½ä½“è§‚å¯Ÿåˆ°çš„åŠ¨ä½œï¼Œæ™ºèƒ½ä½“ä½¿ç”¨$f_{other}$é€šè¿‡ä¼˜åŒ–$\hat{z}<em>{other}$æ¨æ–­å…¶ä»–æ™ºèƒ½ä½“çš„ç›®æ ‡ã€‚<br>
æˆ‘ä»¬å»ºè®®æ¯ä¸ªæ™ºèƒ½ä½“ä½¿ç”¨è‡ªå·±çš„ç­–ç•¥æ¨¡æ‹Ÿå…¶ä»–ç©å®¶çš„è¡Œä¸ºï¼Œè¿™æ ·$f</em>{other}$çš„å‚æ•°ä¸$f_{self}$çš„å‚æ•°æ˜¯ç›¸åŒçš„ã€‚ä½†è¯·æ³¨æ„ï¼Œä¸¤ä¸ªç½‘ç»œçš„è¾“å…¥$z_{self}$å’Œ$\hat{z}<em>{other}$çš„ç›¸å¯¹ä½ç½®ä¸åŒã€‚å¦å¤–ï¼Œç”±äºç¯å¢ƒæ˜¯å®Œå…¨å¯è§‚æµ‹çš„ï¼Œä¸¤ä¸ªæ™ºèƒ½ä½“çš„è§‚å¯ŸçŠ¶æ€çš„ä¸åŒä»…é€šè¿‡åœ°å›¾ä¸Šæ™ºèƒ½ä½“çš„èº«ä»½ä½“ç°å‡ºæ¥ï¼ˆå³ï¼Œæ¯ä¸ªæ™ºèƒ½ä½“å°†èƒ½å¤ŸåŒºåˆ†å…¶è‡ªå·±çš„ä½ç½®å’Œå¦ä¸€ä¸ªæ™ºèƒ½ä½“çš„ä½ç½®ï¼‰ã€‚å› æ­¤ï¼Œåœ¨actingæ¨¡å¼ä¸‹ï¼Œ$f</em>{self}$ç½‘ç»œå°†$s_{self}$ä½œä¸ºè¾“å…¥ï¼›åœ¨æ¨ç†æ¨¡å¼ä¸‹ï¼Œ$f_{other}$ç½‘ç»œå°†$s_{other}$ä½œä¸ºè¾“å…¥ã€‚åœ¨æ¸¸æˆçš„æ¯ä¸€æ­¥ï¼Œæ™ºèƒ½ä½“éœ€è¦æ¨ç†$\hat{z}<em>{other}$å°†å…¶ä½œä¸º(1)çš„è¾“å…¥å¹¶é€‰æ‹©å…¶åŠ¨ä½œã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼Œåœ¨æ¯ä¸€æ­¥ä¸­ï¼Œæ™ºèƒ½ä½“è§‚å¯Ÿå¦ä¸€ä¸ªæ™ºèƒ½ä½“é‡‡å–çš„è¡ŒåŠ¨ï¼Œå¹¶ä¸”åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæ™ºèƒ½ä½“ä½¿ç”¨å…ˆå‰è§‚å¯Ÿåˆ°çš„å¦ä¸€ä¸ªæ™ºèƒ½ä½“çš„åŠ¨ä½œä½œä¸ºç›‘ç£ä¿¡å·ï¼Œä½¿ç”¨å¼å­(2)åå‘ä¼ æ’­å¹¶ä¼˜åŒ–å…¶$\hat{z}</em>{other}$ï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚<br>
æ¨ç†è¿‡ç¨‹ä¼˜åŒ–å™¨ä¸­é‡‡å–çš„æ­¥æ•°æ˜¯ä¸€ä¸ªå¯æ ¹æ®æ¸¸æˆçš„ä¸åŒè€Œå˜åŒ–çš„è¶…å‚æ•°ã€‚å› æ­¤ï¼Œåœ¨æ¸¸æˆçš„æ¯ä¸€æ­¥ä¸­å…¶ä»–æ™ºèƒ½ä½“çš„ç›®æ ‡ä¼°è®¡$\hat{z}<em>{other}$ä¼šè¢«æ›´æ–°å¤šæ¬¡ã€‚å‚æ•°$\theta</em>{self}$åœ¨æ¯ä¸ªå›åˆç»“æŸæ—¶ä½¿ç”¨å’Œå¸¦æœ‰æ™ºèƒ½ä½“è·å¾—çš„å¥–åŠ±ä¿¡å·çš„Asynchronous Advantage Actor-Criticï¼ˆA3Cï¼‰è¿›è¡Œæ›´æ–°ã€‚<br>
ç®—æ³•1ç»™å‡ºäº†ä¸€ä¸ªå›åˆå†…è®­ç»ƒSOMæ™ºèƒ½ä½“çš„ä¼ªä»£ç ã€‚è¿™é‡Œè€ƒè™‘çš„æ‰€æœ‰ä»»åŠ¡çš„ç›®æ ‡éƒ½æ˜¯ç¦»æ•£çš„ï¼Œæ™ºèƒ½ä½“çš„ç›®æ ‡$\hat{z}<em>{self}$è¢«<br>
è¡¨ç¤ºç‹¬çƒ­å‘é‡ï¼Œç»´åº¦æ˜¯æ™ºèƒ½ä½“ç›®æ ‡æ‰€æœ‰å¯èƒ½çš„æƒ…å†µæ•°ã€‚å¦ä¸€ä¸ªç©å®¶çš„ç›®æ ‡åµŒå…¥$\hat{z}</em>{other}$æœ‰ç›¸åŒçš„ç»´åº¦ã€‚ä¸ºäº†ä¼°è®¡ç»è¿‡ç¦»æ•£è€Œä¸å¯å¾®çš„å˜é‡$\hat{z}<em>{other}$çš„æ¢¯åº¦ï¼Œæˆ‘ä»¬ç”¨Gumbel-Softmaxåˆ†å¸ƒä¸Šçš„ä¸€ä¸ªå¯å¾®æ ·æœ¬$\hat{z}</em>{other}^G$ä»£æ›¿å®ƒã€‚è¿™ç§é‡æ–°å‚æ•°åŒ–æŠ€å·§è¢«è¯æ˜å¯ä»¥æœ‰æ•ˆåœ°äº§ç”Ÿä½æ–¹å·®åç½®çš„æ¢¯åº¦ã€‚ä½¿ç”¨è¯¥æ–¹æ³•åœ¨æ¯ä¸€æ­¥ä¼˜åŒ–è¿‡$\hat{z}<em>{other}$ä¹‹åï¼Œ$\hat{z}</em>{other}$é€šå¸¸åç¦»ç‹¬çƒ­å‘é‡ã€‚åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œ$f_{self}$å°†å¯¹åº”äºå…ˆå‰æ›´æ–°çš„$z_{other}$ argmaxçš„ä¸€ä¸ªç‹¬çƒ­å‘é‡é‡$\hat{z}<em>{other}^OH$ä½œä¸ºè¾“å…¥ã€‚<br>
æ™ºèƒ½ä½“çš„ç­–ç•¥ç”±é•¿çŸ­æœŸè®°å¿†ï¼ˆLSTMï¼‰å•å…ƒå‚æ•°åŒ–ï¼Œä»¥åŠä¸¤ä¸ªå…¨è¿æ¥çš„çº¿æ€§å±‚å’ŒæŒ‡æ•°çº¿æ€§å•å…ƒï¼ˆELUï¼‰æ¿€æ´»å‡½æ•°ã€‚ç¥ç»ç½‘ç»œçš„æƒé‡ç”¨åŠæ­£äº¤çŸ©é˜µåˆå§‹åŒ–ã€‚<br>
ç”±äº$f</em>{other}$çš„å¾ªç¯æ€§ï¼Œå½“æ¨ç†æ­¥æ•°$\gt 1$æ—¶å¿…é¡»ç‰¹åˆ«å°å¿ƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨æ¸¸æˆçš„æ¯ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬åœ¨æ¨ç†æ¨¡å¼ä¸­çš„ç¬¬ä¸€æ¬¡å‰å‘ä¼ æ’­ä¹‹å‰ä¿å­˜$f_{other}$çš„å¾ªç¯çŠ¶æ€ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªæ¨ç†æ­¥éª¤å°†å¾ªç¯çŠ¶æ€åˆå§‹åŒ–ä¸ºæ­¤å€¼ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç¡®ä¿åœ¨åŠ¨ä½œå’Œæ¨ç†æ¨¡å¼ä¸‹$f_{other}$å¯ä»¥å±•å¼€ç›¸åŒæ•°é‡çš„æ­¥éª¤ã€‚</p>
<h2 id="ç›¸å…³å·¥ä½œ">ç›¸å…³å·¥ä½œ</h2>
<p>ä¸å®Œå…¨ä¿¡æ¯çš„æ¸¸æˆä¸­å¯¹æ‰‹å»ºæ¨¡ä¸€ç›´åœ¨è¢«å¹¿æ³›ç ”ç©¶ã€‚ä½†æ˜¯ï¼Œå¤§å¤šæ•°ä»¥å‰çš„æ–¹æ³•éƒ½ä¾§é‡äºç ”ç©¶ç‰¹å®šé¢†åŸŸå†…çš„æ¦‚ç‡å…ˆéªŒæˆ–å‚æ•°åŒ–ç­–ç•¥çš„æ¨¡å‹ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæœ¬æ–‡çš„å·¥ä½œä¸ºå¯¹æ‰‹å»ºæ¨¡æå‡ºäº†ä¸€ä¸ªæ›´é€šç”¨çš„æ¡†æ¶ã€‚ç»™å®šæ¯”èµ›å†å²ï¼ŒDavidsonä½¿ç”¨MLPé¢„æµ‹å¯¹æ‰‹çš„åŠ¨ä½œï¼Œä½†æ˜¯æ™ºèƒ½ä½“æ— æ³•å®æ—¶é€‚åº”å¯¹æ‰‹çš„è¡Œä¸ºã€‚Lockettç­‰äººè®¾è®¡äº†ä¸€ç§ç¥ç»ç½‘ç»œç»“æ„ï¼Œé€šè¿‡åœ¨ç»™å®šçš„ä¸€ç»„ä¸»è¦å¯¹æ‰‹ä¸Šå­¦ä¹ æƒé‡çš„å€¼æ¥è¯†åˆ«å¯¹æ‰‹ç±»å‹ã€‚ç„¶è€Œï¼Œæ¸¸æˆå¹¶æ²¡æœ‰åœ¨å¼ºåŒ–å­¦ä¹ æ¡†æ¶å†…å±•å¼€ã€‚<br>
å¤§é‡å¤šæ™ºèƒ½ä½“æ·±åº¦å¼ºåŒ–å­¦ä¹ çš„ç ”ç©¶ä¸­ä¾§é‡äºéƒ¨åˆ†å¯è§çš„ï¼Œå®Œå…¨åˆä½œå’Œç´§æ€¥é€šä¿¡ç­‰ç¯å¢ƒã€‚æœ¬æ–‡ä¸å…è®¸æ™ºèƒ½ä½“ä¹‹é—´è¿›è¡Œä»»ä½•æ²Ÿé€šï¼Œå› æ­¤ç©å®¶å¿…é¡»åˆ©ç”¨ä»–ä»¬è§‚å¯Ÿåˆ°çš„è¡Œä¸ºé—´æ¥æ¨ç†ä»–ä»¬å¯¹æ‰‹çš„æ„å›¾ã€‚ä½œä¸ºå¯¹æ¯”ï¼ŒLeiboç­‰è€ƒè™‘åŠåˆä½œå¤šæ™ºèƒ½ä½“ç¯å¢ƒï¼Œæ™ºèƒ½ä½“æ ¹æ®ä»»åŠ¡ç±»å‹å’Œå¥–åŠ±ç»“æ„åˆ¶å®šåˆä½œå’Œç«äº‰ç­–ç•¥ã€‚ç±»ä¼¼åœ°ï¼ŒLoweç­‰äººæå‡ºäº†ä¸€ç§é›†ä¸­ACæ¡†æ¶ï¼Œç”¨äºåœ¨å…·æœ‰æ··åˆç­–ç•¥çš„ç¯å¢ƒä¸­è¿›è¡Œé«˜æ•ˆçš„è®­ç»ƒã€‚ Lererå’ŒPeysakhoviché€šè¿‡å°†é’ˆé”‹ç›¸å¯¹çš„è‘—åæ¸¸æˆç†è®ºç­–ç•¥æ¨å¹¿åˆ°å¤šæ™ºèƒ½ä½“é©¬å°”å¯å¤«æ¸¸æˆï¼Œè®¾è®¡äº†èƒ½å¤Ÿåœ¨å¤æ‚ç¤¾ä¼šå›°å¢ƒä¸­ä¿æŒåˆä½œçš„å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“ã€‚æœ€è¿‘è®¤çŸ¥ç§‘å­¦æ–¹é¢çš„å·¥ä½œè¯•å›¾é€šè¿‡ä½¿ç”¨åˆ†å±‚çš„ç¤¾ä¼šæ™ºèƒ½ä½“æ¨¡å‹æ¥ç†è§£äººç±»çš„å†³ç­–ï¼Œå®ƒèƒ½æ¨æ–­å‡ºå…¶ä»–äººç±»æ™ºèƒ½ä½“çš„æ„å›¾ï¼Œä»è€Œå†³å®šæ˜¯å¦é‡‡å–åˆä½œæˆ–ç«äº‰ç­–ç•¥ã€‚ç„¶è€Œï¼Œè¿™äº›è®ºæ–‡éƒ½æ²¡æœ‰è®¾è®¡å‡ºèƒ½å¤Ÿæ˜¾å¼æ¨¡æ‹Ÿç¯å¢ƒä¸­å…¶ä»–äººå·¥æ™ºèƒ½ä½“æˆ–è€…ä¼°è®¡ä»–ä»¬æ„å›¾çš„ç®—æ³•æ¥æ”¹å–„æ™ºèƒ½ä½“çš„å†³ç­–ã€‚<br>
é€†å¼ºåŒ–å­¦ä¹ é¢†åŸŸä¹Ÿä¸æœ¬æ–‡è€ƒè™‘çš„é—®é¢˜æœ‰å…³ã€‚é€†å¼ºåŒ–å­¦ä¹ çš„ç›®çš„æ˜¯é€šè¿‡è§‚å¯Ÿæ™ºèƒ½ä½“çš„è¡Œä¸ºæ¥æ¨æ–­æ™ºèƒ½ä½“çš„å¥–åŠ±å‡½æ•°ã€‚ç›¸åï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä½¿ç”¨è§‚å¯Ÿåˆ°å…¶ä»–ç©å®¶çš„è¡Œä¸ºä»¥åœ¨çº¿æ–¹å¼ç›´æ¥æ¨æ–­ä»–ä»¬çš„ç›®æ ‡ï¼Œç„¶ååœ¨ç¯å¢ƒçš„actingæ¨¡å¼ä¸­ç”±æ™ºèƒ½ä½“ä½¿ç”¨ã€‚è¿™é¿å…ä¸ºäº†ä¼°è®¡å¥–åŠ±å‡½æ•°æ”¶é›†å…¶ä»–æ™ºèƒ½ä½“çŠ¶æ€-åŠ¨ä½œå¯¹ç¦»çº¿æ ·æœ¬çš„éœ€è¦ï¼Œç„¶åä½¿ç”¨å®ƒæ¥å­¦ä¹ æœ€å¤§åŒ–è¯¥æ•ˆç”¨çš„å•ç‹¬ç­–ç•¥ã€‚æœ€è¿‘Hadfield-Menellç­‰çš„è®ºæ–‡ä¹Ÿå…³æ³¨æ¨ç†ä»–äººæ„å›¾çš„é—®é¢˜ï¼Œä½†ä»–ä»¬å…³æ³¨çš„æ˜¯äººæœºäº¤äº’å’Œä»·å€¼è°ƒæ•´ã€‚åœ¨ç±»ä¼¼ç›®æ ‡çš„æ¨åŠ¨ä¸‹ï¼ŒChandrasekaranç­‰äººè€ƒè™‘å»ºç«‹äººå·¥æ™ºèƒ½ç†è®ºçš„é—®é¢˜ï¼Œä»¥æ”¹å–„äººå·¥æ™ºèƒ½äº¤äº’å’Œäººå·¥æ™ºèƒ½ç³»ç»Ÿçš„å¯è§£é‡Šæ€§ã€‚ä¸ºäº†è¿™ä¸ªç›®æ ‡ï¼Œä»–ä»¬å±•ç¤ºäº†å¯ä»¥ä½¿ç”¨å°‘é‡ç¤ºä¾‹è®­ç»ƒäººä»¬é¢„æµ‹è§†è§‰é—®ç­”æ¨¡å‹çš„å“åº”ã€‚<br>
Foersterç­‰äººå’ŒHeç­‰äººçš„å·¥ä½œä¸æˆ‘ä»¬çš„å·¥ä½œæœ€æ¥è¿‘ã€‚Foersterç­‰äººè®¾è®¡å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“åœ¨æ›´æ–°è‡ªå·±çš„ç­–ç•¥æ—¶åŒæ—¶è€ƒè™‘åˆ°ç¯å¢ƒä¸­å…¶ä»–æ™ºèƒ½ä½“çš„å­¦ä¹ ã€‚è¿™ä½¿å¾—æ™ºèƒ½ä½“èƒ½å¤Ÿå‘ç°è‡ªç§è€Œåˆåä½œçš„ç­–ç•¥ï¼Œä¾‹å¦‚åœ¨è¿­ä»£å›šå¾’å›°å¢ƒä¸­çš„é’ˆé”‹ç›¸å¯¹ç­–ç•¥ã€‚è™½ç„¶æˆ‘ä»¬çš„å·¥ä½œæ²¡æœ‰æ˜ç¡®åœ°è¯•å›¾å¡‘é€ å…¶ä»–æ™ºèƒ½ä½“çš„å­¦ä¹ ï¼Œä½†å®ƒçš„ä¼˜ç‚¹æ˜¯æ™ºèƒ½ä½“å¯ä»¥åœ¨ä¸€ä¸ªå›åˆä¸­æ›´æ–°ä»–ä»¬çš„ä¿¡å¿µå¹¶ä»¥åœ¨çº¿æ–¹å¼æ›´æ–°ç­–ç•¥ä»¥è·å¾—æ›´å¤šå¥–åŠ±ã€‚æˆ‘ä»¬çš„è®¾ç½®ä¹Ÿæœ‰æ‰€ä¸åŒï¼Œå®ƒè®¤ä¸ºæ¯ä¸ªæ™ºèƒ½ä½“éƒ½æœ‰ä¸€äº›å…¶ä»–ç©å®¶æ‰€éœ€çš„éšè—ä¿¡æ¯ï¼Œä»¥ä¾¿æœ€å¤§åŒ–å…¶å›æŠ¥ã€‚<br>
æˆ‘ä»¬çš„å·¥ä½œéå¸¸ç¬¦åˆHeç­‰äººçš„å·¥ä½œï¼Œä½œè€…æ„å»ºäº†ä¸€ä¸ªç”¨äºåœ¨å¼ºåŒ–å­¦ä¹ ç¯å¢ƒä¸­æ„å»ºå…¶ä»–æ™ºèƒ½ä½“çš„ä¸€èˆ¬æ¡†æ¶ã€‚Heç­‰äººæå‡ºäº†ä¸€ä¸ªæ¨¡å‹ï¼Œé€šè¿‡å°†å¯¹æ‰‹çš„è§‚å¯Ÿä½¿ç”¨DQNè¿›è¡Œç¼–ç ï¼Œå…±åŒå­¦ä¹ ä¸€ä¸ªç­–ç•¥å’Œå¯¹æ‰‹çš„è¡Œä¸ºå¯¹æ‰‹ã€‚ä»–ä»¬çš„æ··åˆä¸“å®¶æ¶æ„èƒ½å¤Ÿåœ¨ä¸¤ä¸ªçº¯å¯¹æŠ—æ€§ä»»åŠ¡ä¸­å‘ç°ä¸åŒå¯¹æ‰‹çš„ç­–ç•¥æ¨¡å¼ã€‚æˆ‘ä»¬çš„å·¥ä½œä¸Heç­‰äººçš„å·¥ä½œä¹‹é—´çš„ä¸€ä¸ªåŒºåˆ«åœ¨äºï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¸æ˜¯æ¨æ–­å…¶ä»–æ™ºèƒ½ä½“çš„ç­–ç•¥ï¼Œè€Œæ˜¯ä¸“æ³¨äºæ˜¾å¼ä¼°è®¡ä»–ä»¬åœ¨ç¯å¢ƒä¸­çš„ç›®æ ‡ã€‚æ­¤å¤–ï¼Œåœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œæ™ºèƒ½ä½“ä¸æ˜¯ä½¿ç”¨å…¶ä»–æ™ºèƒ½ä½“åŠ¨ä½œçš„äººå·¥è®¾è®¡ç‰¹å¾ï¼Œè€Œæ˜¯æ ¹æ®è‡ªå·±çš„æ¨¡å‹ç«¯åˆ°ç«¯çš„å­¦ä¹ å…¶ä»–æ™ºèƒ½ä½“æ¨¡å‹ã€‚å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œåœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œæ™ºèƒ½ä½“ä½¿ç”¨ä¼˜åŒ–æ¨æ–­å…¶ä»–æ™ºèƒ½ä½“çš„éšè—çŠ¶æ€ï¼Œè€Œä¸æ˜¯é€šè¿‡å‰é¦ˆç½‘ç»œæ¨æ–­å…¶ä»–æ™ºèƒ½ä½“çš„éšè—çŠ¶æ€ã€‚åœ¨ä¸‹é¢çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬è¡¨æ˜SOMä¼˜äºHeç­‰äººçš„æ–¹æ³•ã€‚</p>
<h2 id="å®éªŒ">å®éªŒ</h2>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸‰ä¸ªä»»åŠ¡ä¸Šè¯„ä¼°SOMæ¨¡å‹ï¼š</p>
<ul>
<li>ç¡¬å¸æ¸¸æˆï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œå…¨åˆä½œçš„ä»»åŠ¡ï¼Œæ™ºèƒ½ä½“çš„è§’è‰²æ˜¯å¯¹ç§°çš„ã€‚</li>
<li>é…æ–¹æ¸¸æˆï¼Œå®ƒæ˜¯å¯¹æŠ—çš„ï¼Œä½†å…·æœ‰å¯¹ç§°è§’è‰²ã€‚</li>
<li>é—¨ç¦æ¸¸æˆï¼Œå®ƒæ˜¯å®Œå…¨åˆä½œçš„ï¼Œä½†æ˜¯ä¸¤ä¸ªç©å®¶æ‹¥æœ‰ä¸å¯¹ç§°çš„è§’è‰²ã€‚</li>
</ul>
<p>æˆ‘ä»¬å°†SOMä¸å…¶ä»–ä¸‰ä¸ªbaselinesä»¥åŠä¸€ä¸ªå¯ä»¥è®¿é—®å…¶ä»–æ™ºèƒ½ä½“ç›®æ ‡çš„ground truthçš„æ¨¡å‹è¿›è¡Œæ¯”è¾ƒã€‚æ‰€æœ‰ä»»åŠ¡éƒ½æ˜¯åœ¨Mazebase gridworldç¯å¢ƒä¸­åˆ›å»ºçš„ã€‚</p>
<h3 id="baselines">Baselines</h3>
<p>TRUE-OTHER-GOALï¼ˆTOGï¼‰ï¼šæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç»™å‡ºçš„æ¨¡å‹æ€§èƒ½ä¸Šé™çš„ç­–ç•¥ç½‘ç»œï¼Œè¯¥ç½‘ç»œå°†å…¶ä»–æ™ºèƒ½ä½“çš„çœŸæ­£ç›®æ ‡$z_{other}$ï¼Œä»¥åŠçŠ¶æ€ç‰¹å¾$s_{self}$å’Œè‡ªå·±çš„ç›®æ ‡$z_{self}$ä½œä¸ºè¾“å…¥ã€‚å› ä¸ºè¿™ä¸ªæ¨¡å‹å¯ä»¥ç›´æ¥è®¿é—®å…¶ä»–æ™ºèƒ½ä½“çœŸæ­£çš„ç›®æ ‡ï¼Œå› æ­¤ä¸éœ€è¦å•ç‹¬çš„ç½‘ç»œæ¥æ¨¡æ‹Ÿå…¶ä»–æ™ºèƒ½ä½“çš„è¡Œä¸ºã€‚ TOGçš„ç»“æ„ä¸SOMçš„ä¸€ä¸ªç­–ç•¥ç½‘ç»œ$f_{self}$ç›¸åŒã€‚ NO-OTHER-MODELï¼ˆNOMï¼‰ï¼šæˆ‘ä»¬ä½¿ç”¨çš„ç¬¬ä¸€ä¸ªbaselineä»…ä½¿ç”¨è§‚å¯ŸçŠ¶æ€$s_{self}$å’Œè‡ªèº«ç›®æ ‡$z_{self}$ä½œä¸ºè¾“å…¥ã€‚NOMä¸SOMçš„ä¸€ä¸ªç­–ç•¥ç½‘ç»œ$f_{self}$æœ‰ç›¸åŒçš„æ¶æ„ã€‚è¯¥baselineæ²¡æœ‰å¯¹å…¶ä»–æ™ºèƒ½ä½“çš„æ˜¾å¼å»ºæ¨¡æˆ–ä¼°è®¡å®ƒä»¬çš„ç›®æ ‡ã€‚<br>
é›†æˆ-ç­–ç•¥-é¢„æµ‹å™¨ï¼ˆIPPï¼‰ï¼šä»NOMçš„ä½“ç³»ç»“æ„å’Œè¾“å…¥å¼€å§‹ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæ›´å¼ºçš„baseline IPPï¼Œå®ƒæœ‰ä¸€ä¸ªé¢å¤–çš„æœ€ç»ˆçº¿æ€§å±‚è¾“å‡ºå¦ä¸€ä¸ªæ™ºèƒ½ä½“ä¸‹ä¸€ä¸ªåŠ¨ä½œçš„æ¦‚ç‡åˆ†å¸ƒã€‚é™¤äº†ç”¨äºè®­ç»ƒè¯¥ç½‘ç»œç­–ç•¥çš„A3CæŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬è¿˜æ·»åŠ äº¤å‰ç†µæŸå¤±é¡¹è®­ç»ƒå…¶ä»–æ™ºèƒ½ä½“çš„è¡Œä¸ºçš„é¢„æµ‹ã€‚<br>
åˆ†ç¦»-ç­–ç•¥-é¢„æµ‹å™¨ï¼ˆSPPï¼‰ï¼šHeç­‰äººæå‡ºäº†ä¸€ä¸ªåŸºäºDQNçš„å¯¹æ‰‹å»ºæ¨¡æ¡†æ¶ã€‚åœ¨ä»–ä»¬çš„æ–¹æ³•ä¸­ï¼Œç»™å®šå¯¹æ‰‹ç‰¹æœ‰çš„äººå·¥æå–çš„çŠ¶æ€ä¿¡æ¯ï¼Œè®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œé¢„æµ‹å¯¹æ‰‹çš„åŠ¨ä½œã€‚è¯¥ç½‘ç»œçš„ä¸­é—´éšè—è¡¨ç¤ºç”¨ä½œQç½‘ç»œçš„è¾“å…¥ã€‚<br>
æˆ‘ä»¬ä¿®æ”¹äº†Heç­‰äººçš„æ¨¡å‹åº”ç”¨åˆ°æœ¬æ–‡çš„åœºæ™¯ä¸­ã€‚ç‰¹åˆ«çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨A3Cè€Œä¸æ˜¯DQNï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨ç‰¹å®šé¢†åŸŸçš„ç‰¹å¾è¡¨ç¤ºå¯¹æ‰‹çš„éšè—çŠ¶æ€ã€‚<br>
æœ€åäº§ç”Ÿçš„SPPæ¨¡å‹ç”±ä¸¤ä¸ªç‹¬ç«‹çš„ç½‘ç»œç»„æˆï¼Œä¸€ä¸ªç­–ç•¥ç½‘ç»œç”¨äºå†³å®šæ™ºèƒ½ä½“çš„åŠ¨ä½œï¼Œä¸€ä¸ªå¯¹æ‰‹ç½‘ç»œç”¨äºé¢„æµ‹å…¶ä»–æ™ºèƒ½ä½“çš„åŠ¨ä½œã€‚å¯¹æ‰‹ç½‘ç»œå°†ä¸–ç•ŒçŠ¶æ€$s$å’Œè‡ªå·±çš„ç›®æ ‡$z_{self}$ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¾“å‡ºå…¶ä»–æ™ºèƒ½ä½“åœ¨ä¸‹ä¸€æ­¥é‡‡å–åŠ¨ä½œçš„æ¦‚ç‡åˆ†å¸ƒï¼Œä»¥åŠå…¶éšè—çŠ¶æ€ï¼ˆç”±ç½‘ç»œçš„å¾ªç¯ç»™å‡ºï¼‰ã€‚ä¸IPPä¸€æ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨å…¶ä»–æ™ºèƒ½ä½“çš„çœŸå®åŠ¨ä½œè®­ç»ƒå¯¹æ‰‹ç­–ç•¥é¢„æµ‹å™¨çš„äº¤å‰ç†µæŸå¤±ã€‚åœ¨æ¯ä¸€æ­¥ä¸­ï¼Œè¯¥ç½‘ç»œè¾“å‡ºçš„éšè—çŠ¶æ€ä»¥åŠæ™ºèƒ½ä½“è§‚å¯ŸçŠ¶æ€å’Œæ™ºèƒ½ä½“è‡ªèº«çš„ç›®æ ‡è¢«ä½œä¸ºæ™ºèƒ½ä½“çš„ç­–ç•¥ç½‘ç»œçš„è¾“å…¥ã€‚ç­–ç•¥ç½‘ç»œå’Œå¯¹æ‰‹ç­–ç•¥é¢„æµ‹å™¨éƒ½æ˜¯ä¸SOMç»“æ„ç›¸åŒçš„LSTMç½‘ç»œã€‚<br>
ä¸SOMä½œå¯¹æ¯”ï¼ŒSPPæ²¡æœ‰æ˜¾å¼æ¨æ–­å‡ºå…¶ä»–æ™ºèƒ½ä½“çš„ç›®æ ‡ã€‚ç›¸åï¼Œå®ƒé€šè¿‡é¢„æµ‹æ™ºèƒ½ä½“åœ¨æ¯ä¸ªæ—¶é—´æ­¥çš„åŠ¨ä½œæ¥éšå¼çš„æ„å»ºå¯¹æ‰‹æ¨¡å‹ã€‚åœ¨SOMä¸­ï¼Œä¸€ä¸ªå‚è€ƒçš„ç›®æ ‡ä½œä¸ºç­–ç•¥ç½‘ç»œçš„é™„åŠ è¾“å…¥ã€‚è€Œåœ¨SPPï¼Œç±»ä¼¼çš„å‚è€ƒç›®æ ‡æ˜¯ä»å¯¹æ‰‹ç­–ç•¥é¢„æµ‹å™¨å¾—åˆ°çš„éšè—è¡¨ç¤ºï¼ŒæŠŠå®ƒä½œä¸ºç­–ç•¥ç½‘ç»œçš„é™„åŠ è¾“å…¥ã€‚<br>
<strong>è®­ç»ƒç»†èŠ‚</strong>ã€‚åœ¨æˆ‘ä»¬çš„æ‰€æœ‰å®éªŒä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç³»æ•°ä¸º$0.01$çš„ç†µï¼Œä»·å€¼æŸå¤±ç³»æ•°ä¸º$0.5$ï¼ŒæŠ˜æ‰£ç³»æ•°ä¸º$0.99$çš„A3Cè®­ç»ƒæ™ºèƒ½ä½“çš„ç­–ç•¥ã€‚ä½¿ç”¨Adamä¼˜åŒ–æ™ºèƒ½ä½“å•†ç­–ç•¥çš„å‚æ•°ï¼Œå…¶ä¸­$\beta_1= 0.9,\beta_2= 0.999,\epsilonn =1\times 10^{-8}$ï¼Œæƒé‡è¡°å‡ä¸º$0$ã€‚å­¦ä¹ ç‡ä¸º$0.1$çš„SGDç”¨äºæ¨æ–­å¦ä¸€ä¸ªæ™ºèƒ½ä½“çš„ç›®æ ‡ï¼Œ$\hat{z}_{other}$ã€‚<br>
ç¡¬å¸å’Œé£Ÿè°±æ¸¸æˆä¸­ç­–ç•¥ç½‘ç»œçš„éšè—å±‚ç»´åº¦ä¸º$64$ï¼Œé—¨æ¸¸æˆä¸­ä¸º$128$ã€‚æ‰€æœ‰æ¸¸æˆå’Œæ¨¡å‹çš„å­¦ä¹ ç‡éƒ½æ˜¯$1\times 10^{-4}$ã€‚<br>
è§‚æµ‹çŠ¶æ€$s$ç”¨ä¸€äº›ç‹¬çƒ­å‘é‡è¡¨ç¤ºï¼ŒåŒ…æ‹¬ç¯å¢ƒä¸­æ‰€æœ‰ç‰©ä½“çš„ä½ç½®ï¼Œä»¥åŠæ™ºèƒ½ä½“å’Œå¦ä¸€ä¸ªæ™ºèƒ½ä½“çš„ä½ç½®ã€‚è¿™ä¸ªè¾“å…¥çŠ¶æ€çš„ç»´åº¦æ˜¯$1\times n$ç‰¹å¾ï¼Œå…¶ä¸­Coinï¼ŒRecipeå’ŒDooræ¸¸æˆçš„ç‰¹å¾æ•°åˆ†åˆ«ä¸º$384$,$192$å’Œ$900$ã€‚å¯¹äºæ¯ä¸ªå®éªŒï¼Œæˆ‘ä»¬ä½¿ç”¨5ä¸ªä¸åŒçš„éšæœºç§å­è®­ç»ƒæ¨¡å‹ã€‚é™¤éç‰¹æ®Šè¯´æ˜ï¼Œå¦åˆ™è®ºæ–‡ä¸­å±•ç¤ºçš„æ‰€æœ‰æ¸¸æˆç»“æœéƒ½æ˜¯æ¯æ­¥è¿›è¡Œçš„10æ¬¡ä¼˜åŒ–æ›´æ–°çš„ç»“æœã€‚</p>
<!--
### ç¡¬å¸æ¸¸æˆã€‚
é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªå®Œå…¨åˆä½œçš„ä»»åŠ¡ä¸Šè¯„ä¼°æ¨¡å‹ï¼Œåœ¨è¿™ä¸ªä»»åŠ¡ä¸­ï¼Œå½“æ™ºèƒ½ä½“ä½¿ç”¨ä»–ä»¬ä¸¤ä¸ªçš„ç›®æ ‡è€Œä¸ä»…ä»…æ˜¯ä»–ä»¬è‡ªå·±çš„ç›®æ ‡æ—¶ï¼Œä»–ä»¬å¯ä»¥è·å¾—æ›´å¤šçš„å¥–åŠ±ã€‚å› æ­¤ï¼Œä¼°è®¡å…¶ä»–ç©å®¶çš„ç›®æ ‡å¹¶åœ¨é‡‡å–è¡ŒåŠ¨æ—¶ä½¿ç”¨è¯¥ä¿¡æ¯ç¬¦åˆæ¯ä¸ªæ™ºèƒ½ä½“äººçš„æœ€ä½³åˆ©ç›Šã€‚å¦‚å›¾4çš„å·¦å›¾æ‰€ç¤ºï¼Œæ¸¸æˆåœ¨8Ã—8ç½‘æ ¼ä¸Šè¿›è¡Œï¼Œè¯¥ç½‘æ ¼åŒ…å«12ä¸ª3ç§ä¸åŒé¢œè‰²çš„ç¡¬å¸ï¼ˆæ¯ç§é¢œè‰²4ä¸ªç¡¬å¸ï¼‰ã€‚åœ¨æ¯é›†å¼€å§‹æ—¶ï¼Œæ™ºèƒ½ä½“è¢«éšæœºåˆ†é…ä¸‰ç§é¢œè‰²ä¸­çš„ä¸€ç§ã€‚åŠ¨ä½œç©ºé—´åŒ…æ‹¬ï¼šä¸Šï¼Œä¸‹ï¼Œå·¦ï¼Œå³æˆ–é€šè¿‡ã€‚ä¸€æ—¦æ™ºèƒ½ä½“äººè¸©åˆ°ç¡¬å¸ï¼Œé‚£ä¸ªç¡¬å¸å°±ä¼šä»ç½‘æ ¼ä¸­æ¶ˆå¤±ã€‚æ¸¸æˆåœ¨20ä¸ªæ­¥éª¤åç»“æŸï¼ˆå³æ¯ä¸ªæ™ºèƒ½ä½“éœ€è¦10ä¸ªæ­¥éª¤ï¼‰ã€‚ä¸¤åç‰¹å·¥åœ¨æ¯”èµ›ç»“æŸæ—¶æ”¶åˆ°çš„å¥–åŠ±ç”±ä¸‹é¢çš„å…¬å¼ç»™å‡ºï¼š
2ï¼‰ï¼Œå…¶ä»–nå…¶ä»–Cselfæ˜¯è‡ªæˆ‘ç›®æ ‡é¢œè‰²çš„ç¡¬å¸æ•°é‡ï¼Œç”±å…¶ä»–æ™ºèƒ½ä½“äººæ”¶é›†ï¼Œè€Œn self Cneitheræ˜¯ä¸è‡ªå·±æ”¶é›†çš„æ™ºèƒ½ä½“äººç›®æ ‡ç›¸å¯¹åº”çš„ç¡¬å¸æ•°é‡ã€‚å¯¹äºå›¾4ä¸­çš„ç¤ºä¾‹ï¼Œæ™ºèƒ½ä½“1å…·æœ‰Cself =æ©™è‰²å’ŒCother =é’è‰²ï¼Œè€Œæ™ºèƒ½ä½“2çš„Cselfæ˜¯é’è‰²è€ŒCotheræ˜¯æ©™è‰²ã€‚å¯¹äºä¸¤ç§è¯å‰‚ï¼Œä¸¤è€…éƒ½æ˜¯çº¢è‰²çš„ã€‚
æ”¶é›†ä¸ç¬¦åˆä»»ä½•æ™ºèƒ½ä½“äººç›®æ ‡çš„ç¡¬å¸çš„æƒ©ç½šçš„ä½œç”¨æ˜¯é¿å…æ”¶æ•›åˆ°æš´åŠ›æ”¿ç­–ï¼Œåœ¨è¿™ç§æ”¿ç­–ä¸­ï¼Œæ™ºèƒ½ä½“äººå¯ä»¥é€šè¿‡æ”¶é›†å…¶é™„è¿‘çš„æ‰€æœ‰ç¡¬å¸è€Œè·å¾—ä¸å¯å¿½è§†çš„å¥–åŠ±é‡‘é¢ï¼Œè€Œä¸æ˜¯å…³äºä»–ä»¬çš„é¢œè‰²ã€‚ä¸ºäº†æœ€å¤§åŒ–å…¶å›æŠ¥ï¼Œæ¯ä¸ªæ™ºèƒ½ä½“äººéœ€è¦æ”¶é›†è‡ªå·±çš„ç¡¬å¸æˆ–å…¶åˆä½œè€…çš„é¢œè‰²ï¼Œè€Œä¸æ˜¯å‰©ä½™é¢œè‰²çš„ç¡¬å¸ã€‚å› æ­¤ï¼Œå½“ä¸¤ä¸ªæ™ºèƒ½ä½“äººèƒ½å¤Ÿåœ¨æ¸¸æˆä¸­å°½å¯èƒ½æ—©åœ°é«˜ç²¾åº¦åœ°æ¨æ–­å…¶åˆä½œè€…çš„ç›®æ ‡æ—¶.
-->
<h2 id="è®¨è®º">è®¨è®º</h2>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ç§æ–°æ–¹æ³•ï¼Œç”¨äºä»å…¶ä»–æ™ºèƒ½ä½“çš„è¡Œä¸ºä¸­æ¨æ–­ä»–ä»¬çš„éšè—çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨è¿™äº›ä¼°è®¡æ¥é€‰æ‹©åŠ¨ä½œã€‚æˆ‘ä»¬è¯æ˜äº†æ™ºèƒ½ä½“èƒ½å¤Ÿåœ¨åˆä½œå’Œç«äº‰ç¯å¢ƒä¸­ä¼°è®¡å…¶ä»–å‚ä¸è€…çš„éšè—ç›®æ ‡ï¼Œè¿™ä½¿ä»–ä»¬èƒ½å¤Ÿæ”¶æ•›åˆ°æ›´å¥½çš„æ”¿ç­–å¹¶è·å¾—æ›´é«˜çš„å›æŠ¥ã€‚åœ¨æœ¬æ–‡æå‡ºçš„ä»»åŠ¡ä¸­ï¼Œå¯¹å…¶ä»–æ™ºèƒ½ä½“çš„æ˜¾å¼å»ºæ¨¡æ¯”ä»…ä»…è€ƒè™‘å…¶ä»–ä»£ç†æˆä¸ºç¯å¢ƒçš„ä¸€éƒ¨åˆ†æ›´å¥½çš„æ€§èƒ½ã€‚ 	SOMçš„ä¸€ä¸ªé™åˆ¶æ˜¯å®ƒæ¯”å…¶ä»–baselineéœ€è¦æ›´é•¿çš„è®­ç»ƒæ—¶é—´ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ¯ä¸€æ­¥éƒ½è¿›è¡Œäº†åå‘ä¼ æ’­ã€‚ä½†æ˜¯ï¼Œå®ƒçš„onlineæ›´æ–°æ–¹å¼å¯¹äºé€‚åº”ç¯å¢ƒä¸­å…¶ä»–æ™ºèƒ½ä½“çš„åŠ¨ä½œå˜åŒ–è‡³å…³é‡è¦ã€‚SOMçš„ä¸€äº›ä¸»è¦ä¼˜ç‚¹æ˜¯ç®€å•æ€§å’Œçµæ´»æ€§ï¼Œå®ƒä¸éœ€è¦ä»»ä½•é¢å¤–å‚æ•°æ¥æ¨¡æ‹Ÿç¯å¢ƒä¸­çš„å…¶ä»–ä»£ç†ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•å¼ºåŒ–å­¦ä¹ ç®—æ³•è¿›è¡Œè®­ç»ƒï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°ä¸ä»»ä½•ç­–ç•¥å‚æ•°åŒ–æˆ–ç½‘ç»œç»“æ„é›†æˆã€‚SOMå¯ä»¥é€‚åº”å…·æœ‰ä¸¤ä¸ªä»¥ä¸Šæ™ºèƒ½ä½“çš„ç¯å¢ƒï¼Œå› ä¸ºæ™ºèƒ½ä½“å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç­–ç•¥æ¥æ¨¡æ‹Ÿä»»æ„æ•°é‡çš„æ™ºèƒ½ä½“çš„åŠ¨ä½œå¹¶æ¨æ–­å…¶ç›®æ ‡ã€‚è€Œä¸”ï¼Œå®ƒå¯ä»¥å¾ˆå®¹æ˜“åœ°æ¨å¹¿åˆ°è®¸å¤šä¸åŒçš„ç¯å¢ƒå’Œä»»åŠ¡ã€‚<br>
æˆ‘ä»¬è®¡åˆ’é€šè¿‡è¯„ä¼°æ›´å¤æ‚ç¯å¢ƒä¸­çš„æ¨¡å‹æ¥æ‰©å±•è¿™é¡¹å·¥ä½œï¼ŒåŒ…æ‹¬ä¸¤ä¸ªä»¥ä¸Šçš„å‚ä¸è€…ï¼Œæ··åˆç­–ç•¥ï¼Œæ›´å¤šæ ·åŒ–çš„æ™ºèƒ½ä½“ç±»å‹ï¼ˆä¾‹å¦‚å…·æœ‰ä¸åŒåŠ¨ä½œç©ºé—´çš„æ™ºèƒ½ä½“ï¼Œå¥–åŠ±å‡½æ•°ï¼Œè§’è‰²æˆ–ç­–ç•¥ï¼‰ï¼Œä»¥åŠå‡è®¾å…¶ä»–ç©å®¶å’Œè‡ªå·±ä¸€æ ·çš„æ¨¡å‹åå·®ã€‚<br>
æœªæ¥ç ”ç©¶çš„å…¶ä»–é‡è¦é€”å¾„æ˜¯è®¾è®¡èƒ½å¤Ÿé€‚åº”ç¯å¢ƒä¸­å…¶ä»–æ™ºèƒ½ä½“éå¹³ç¨³ç­–ç•¥çš„æ¨¡å‹ï¼Œå¤„ç†å…·æœ‰åˆ†å±‚ç›®æ ‡çš„ä»»åŠ¡ï¼Œå¹¶åœ¨æµ‹è¯•æ—¶é‡åˆ°æ–°æ™ºèƒ½ä½“æ—¶è¡¨ç°è‰¯å¥½ã€‚<br>
æœ€åï¼Œè®¸å¤šç ”ç©¶é¢†åŸŸå¯ä»¥ä»æ‹¥æœ‰å…¶ä»–æ™ºèƒ½ä½“çš„æ¨¡å‹ä¸­å—ç›Šï¼Œè¿™äº›æ™ºèƒ½ä½“èƒ½å¤Ÿæ¨ç†å…¶ä»–æ™ºèƒ½ä½“çš„æ„å›¾å¹¶é¢„æµ‹ä»–ä»¬çš„åŠ¨ä½œã€‚è¿™äº›æ¨¡å‹å¯èƒ½å¯¹äººæœºæˆ–å¸ˆç”Ÿäº’åŠ¨ï¼Œä»¥åŠä»·å€¼å¯¹é½é—®é¢˜æœ‰æ’å¤§å¸®åŠ©ã€‚æ­¤å¤–ï¼Œè¿™äº›æ–¹æ³•å¯ç”¨äºå¤šæ™ºèƒ½ä½“ä»»åŠ¡ä¸­åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ï¼Œå› ä¸ºå‰å‘æ¨¡å‹çš„å‡†ç¡®æ€§å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºé¢„æµ‹å…¶ä»–æ™ºèƒ½ä½“åŠ¨ä½œçš„èƒ½åŠ›ã€‚</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/01/26/Policy-Gradient-With-Value-Function-Approximation-For-Collective-Multiagent-Planning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/26/Policy-Gradient-With-Value-Function-Approximation-For-Collective-Multiagent-Planning/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">Policy Gradient With Value Function Approximation For Collective Multiagent Planning</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-26 19:33:50" itemprop="dateCreated datePublished" datetime="2019-01-26T19:33:50+08:00">2019-01-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-07 00:22:27" itemprop="dateModified" datetime="2019-05-07T00:22:27+08:00">2019-05-07</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/å¼ºåŒ–å­¦ä¹ /" itemprop="url" rel="index"><span itemprop="name">å¼ºåŒ–å­¦ä¹ </span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="æ‘˜è¦">æ‘˜è¦</h2>
<p>åˆ†å¸ƒå¼çš„éƒ¨åˆ†å¯è§‚æµ‹é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹(Dec POMDP)ä¸ºè§£å†³å¤šæ™ºèƒ½ä½“ç³»ç»Ÿä¸­çš„åºåˆ—å†³ç­–é—®é¢˜æä¾›äº†ä¸€ä¸ªæ¡†æ¶ã€‚è€ƒè™‘åˆ°POMDPçš„è®¡ç®—å¤æ‚åº¦ï¼Œæœ€è¿‘çš„ç ”ç©¶ä¸»è¦é›†ä¸­åœ¨Dec-POMDPä¸­ä¸€äº›æ˜“äºå¤„ç†ä½†æ˜¯æ¯”è¾ƒå®ç”¨çš„å­é—®é¢˜ã€‚æœ¬æ–‡è§£å†³çš„å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªå­é—®é¢˜å«åšCDec-POMDPå…¶ä¸­ä¸€ç³»åˆ—æ™ºèƒ½ä½“çš„å…±åŒè¡Œä¸ºå½±å“äº†å®ƒä»¬å…¬å…±çš„rewardå’Œç¯å¢ƒå˜åŒ–ã€‚æœ¬æ–‡çš„ä¸»è¦è´¡çŒ®æ˜¯æå‡ºäº†ä¸€ä¸ªactor-critic(AC)å¼ºåŒ–å­¦ä¹ ç®—æ³•ä¼˜åŒ–CDec-POMDPé—®é¢˜çš„policyã€‚æ™®é€šçš„ACç®—æ³•å¯¹äºå¤§å‹é—®é¢˜æ”¶æ•›çš„å¾ˆæ…¢ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ¬æ–‡å±•ç¤ºäº†å¦‚ä½•å°†æ™ºèƒ½ä½“çš„ä¼°è®¡åŠ¨ä½œå€¼å‡½æ•°è¿›è¡Œåˆ†è§£ä»è€Œäº§ç”Ÿæœ‰æ•ˆçš„æ›´æ–°ä»¥åŠæ¨å¯¼å‡ºä¸€ä¸ªåŸºäºå±€éƒ¨å¥–åŠ±ä¿¡å·çš„æ–°çš„criticè®­ç»ƒæ–¹å¼ã€‚é€šè¿‡åœ¨ä¸€ä¸ªåˆæˆçš„benchmarkä»¥åŠçœŸå®çš„å‡ºç§Ÿè½¦è½¦é˜Ÿä¼˜åŒ–é—®é¢˜ä¸Šå’Œå…¶ä»–æ–¹æ³•è¿›è¡Œå¯¹æ¯”ï¼Œç»“æœè¡¨æ˜æœ¬æ–‡çš„ACæ–¹æ³•æä¾›äº†æ¯”ä¹‹å‰æœ€å¥½çš„æ–¹æ³•è¿˜è¦é«˜è´¨é‡çš„æ–¹æ³•ã€‚</p>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>è¿‘äº›å¹´æ¥ï¼Œåˆ†å¸ƒå¼çš„éƒ¨åˆ†å¯è§‚æµ‹é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹å·²ç»å‘å±•æˆäº†è§£å†³å¤šæ™ºèƒ½ä½“åä½œçš„åºåˆ—å†³ç­–é—®é¢˜çš„ä¸€ä¸ªå¾ˆæœ‰å‰æ™¯çš„(promising)æ–¹æ³•ã€‚Dec-POMDPå¯¹æ™ºèƒ½ä½“åŸºäºç¯å¢ƒå’Œå…¶ä»–æ™ºèƒ½ä½“çš„ä¸åŒéƒ¨åˆ†è§‚æµ‹æœ€å¤§åŒ–ä¸€ä¸ªå…¨å±€çš„ç›®æ ‡è¿›è¡Œå»ºæ¨¡ã€‚Dec-POMDPçš„å…·ä½“åº”ç”¨åŒ…æ‹¬åè°ƒè¡Œæ˜Ÿæ¢æµ‹ï¼Œå¤šæœºå™¨äººåè°ƒæ§åˆ¶ä»¥åŠæ— çº¿ç½‘ç»œçš„ååé‡ä¼˜åŒ–ã€‚ç„¶è€Œï¼Œè§£å†³åˆ†å¸ƒå¼çš„éƒ¨åˆ†é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹æ˜¯ç›¸å½“å›°éš¾çš„ï¼Œå³ä½¿å¯¹äºåªæœ‰$2$ä¸ªæ™ºèƒ½ä½“çš„é—®é¢˜å‘¢æ˜¯NPéš¾çš„ã€‚<br>
ä¸ºäº†å¢å¤§è§„æ¨¡å’Œæé«˜çœŸå®é—®é¢˜ä¸­çš„åº”ç”¨ï¼Œè¿‡å»çš„ç ”ç©¶å·²ç»æ¢ç´¢äº†æ™ºèƒ½ä½“ä¹‹é—´ä¸¥æ ¼çš„äº¤äº’ï¼Œå¦‚çŠ¶æ€è½¬æ¢å’Œè§‚æµ‹ç‹¬ç«‹ï¼Œäº‹ä»¶é©±åŠ¨çš„çš„äº¤äº’ä»¥åŠæ™ºèƒ½ä½“ä¹‹é—´çš„å¼±è€¦åˆæ€§ã€‚æœ€è¿‘ï¼Œä¸€ç³»åˆ—å·¥ä½œå¼€å§‹å…³æ³¨äºæ™ºèƒ½ä½“çš„èº«ä»½ä¸å½±å“å®ƒä»¬ä¹‹é—´çš„äº¤äº’ä¸Šï¼Œç¯å¢ƒçš„å˜åŒ–ä¸»è¦å—åˆ°æ™ºèƒ½ä½“çš„å…±åŒå½±å“ï¼Œå’Œè‘—åçš„é˜»å¡æ¸¸æˆå¾ˆåƒã€‚ä¸€äº›åŸå¸‚äº¤é€šä¸­çš„é—®é¢˜å¦‚å‡ºç§Ÿè½¦è°ƒåº¦å¯ä»¥ç”¨è¿™æ ·çš„ååŒè§„åˆ’æ¨¡å‹è¿›è¡Œå»ºæ¨¡ã€‚<br>
åœ¨æœ¬æ–‡ä¸­ï¼Œä½œè€…ç€é‡äºé›†ä¸­çš„Dec-POMDPæ¡†æ¶å°†ä¸€ç±»ä¸ç¡®å®šæƒ…å†µä¸‹çš„é›†ä¸­å¤šæ™ºèƒ½ä½“åºåˆ—å†³ç­–é—®é¢˜å½¢å¼åŒ–ã€‚Nguyenç­‰äººæå‡ºäº†ä¸€ä¸ªé‡‡æ ·æ–¹æ³•ä¼˜åŒ–CDec-POMDPæ¨¡å‹ä¸­çš„policyã€‚ä¹‹å‰æ–¹æ³•çš„ä¸€ä¸ªä¸»è¦ç¼ºç‚¹æ˜¯policyæ˜¯ç”¨è¡¨æ ¼å½¢å¼å±•ç°çš„ï¼Œéšç€æ™ºèƒ½ä½“çš„observation spacesæ”¹å˜æ—¶ï¼Œè¡¨æ ¼å½¢å¼çš„policyä¸èƒ½å¾ˆå¥½çš„è¿›è¡Œæ‰©å±•ã€‚å—åˆ°æœ€è¿‘ä¸€äº›å¼ºåŒ–å­¦ä¹ å·¥ä½œçš„å¯å‘ï¼Œæœ¬æ–‡çš„è´¡çŒ®æ˜¯ä¸€ä¸ªACæ¡†æ¶çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•ç”¨æ¥ä¼˜åŒ–CDec-POMDPçš„policyã€‚Policyç”¨å‡½æ•°å¦‚ç¥ç»ç½‘ç»œæ¥è¡¨ç¤ºå¯ä»¥é¿å…è¡¨æ ¼å½¢å¼çš„policyçš„æ‰©å±•æ€§é—®é¢˜ã€‚æˆ‘ä»¬æ¨å¯¼å‡ºäº†ç­–ç•¥æ¢¯åº¦å¹¶ä¸”åŸºäºCDec-POMDPä¸­æ™ºèƒ½ä½“çš„äº¤äº’æå‡ºäº†ä¸€ä¸ªä¼°è®¡çš„å› å­åŠ¨ä½œå€¼å‡½æ•°ã€‚æ™®é€šçš„ACç®—æ³•å› ä¸ºå­¦ä¹ å…¨å±€rewardçš„åŸå› ï¼Œåœ¨è§£å†³å¤§å‹å¤šæ™ºèƒ½ä½“ç³»ç»Ÿé—®é¢˜æ—¶æ”¶æ•›çš„å¾ˆæ…¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„æ–¹å¼å»è®­ç»ƒcriticï¼Œé«˜æ•ˆåˆ©ç”¨æ™ºèƒ½ä½“çš„å±€éƒ¨å€¼å‡½æ•°çš„ä¼°è®¡åŠ¨ä½œå€¼å‡½æ•°ã€‚<br>
æˆ‘ä»¬åœ¨ä¸€ä¸ªåˆæˆçš„å¤šæœºå™¨äººå¯¼èˆªé¢†åŸŸå’Œç°å®ä¸–ç•Œä¸­ä¸€ä¸ªäºšæ´²åŸå¸‚çš„å‡ºç§Ÿè½¦è°ƒåº¦é—®é¢˜ä¸Šæµ‹è¯•äº†æœ¬æ–‡çš„æ–¹æ³•ï¼Œç»“æœå±•ç¤ºäº†æœ¬æ–‡çš„æ–¹æ³•å¯ä»¥æ‰©å±•åˆ°å¤§å‹å¤šæ™ºèƒ½ä½“ç³»ç»Ÿä¸Šã€‚æ ¹æ®ç»éªŒï¼Œæˆ‘ä»¬å› å¼ACæ–¹æ³•æ¯”ä»¥å‰æœ€å¥½çš„æ–¹æ³•ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆéƒ½è¦å¥½ã€‚å› å¼ACæ–¹æ³•æ”¶æ•›çš„ä¹Ÿæ¯”æ™®é€šçš„ACæ–¹æ³•å¿«å¾ˆå¤šï¼ŒéªŒè¯äº†æˆ‘ä»¬æå‡ºçš„criticè®­ç»ƒæ–¹æ³•çš„æœ‰æ•ˆæ€§ã€‚<br>
<strong>ç›¸å…³å·¥ä½œ</strong> æˆ‘ä»¬çš„å·¥ä½œåŸºäºå…·æœ‰è¿‘ä¼¼å€¼å‡½æ•°çš„ç­–ç•¥æ¢¯åº¦æ¡†æ¶ã€‚ç„¶è€Œï¼Œæ ¹æ®ä»¥å¾€çš„ç»éªŒæ˜¾ç¤ºï¼Œç›´æ¥åº”ç”¨åŸå§‹çš„ç­–ç•¥æ¢¯åº¦åˆ°å¤šæ™ºèƒ½ä½“ä»»åŠ¡ä¸­ï¼Œå°¤å…¶æ˜¯CDec-POMDPæ¨¡å‹ä¸­ä¼šäº§ç”Ÿè¾ƒé«˜æ–¹å·®ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä¸€ä¸ªå’ŒCDec-POMDPå…¼å®¹çš„ä¼°è®¡å€¼å‡½æ•°ï¼Œå®ƒèƒ½äº§ç”Ÿé«˜æ•ˆä¸”ä½æ–¹å·®çš„ç­–ç•¥æ¢¯åº¦æ›´æ–°ã€‚Peshkinå¾ˆæ—©ä¹‹å‰å°±ç ”ç©¶è¿‡äº†åº”ç”¨äºåˆ†å¸ƒå¼policyçš„å¼ºåŒ–å­¦ä¹ ï¼ŒGuestrinè¿˜æå‡ºä½¿ç”¨REINFORCEä»åè°ƒå›¾ä¸­è®­ç»ƒä¸€ä¸ªå› å­å€¼å‡½æ•°çš„softmaxç­–ç•¥ã€‚ç„¶è€Œï¼Œè¿™äº›ä»¥å‰çš„å·¥ä½œä¸­ï¼Œç­–ç•¥æ¢¯åº¦éƒ½æ˜¯ä»å…¨å±€çš„ç»éªŒå›æŠ¥è€Œä¸æ˜¯åˆ†è§£åçš„criticä¸­ä¼°è®¡çš„ã€‚æˆ‘ä»¬åœ¨ç¬¬å››ç« ä¸­å±•ç¤ºäº†ä¸€ä¸ªåˆ†è§£åciritcå’ŒåŸºäºè®­ç»ƒè¿™ä¸ªcriticå¾—åˆ°çš„ä¸€ä¸ªå•ä¸ªå€¼å‡½æ•°å¯¹äºé«˜æ•ˆçš„é‡‡æ ·å­¦ä¹ æ˜¯å¾ˆé‡è¦çš„ã€‚æˆ‘ä»¬çš„å®éªŒç»“æœè¡¨æ˜äº†æˆ‘ä»¬æå‡ºçš„criticè®­ç»ƒæ–¹å¼æ¯”ç”¨å…¨å±€ç»éªŒå›æŠ¥è®­ç»ƒæ”¶æ•›çš„è¿˜è¦å¿«ã€‚</p>
<h2 id="é›†ä¸­åˆ†å¸ƒå¼pomdpæ¨¡å‹">é›†ä¸­åˆ†å¸ƒå¼POMDPæ¨¡å‹</h2>
<p>æˆ‘ä»¬é¦–å…ˆä»‹ç»ä¸€ä¸‹Nguyenæå‡ºçš„CDec-POMDPæ¨¡å‹ã€‚ä¸€ä¸ªå¯¹åº”äºè¿™ä¸ªæ¨¡å‹çš„$T$æ­¥çš„åŠ¨æ€è´å¶æ–¯ç½‘ç»œå¦‚å›¾æ‰€ç¤ºã€‚å®ƒç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>ä¸€ä¸ªæœ‰é™çš„è®¡åˆ’èŒƒå›´$H$</li>
<li>æ™ºèƒ½çš„æ•°é‡$M$ï¼Œä¸€ä¸ªæ™ºèƒ½ä½“må¯èƒ½å¤„åœ¨state space $S$ä¸­çš„ä»»æ„ä¸€ä¸ªçŠ¶æ€ï¼Œè”åˆstate spaceæ˜¯$\times_{m=1}^MS$ï¼Œæˆ‘ä»¬ç”¨$i\in S$è¡¨ç¤ºä¸€ä¸ªstateã€‚</li>
<li>æ¯ä¸€ä¸ªæ™ºèƒ½ä½“méƒ½æœ‰ä¸€ä¸ªaction spaceAï¼Œæˆ‘ä»¬ç”¨$j\in A$è¡¨ç¤ºä¸€ä¸ªactionã€‚</li>
<li>ç”¨$(s_{1:H},a_{1:H})<sup>m=(s_1</sup>m,a_1<sup>m,\cdots,s_H</sup>m,a_H<sup>m)$è¡¨ç¤ºä¸€ä¸ªæ™ºèƒ½ä½“må®Œæ•´çš„state-actionè½¨è¿¹ã€‚ç”¨éšæœºå˜é‡$s_t</sup>m,a_t^m$è¡¨ç¤ºæ™ºèƒ½ä½“$m$åœ¨$t$æ—¶åˆ»çš„stateå’Œactionã€‚ä¸åŒçš„æŒ‡ç¤ºå‡½æ•°$I_t(\cdot)$å¦‚è¡¨$1$æ‰€ç¤ºã€‚ç»™å®šæ¯ä¸€ä¸ªæ™ºèƒ½ä½“$m\in M$çš„è½¨è¿¹ï¼Œå®šä¹‰ä»¥ä¸‹çš„è®¡æ•°æ–¹å¼ï¼š<br>
$$n_t(i,j,iâ€™) = \sum_{m=1}^M I_t^m(i,j,iâ€™),\forall i,iâ€™\in S,j\in A.$$<br>
å¦‚è¡¨$1$æ‰€ç¤ºï¼Œè®¡æ•°å™¨$n_t(i,j,iâ€™)$è¡¨ç¤ºåœ¨$t$æ—¶åˆ»å¤„äºstate $i$ï¼Œé‡‡å–action $j$ï¼Œè½¬æ¢åˆ°state $iâ€™$çš„æ™ºèƒ½ä½“æ•°é‡ã€‚å…¶ä»–è®¡æ•°å™¨$n_t(i)$å’Œ$n_t(i,j)$çš„å®šä¹‰ç±»ä¼¼ã€‚ä½¿ç”¨è¿™äº›è®¡æ•°å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰$t$æ—¶åˆ»çš„è®¡æ•°è¡¨$\bf{n}<em>{s_t}$å’Œ$\bf{n}</em>{s_ta_t}$å¦‚è¡¨$1$æ‰€ç¤ºã€‚</li>
<li>æˆ‘ä»¬å‡è®¾ä¸€ä¸ªæ™®éçš„éƒ¨åˆ†è§‚æµ‹ç¯å¢ƒï¼Œå…¶ä¸­æ™ºèƒ½ä½“åŸºäºå…¶ä»–æ™ºèƒ½ä½“çš„æ€»ä½“å½±å“å¯ä»¥æœ‰ä¸åŒçš„ovservationã€‚ä¸€ä¸ªæ™ºèƒ½ä½“è§‚æµ‹åˆ°å®ƒçš„å±€éƒ¨state $s_t<sup>m$ã€‚æ­¤å¤–åœ¨$t$æ—¶åˆ»åŸºäºå®ƒçš„å±€éƒ¨çŠ¶æ€$s_t</sup>m$å’Œè®¡æ•°è¡¨$\bf{n}_{s_t}$è§‚æµ‹åˆ°$o_t^m$ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ™ºèƒ½ä½“måœ¨$t$æ—¶åˆ»å¤„äºstate $i$ï¼Œå¯ä»¥è§‚æµ‹åˆ°å…¶ä»–ä¹Ÿå¤„åœ¨state $i(=n_t(i))$çš„æ™ºèƒ½ä½“æˆ–è€…å…¶ä»–å¤„åœ¨state $i$ä¸´è¿‘çŠ¶æ€$j$çš„æ™ºèƒ½ä½“ï¼Œå³$n_t(j),\forall j\in Nb(i)$ã€‚</li>
<li>çŠ¶æ€è½¬æ¢å‡½æ•°æ˜¯$\Phi_t(s_{t+1}<sup>m=iâ€™|s_t</sup>m=i,a_t^m=j,\bf{N}<em>{s_t})$ã€‚æ‰€æœ‰æ™ºèƒ½ä½“çš„çŠ¶æ€è½¬æ¢å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œæ³¨æ„å®ƒä¼šå—åˆ°$\bf{n}</em>{s_t}$çš„å½±å“ï¼Œè€Œ$\bf{n}_{s_t}$ä¾èµ–äºæ™ºèƒ½ä½“çš„å…±åŒè¡Œä¸ºã€‚</li>
<li>æ¯ä¸€ä¸ªæ™ºèƒ½ä½“mæœ‰ä¸€ä¸ªä¸å¹³ç¨³çš„policy $\pi_t<sup>m(j|i,o_t</sup>m(i,\bf{n}<em>{s_t}))$ï¼Œè¡¨ç¤ºåœ¨$t$æ—¶åˆ»ç»™å®šæ™ºèƒ½ä½“mçš„observation $(i,o_t^m(i,\bf{n}</em>{s_t})$ä¹‹åï¼Œæ™ºèƒ½ä½“é‡‡å–action $j$çš„æ¦‚ç‡ã€‚æˆ‘ä»¬ç”¨$\pi^m=(\pi_1,\cdots,\pi_H)$è¡¨ç¤ºæ™ºèƒ½ä½“mæ°´å¹³èŒƒå›´çš„policyã€‚</li>
<li>ä¸€ä¸ªæ™ºèƒ½ä½“æ¥æ”¶åˆ°çš„reward $r_t^m=r_t(i,j,\bf{n}<em>{s_t}$å–å†³äºå®ƒçš„å±€éƒ¨stateå’Œactionï¼Œä»¥åŠè®¡æ•°è¡¨$\bf{n}</em>{s_t}$ã€‚</li>
<li>åˆå§‹çš„stateåˆ†å¸ƒï¼Œ$b_o=(P(i)\forall i \in S)$ï¼Œå¯¹äºæ‰€æœ‰çš„æ™ºèƒ½ä½“éƒ½æ˜¯ç›¸åŒçš„ã€‚</li>
</ul>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œå±•ç¤ºäº†æœ€ç®€å•çš„ç‰ˆæœ¬ï¼Œæ‰€æœ‰çš„æ™ºèƒ½ä½“çš„ç±»å‹éƒ½ç›¸åŒï¼Œå¹¶ä¸”æœ‰ç›¸ä¼¼çš„state transitionï¼Œobservationå’Œrewardæ¨¡å‹ã€‚æ¨¡å‹ä¹Ÿå¯ä»¥å¤„ç†å¤šç§ç±»å‹çš„æ™ºèƒ½ä½“ï¼Œä¸åŒç±»å‹çš„æ™ºèƒ½ä½“æœ‰ä¸åŒçš„å˜åŒ–ã€‚æˆ‘ä»¬è¿˜å¯ä»¥å¼•å…¥ä¸€ä¸ªä¸å—æ™ºèƒ½ä½“actionå½±å“çš„external stateï¼Œå¦‚äº¤é€šé¢†åŸŸçš„å‡ºç§Ÿè½¦éœ€æ±‚ã€‚æˆ‘ä»¬çš„ç»“æœä¹Ÿå¯ä»¥æ‰©å±•åˆ°è§£å†³ç±»ä¼¼çš„é—®é¢˜ã€‚<br>
åƒCDec-POMDPä¹‹ç±»çš„æ¨¡å‹å¯¹äºè§£å†³æ™ºèƒ½ä½“æ•°é‡å¾ˆå¤§æˆ–è€…æ™ºèƒ½ä½“çš„èº«ä»½ä¸å½±å“rewardæˆ–è€…transition functionä¹‹ç±»çš„é—®é¢˜æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚å…¶ä¸­ä¸€ä¸ªåº”ç”¨æ˜¯å‡ºç§Ÿè½¦è½¦é˜Ÿä¼˜åŒ–é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯è®¡ç®—å‡ºå‡ºç§Ÿè½¦è°ƒåº¦çš„policyä½¿å¾—è½¦é˜Ÿçš„åˆ©æ¶¦æœ€å¤§åŒ–ã€‚ä¸€ä¸ªå‡ºç§Ÿè½¦çš„å†³ç­–è¿‡ç¨‹å¦‚ä¸‹ã€‚åœ¨æ—¶åˆ»$t$æ—¶ï¼Œæ¯ä¸ªå‡ºç§Ÿè½¦è§‚æµ‹åˆ°å®ƒå½“å‰çš„åŸå¸‚ç©ºé—´$z$ï¼Œä¸åŒçš„ç©ºé—´æ„æˆäº†state space $S$ï¼Œä»¥åŠå½“å‰ç©ºé—´å’Œå®ƒçš„ç›¸é‚»ç©ºé—´çš„å…¶ä»–å‡ºç§Ÿè½¦çš„è®¡æ•°å’Œå½“å‰å±€éƒ¨è¯·æ±‚çš„ä¸€ä¸ªä¼°è®¡ã€‚è¿™æ„æˆäº†å‡ºç§Ÿè½¦åŸºäºè®¡æ•°çš„observation $o(\cdot)$ã€‚åŸºäºè¿™ä¸ªobservationï¼Œå‡ºç§Ÿè½¦å¿…é¡»å†³å®šå¾…åœ¨å½“å‰ç©ºé—´$z$å¯»æ‰¾ä¹˜å®¢è¿˜æ˜¯ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç©ºé—´ã€‚è¿™äº›å†³ç­–é€‰æ‹©å–å†³äºä¸åŒçš„å› å­ï¼Œå¦‚è¯·æ±‚æ¯”ç‡å’Œå½“å‰ç©ºé—´å…¶ä»–å‡ºç§Ÿè½¦çš„è®¡æ•°ã€‚ç±»ä¼¼çš„ï¼Œç¯å¢ƒæ˜¯éšæœºçš„ï¼Œåœ¨ä¸åŒæ—¶é—´å‡ºç§Ÿè½¦è¯·æ±‚æ˜¯å˜åŒ–çš„ã€‚ä½¿ç”¨å‡ºç§Ÿè½¦è½¦é˜Ÿçš„çš„GPSè®°å½•å¯ä»¥å¾—åˆ°è¿™äº›å†å²çš„è¯·æ±‚æ•°æ®ã€‚<br>
<strong>åŸºäºè®¡æ•°çš„ç»Ÿè®¡æ•°æ®ç”¨äºè§„åˆ’</strong> CDec-POMDPæ¨¡å‹çš„ä¸€ä¸ªå…³é”®å±æ€§æ˜¯æ¨¡å‹çš„å˜æ¢å–å†³äºæ™ºèƒ½ä½“çš„é›†ä¸­äº¤äº’è€Œä¸æ˜¯æ™ºèƒ½ä½“çš„èº«ä»½ã€‚åœ¨å‡ºç§Ÿè½¦è½¦é˜Ÿä¼˜åŒ–é—®é¢˜ä¸­ï¼Œæ™ºèƒ½ä½“æ•°é‡å¯ä»¥ç›¸å½“å¤§ï¼ˆå¤§çº¦æœ‰$8000$ä¸ªæ™ºèƒ½ä½“åœ¨ç°å®ä¸–ç•Œçš„å®éªŒä¸­ï¼‰ã€‚ç»™å‡ºè¿™ä¹ˆå¤§æ•°é‡çš„æ™ºèƒ½ä½“ä¸ªæ•°ï¼Œä¸ºæ¯ä¸€ä¸ªæ™ºèƒ½ä½“è®¡ç®—å‡ºç‹¬ä¸€æ— äºŒçš„policyæ˜¯ä¸å¯èƒ½çš„ã€‚å› æ­¤ï¼Œå’Œä¹‹å‰çš„å·¥ä½œç±»ä¼¼ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¯¹æ‰€æœ‰æ™ºèƒ½ä½“è®¡ç®—å‡ºä¸€ä¸ªç›¸åŒçš„policy $\pi$ã€‚å› ä¸ºpolicy $\pi$å–å†³äºè®¡æ•°ï¼Œå®ƒä»£è¡¨äº†ä¸€ç§å¯Œæœ‰è¡¨ç°åŠ›çš„policyã€‚<br>
å¯¹äºä¸€ä¸ªå›ºå®šçš„æ•°é‡Mæ¥è¯´ï¼Œç”¨${(s_{1:T},a_{1:T})^m\forall m}$è¡¨ç¤ºä»å›¾$1$çš„DBNç½‘ç»œä¸­é‡‡æ ·å¾—åˆ°çš„ä¸åŒæ™ºèƒ½ä½“çš„state-actionè½¨è¿¹ã€‚ç”¨$\mathbf{n}<em>{1:T}={(\mathbf{n}</em>{s_t},\mathbf{n}<em>{s_ta_t},\mathbf{n}</em>{s_ta_ts_{t+1}})\forall t=1:T}$è¡¨ç¤ºæ¯ä¸€ä¸ªæ—¶é—´æ­¥$t$çš„ç»“æœè®¡æ•°è¡¨çš„ç»„åˆå‘é‡ã€‚Nguyenç­‰äººå±•ç¤ºäº†è®¡æ•°å™¨$\mathbf{n}$ä¸­æ‹¥æœ‰è¶³å¤Ÿçš„ç»Ÿè®¡æ•°æ®ç”¨æ¥è§„åˆ’ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªpolicy $\pi$åœ¨æ°´å¹³èŒƒå›´Hå†…çš„è”åˆå€¼å‡½æ•°å¯ä»¥é€šè¿‡è®¡æ•°å™¨çš„æœŸæœ›è¿›è¡Œè®¡ç®—ï¼š<br>
$$V(\pi) = \sum_{m=1}<sup>M\sum_{T=1}</sup>H E[r_T^m] = \sum_{\mathbf{n}\in \Omega_{1:H}}P(\mathbf{n};\pi) \left[\sum_{T=1}^H\sum_{i\in S,j\in A} n_T(i,j)r_T(i,j,\mathbf{n}<em>T)\right]$$<br>
é›†åˆ$\Omega</em>{1:H}$æ˜¯æ‰€æœ‰å…è®¸çš„ä¸€è‡´è®¡æ•°è¡¨çš„é›†åˆï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br>
$$\sum_{i\in S}n_T(i) = M \forall T;$$<br>
$$\sum_{j\in A}n_T(i,j) = n_T(i) = \forall j \forall T;$$<br>
$$\sum_{iâ€™\in S}n_T(i,j,iâ€™) = n_T(i,j)\forall i\in S,\forall j \in A, \forall T;$$<br>
$P(\mathbf{n},\pi)$æ˜¯è®¡æ•°å™¨çš„åˆ†å¸ƒã€‚è¿™ä¸ªç»“æœçš„ä¸€ä¸ªå…³é”®å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥ä»åˆ†å¸ƒ$P(\mathbf{n})$ä¸­å¯¹è®¡æ•°å™¨$\mathbf{n}$é‡‡æ ·è€Œä¸æ˜¯å¯¹å•ä¸ªä¸åŒæ™ºèƒ½ä½“çš„è½¨è¿¹$(s_{1:H},a_{1:H})è¿›è¡Œé‡‡æ ·æ¥$è¯„ä¼°policy $\pi$ï¼Œè¿™æ˜¾è‘—èŠ‚çœäº†è®¡ç®—å¼€é”€ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®¡ç®—æœ€ä¼˜çš„policy $\pi$æ¥æœ€å¤§åŒ–$V(\pi)$ã€‚æˆ‘ä»¬å‡è®¾ä¸€ä¸ªé›†ä¸­å¼å­¦ä¹ ï¼Œåˆ†å¸ƒå¼æ‰§è¡Œçš„å¼ºåŒ–å­¦ä¹ è®¾ç½®ã€‚æˆ‘ä»¬å‡è®¾æœ‰ä¸€ä¸ªæ¨¡æ‹Ÿå™¨å¯ä»¥ä»$P(\mathbf{n};\pi)$ä¸­æä¾›è®¡æ•°å™¨æ ·æœ¬ã€‚</p>
<h2 id="cdec-pomdpçš„ç­–ç•¥æ¢¯åº¦">CDec-POMDPçš„ç­–ç•¥æ¢¯åº¦</h2>
<p>ä¹‹å‰çš„å·¥ä½œæå‡ºäº†ä¸€ä¸ªåŸºäºé‡‡æ ·çš„EMç®—æ³•æ¥ä¼˜åŒ–policy $\pi$ã€‚è¿™ä¸ªpolicyè¢«è¡¨ç¤ºæˆè®¡æ•°å™¨$\mathbf{n}$ç©ºé—´ä¸­çš„ä¸€ä¸ªçº¿æ€§åˆ†æ®µè¡¨policyï¼Œå…¶ä¸­æ¯ä¸€ä¸ªçº¿æ€§ç‰‡æ®µæŒ‡å®šäº†ä¸‹ä¸€ä¸ªactionçš„åˆ†å¸ƒã€‚ç„¶è€Œï¼Œè¿™ç§è¡¨æ ¼å½¢å¼çš„è¡¨ç¤ºé™åˆ¶äº†å®ƒçš„è¡¨è¾¾èƒ½åŠ›ï¼Œå› ä¸ºç‰‡æ®µçš„æ•°é‡æ˜¯å›ºå®šçš„å…ˆéªŒï¼Œå¹¶ä¸”æ¯ä¸ªèŒƒå›´éƒ½å¿…é¡»æ‰‹åŠ¨å®šä¹‰ï¼Œè¿™å¯èƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿä¸åˆ©å½±å“ã€‚æ­¤å¤–ï¼Œå½“observation oæ˜¯å¤šç»´çš„æ—¶å€™ï¼Œå³ï¼Œä¸€ä¸ªæ™ºèƒ½ä½“è§‚æµ‹åˆ°å®ƒä½ç½®ç›¸é‚»åŒºåŸŸçš„è®¡æ•°å™¨æ—¶ï¼Œéœ€è¦æŒ‡æ•°å¤šä¸ªç‰‡æ®µã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼˜åŒ–å‡½æ•°å½¢å¼ï¼ˆå¦‚ç¥ç»ç½‘ç»œï¼‰çš„policyã€‚<br>
æˆ‘ä»¬é¦–å…ˆæ‰©å±•ç­–ç•¥æ¢¯åº¦ç†è®ºåˆ°CDec-POMDPä¸Šï¼Œç”¨$\theta$è¡¨ç¤ºpolicyå‚æ•°çš„å‘é‡ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥å±•ç¤ºå¦‚ä½•è®¡ç®—$\Delta_\theta V(\pi)$ã€‚ç”¨$\mathbf{s}_t,\mathbf{a}<em>t$è¡¨ç¤º$t$æ—¶åˆ»æ‰€æœ‰æ™ºèƒ½ä½“çš„è”åˆstateå’Œè”åˆactionã€‚ç»™å®šä¸€ä¸ªpolicy $\pi$ï¼Œå€¼å‡½æ•°è¡¨ç¤ºå½¢å¼å¦‚ä¸‹ï¼š<br>
$$V_t(\pi)=\sum</em>{\mathbf{s}_t,\mathbf{a}<em>t}P<sup>{\pi}(\mathbf{s}_t,\mathbf{a}_t|b_o,\pi)Q_t</sup>{\pi}(\mathbf{s}<em>t,\mathbf{a}<em>T)$$<br>
å…¶ä¸­$P<sup>{\pi}(\mathbf{s}_t,\mathbf{a}_t|b_o)=\sum_{\mathbf{s}_{1:t-1},\mathbf{a}_{1:t-1}}P</sup>{\pi}(\mathbf{s}</em>{1:t},\mathbf{a}</em>{1:t}|b_o)$æ˜¯policy $\pi$ä¸‹è”åˆstate $\mathbf{s}<em>t$ï¼Œå’Œè”åˆaction $\mathbf{a}<em>t$çš„åˆ†å¸ƒã€‚å€¼å‡½æ•°$Q_t^{\pi}(\mathbf{s}<em>t,\mathbf{a}<em>t)$çš„è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>
$$Q_t^{\pi}(\mathbf{s}<em>t,\mathbf{a}<em>t) = r_t(\mathbf{s}<em>t,\mathbf{a}<em>t)+\sum</em>{\mathbf{s}</em>{t+1},\mathbf{a}</em>{t+1})}P<sup>{\pi}(\mathbf{s}_{t+1},\mathbf{a}_{t+1}|\mathbf{s}_t,\mathbf{a}_t))Q_{t+1}</sup>{\pi}(\mathbf{s}</em>{t+1},\mathbf{a}</em>{t+1})$$<br>
æ¥ä¸‹æ¥ä»‹ç»ä»¥ä¸‹CDec-POMDPçš„ç­–ç•¥æ¢¯åº¦ç†è®ºï¼š<br>
<strong>å®šç†1.</strong> å¯¹äºä»»ä½•CDec-POMDPï¼Œç­–ç•¥æ¢¯åº¦è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<br>
$$\Delta</em>{\theta}V_1(\pi)=\sum</em>{t=1}<sup>HE_{\mathbf{s}_t,\mathbf{a}_t)|b_o,\pi}\left[Q_t</sup>{\pi}(\mathbf{s}<em>t,\mathbf{a}<em>t)\sum</em>{i\in S,j\in A}n_t(i,j)\Delta</em>{\theta}log\pi</em>{t}(j|i,o(i,\mathbf{n}</em>{s_t}))\right]$$<br>
è¿™ä¸ªå®šç†çš„è¯æ˜å’Œå…¶ä»–åç»­ç»“æœåœ¨é™„å½•ä¸­ã€‚<br>
æ³¨æ„ç”±äºè®¸å¤šåŸå› åˆ©ç”¨ä¸Šè¿°ç»“æœè®¡ç®—ç­–ç•¥æ¢¯åº¦æ˜¯ä¸åˆ‡å®é™…çš„ã€‚è”åˆstate-action $\mathbf{a}_t,\mathbf{s}_t$ç©ºé—´æ˜¯ç»„åˆçš„ã€‚è€ƒè™‘åˆ°æ™ºèƒ½ä½“çš„ä¸ªæ•°å¯èƒ½æœ‰å¾ˆå¤šä¸ªï¼Œå¯¹æ¯ä¸€ä¸ªæ™ºèƒ½ä½“çš„è½¨è¿¹è¿›è¡Œé‡‡æ ·æ˜¯è®¡ç®—ä¸Šä¸å¯è¡Œçš„ã€‚ä¸ºäº†è¡¥æ•‘ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥ä¼šå±•ç¤ºç±»ä¼¼policyè¯„ä¼°ç›´æ¥å¯¹è®¡æ•°å™¨$\mathbf{n}~P(\mathbf{n};\pi)$è¿›è¡Œé‡‡æ ·è®¡ç®—æ¢¯åº¦ã€‚ç±»ä¼¼çš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç»éªŒå›æŠ¥ä½œä¸ºåŠ¨ä½œå€¼å‡½æ•°$Q_t<sup>{\pi}(\mathbf{s}_t,\mathbf{a}_t)$çš„ä¸€ä¸ªè¿‘ä¼¼ä¼°è®¡ã€‚è¿™æ˜¯æ ‡å‡†çš„REINFORCEç®—æ³•åœ¨CDec-POMDPä¸Šçš„åº”ç”¨ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼ŒREINFORCEå¯èƒ½æ¯”å…¶ä»–ä½¿ç”¨å­¦ä¹ çš„åŠ¨ä½œå€¼å‡½æ•°çš„æ–¹æ³•å­¦ä¹ çš„æ…¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ª$Q_t</sup>{\pi}$çš„è¿‘ä¼¼å‡½æ•°ï¼Œå±•ç¤ºäº†ç›´æ¥é‡‡æ ·è®¡æ•°å™¨$\mathbf{n}$æ¥è®¡ç®—ç­–ç•¥æ¢¯åº¦ã€‚</p>
<h3 id="ä½¿ç”¨ä¼°è®¡åŠ¨ä½œå€¼å‡½æ•°çš„ç­–ç•¥æ¢¯åº¦">ä½¿ç”¨ä¼°è®¡åŠ¨ä½œå€¼å‡½æ•°çš„ç­–ç•¥æ¢¯åº¦</h3>
<p>ä¼°è®¡åŠ¨ä½œå€¼å‡½æ•°$Q_t^{\pi}(\mathbf{s}<em>t,\mathbf{a}<em>t)$æœ‰å‡ ç§ä¸åŒçš„æ–¹å¼ã€‚æˆ‘ä»¬è€ƒè™‘ä¸‹åˆ—ç‰¹å¾å½¢å¼çš„è¿‘ä¼¼å€¼å‡½æ•°$f_w$ï¼š<br>
$$Q_t^{\pi}(\mathbf{s}<em>t,\mathbf{a}<em>t)\approx f_w(\mathbf{s}<em>t,\mathbf{a}<em>t)=\sum</em>{m=1}<sup>Mf_w</sup>m(s_t<sup>m,o(s_t</sup>m,\mathbf{n</em>{s_t}}),s_t^m)$$<br>
æ¯ä¸€ä¸ªæ™ºèƒ½ä½“méƒ½å®šä¹‰äº†ä¸€ä¸ª$f_w<sup>m$ï¼Œå®ƒçš„è¾“å…¥æ˜¯æ™ºèƒ½ä½“çš„å±€éƒ¨stateï¼Œactionå’Œobservationã€‚æ³¨æ„ä¸åŒçš„$f_w</sup>m$æ˜¯ç›¸å…³çš„ï¼Œå› ä¸ºå®ƒä»¬ä¾èµ–äºå…¬å…±çš„è®¡æ•°å™¨è¡¨$\mathbf{n}</em>{s_t}$ã€‚è¿™æ ·çš„ä¸€ç§åˆ†è§£æ–¹å¼æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒäº§ç”Ÿäº†æœ‰æ•ˆçš„ç­–ç•¥æ¢¯åº¦è®¡ç®—æ–¹å¼ã€‚æ­¤å¤–ï¼ŒCDec-POMDPä¸­ä¸€ç±»å¾ˆé‡è¦çš„è¿™ç§å½¢å¼çš„ä¼°è®¡å€¼å‡½æ•°æ˜¯å…¼å®¹å€¼å‡½æ•°æœ€åä¼šäº§ç”Ÿä¸€ä¸ªæ— åçš„ç­–ç•¥æ¢¯åº¦ã€‚<br>
<strong>å‘½é¢˜1</strong> CDec-POMDPä¸­çš„å…¼å®¹å€¼å‡½æ•°å¯ä»¥åˆ†è§£æˆï¼š<br>
$$f_w(\mathbf{s}<em>t\mathbf{a}<em>t) = \sum_mf_w<sup>m(s_t</sup>m,o(s_t<sup>m,\mathbf{n}_{s_t}),a</sup>m)$$<br>
æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ä¼°è®¡å€¼å‡½æ•°$f_w$å–ä»£$Q^{\pi}(\cdot)$ã€‚ç»éªŒä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬å‘ç°ä½¿ç”¨è¿™ä¸ªä¼°è®¡çš„æ–¹å·®å¾ˆå¤§ã€‚æˆ‘ä»¬åˆ©ç”¨$f_w$çš„ç»“æ„è¿›ä¸€æ­¥åˆ†è§£ç­–ç•¥æ¢¯åº¦ä¼šæœ‰æ›´å¥½çš„æ•ˆæœã€‚<br>
<strong>å®šç†2</strong> å¯¹äºä»»ä½•å…·æœ‰å¦‚ä¸‹çš„åˆ†è§£çš„å€¼å‡½æ•°ï¼š<br>
$$f_w(\mathbf{s}<em>t\mathbf{a}<em>t) = \sum_mf_w<sup>m(s_t</sup>m,o(s_t<sup>m,\mathbf{n}_{s_t}),a</sup>m)$$<br>
ç­–ç•¥æ¢¯åº¦å¯ä»¥å†™æˆï¼š<br>
$$\Delta</em>{\theta}V_1(\pi)=\sum</em>{t=1}<sup>HE_{\mathbf{s}_t,\mathbf{a}_t)|b_o,\pi}\left[\sum_m\Delta_{\theta}log\pi(a_t</sup>m|s_t<sup>m,o(s_t</sup>m,\mathbf{n}</em>{s_t}))f_w<sup>m(s_t</sup>m,o(s_t<sup>m,\mathbf{n}_{s_t}),a_t</sup>m)\right]$$<br>
ä¸Šè¿°ç»“æœå±•ç¤ºäº†å¦‚æœä¼°è®¡å€¼å‡½æ•°è¢«åˆ†è§£äº†ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç­–ç•¥æ¢¯åº¦ä¹Ÿæ˜¯åˆ†è§£çš„ã€‚ä¸Šè¿°ç»“æœä¹Ÿå¯ä»¥åº”ç”¨åˆ°å¤šç§ç±»å‹çš„æ™ºèƒ½ä½“ä¸Šï¼Œåªè¦æˆ‘ä»¬å‡è®¾ä¸åŒçš„æ™ºèƒ½ä½“æœ‰ä¸åŒçš„å‡½æ•°$f_t^m$ã€‚æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„æ™ºèƒ½ä½“éƒ½æ˜¯ç›¸åŒç±»å‹çš„ï¼Œæ¯ä¸€ä¸ªæ™ºèƒ½ä½“éƒ½æœ‰ç›¸åŒçš„å‡½æ•°$f_w$ï¼Œæ¨æ–­å‡ºä¸‹å¼ï¼š<br>
$$f_w(\mathbf{s}<em>t,\mathbf{a}<em>t) = \sum</em>{i,j}n_t(i,j)f_w(i,j,o(i,\mathbf{n}</em>{s_t}))$$<br>
ä½¿ç”¨ä¸Šå¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç­–ç•¥æ¢¯åº¦ç®€åŒ–æˆï¼š<br>
$$\Delta</em>{\theta}V_1(\pi) = \sum_tE</em>{\mathbf{s}<em>t,\mathbf{a}<em>t}\left[\sum</em>{i,j}n_t(i,j)\Delta</em>{\theta}log\pi (j|i,o(i,\mathbf{n}</em>{s_t}))f_w(i,j,o(i,\mathbf{n}</em>{s_t}))\right]$$</p>
<h3 id="åŸºäºè®¡æ•°å™¨çš„ç­–ç•¥æ¢¯åº¦è®¡ç®—">åŸºäºè®¡æ•°å™¨çš„ç­–ç•¥æ¢¯åº¦è®¡ç®—</h3>
<p>æ³¨æ„åœ¨ä¸Šå¼ä¸­ï¼ŒæœŸæœ›ä»ç„¶å’Œè”åˆstateï¼Œactionï¼Œ$(\mathbf{s}<em>t,\mathbf{a}<em>t)$ç›¸å…³ï¼Œå½“æ™ºèƒ½ä½“çš„ä¸ªæ•°å¾ˆå¤§æ—¶æ•ˆç‡å¾ˆä½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜æ˜¯<br>
<strong>å®šç†3</strong> å¯¹äºä»»ä½•æ‹¥æœ‰å½¢å¼$f_w(\mathbf{s}<em>t,\mathbf{a}<em>t) = \sum</em>{i,j}n_t(i,j)f_w(i,j,o(i,\mathbf{n}</em>{s_t}))$çš„å€¼å‡½æ•°ï¼Œç­–ç•¥æ¢¯åº¦éƒ½å¯ä»¥ç”¨ä¸‹å¼è®¡ç®—ï¼š<br>
\begin{equation}<br>
E</em>{\mathbf{n}</em>{1:H}\in \Omega_{1:H}} \left[\sum_{t=1}^H\sum_{i\in S,j\in A}n_t(i,j) \Delta_{\theta}log\pi (j|i,o(i,\mathbf{n}_t)) f_w(i,j,o(i,\mathbf{n}<em>t))\right]<br>
\end{equation}<br>
ä¸Šè¿°ç»“æœå±•ç¤ºäº†ç­–ç•¥æ¢¯åº¦å¯ä»¥ç±»ä¼¼äºè®¡ç®—policyçš„å€¼å‡½æ•°ä¸€æ ·é€šè¿‡ä»åº•å±‚åˆ†å¸ƒ$P(\cdot)$ä¸­é‡‡æ ·è®¡æ•°è¡¨å‘é‡$\mathbf{n}</em>{1:H}$æ¥è®¡ç®—ç­–ç•¥æ¢¯åº¦ï¼Œåœ¨æ™ºèƒ½ä½“æ•°é‡å¾ˆå¤§çš„æƒ…å†µä¸‹ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚</p>
<h2 id="è®­ç»ƒåŠ¨ä½œå€¼å‡½æ•°">è®­ç»ƒåŠ¨ä½œå€¼å‡½æ•°</h2>
<p>åœ¨æˆ‘ä»¬çš„æ–¹æ³•ä¸­ï¼Œåœ¨è®¡æ•°å™¨æ ·æœ¬$\mathbf{n}<em>{1:H}$ç”Ÿæˆç”¨æ¥è®¡ç®—ç­–ç•¥æ¢¯åº¦åï¼Œæˆ‘ä»¬è¿˜éœ€è¦è°ƒæ•´critic $f_w$çš„å‚æ•°ã€‚æ³¨æ„å¯¹äºæ¯ä¸€ä¸ªåŠ¨ä½œå€¼å‡½æ•°$f_w(\mathbf{s}<em>t,\mathbf{a}<em>t)$åªå–å†³äºè”åˆstateï¼Œaction $(\mathbf{s}<em>t,\mathbf{a}<em>t)$ç”Ÿæˆçš„è®¡æ•°å™¨ã€‚è®­ç»ƒ$f_w$å¯ä»¥é€šè¿‡ä¸€ä¸ªæ¢¯åº¦æ­¥æœ€ä¸‹åŒ–ä¸‹åˆ—losså‡½æ•°å®ç°ï¼š<br>
\begin{equation}<br>
min_w\sum</em>{\xi=1}<sup>K\sum_{t=1}</sup>H\left(f_w(\mathbf{n}<em>t<sup>{\xi})-R_t</sup>{\xi}\right)^2<br>
\end{equation}<br>
å…¶ä¸­$\mathbf{n}</em>{1:H}<sup>{\xi}$æ˜¯ä»åˆ†å¸ƒ$P(\mathbf{n};\pi)$ä¸­ç”Ÿæˆçš„ä¸€ä¸ªè®¡æ•°å™¨æ ·æœ¬ï¼›$f_w(\mathbf{n}_t</sup>{\xi})$æ˜¯åŠ¨ä½œå€¼å‡½æ•°ï¼Œ$R_t^{\xi}$æ˜¯ç”¨å¼å­$(1)$è®¡ç®—çš„$t$æ—¶åˆ»çš„æ‰€æœ‰ç»éªŒå›æŠ¥ï¼š<br>
\begin{equation}<br>
f_w(\mathbf{n}<em>t^{\xi}) = \sum</em>{i,j}n_t<sup>{\xi}(i,j)f_w(i,j,o(i,\mathbf{n}_t</sup>{\xi});R_t<sup>{\xi}=\sum_{T=t}</sup>H]\sum</em>{i\in S,j\in A}n_T{\xi}(i,j)r_T(i,j,\mathbf{n}<em>T^{\xi})<br>
\end{equation}<br>
ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç°å…¬å¼$(11)$ä¸­çš„losså‡½æ•°åœ¨è®­ç»ƒè¾ƒå¤§é—®é¢˜çš„criticæ—¶è¡¨ç°å¹¶ä¸å¥½ã€‚éœ€è¦ä¸€å®šæ•°é‡çš„è®¡æ•°å™¨æ ·æœ¬å¯é çš„è®­ç»ƒ$f_w$ï¼Œè¿™å¯¹äºæ‹¥æœ‰è¾ƒå¤šæ•°é‡æ™ºèƒ½ä½“çš„å¤§é—®é¢˜çš„æ‰©å±•æœ‰ä¸åˆ©å½±å“ã€‚å·²çŸ¥åœ¨å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ ä¸­å•ç‹¬åˆ©ç”¨å…¨å±€rewardä¿¡å·çš„ç®—æ³•è¦æ¯”åˆ©ç”¨å±€éƒ¨rewardä¿¡å·çš„æ–¹æ³•å¤šç”¨ä¸€äº›æ ·æœ¬ã€‚å—åˆ°è¿™äº›ç°è±¡çš„å¯å‘ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªåŸºäºç­–ç•¥çš„å±€éƒ¨rewardä¿¡å·å»è®­ç»ƒcritic $f_w$ã€‚<br>
<strong>å•ä¸ªå€¼å‡½æ•°</strong> ç”¨$\mathbf{n}</em>{1:H}<sup>{\xi}$è¡¨ç¤ºä¸€ä¸ªè®¡æ•°å™¨æ ·æœ¬ã€‚ç»™å®šè®¡æ•°å™¨æ ·æœ¬$\mathbf{n}_{1:H}</sup>{\xi}$ï¼Œç”¨$V_t<sup>{\xi}(i,j)=E\left[\sum_{tâ€™=t}</sup>Hr</em>{tâ€™}<sup>m|s_t</sup>m=i,a_m<sup>t=j,n_{1:H}</sup>{\xi}\right]$è¡¨ç¤ºä¸€ä¸ªæ™ºèƒ½ä½“åœ¨æ—¶åˆ»$t$å¤„äºstate $i$ï¼Œé‡‡å–action $j$ï¼Œæ‰€èƒ½å¾—åˆ°çš„æ‰€æœ‰æœŸæœ›rewardã€‚è¿™ä¸ªå•ä¸ªçš„å€¼å‡½æ•°å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•æ¥è®¡ç®—ã€‚åŸºäºè¿™ä¸ªå€¼å‡½æ•°ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å±•ç¤ºäº†å¼å­$(12)$ä¸­å…¨å±€ç»éªŒrewardçš„é‡æ–°å‚æ•°åŒ–ï¼š<br>
<strong>å¼•ç†(Lemma)1</strong> ç»™å®šè®¡æ•°å™¨æ ·æœ¬$\mathbf{1:H}<sup>{\xi}$ï¼Œ$t$æ—¶åˆ»çš„ç»éªŒå›æŠ¥$R_t</sup>{\xi}$å¯ä»¥è¢«é‡æ–°å‚æ•°åŒ–ä¸ºï¼š<br>
$$R_t^{\xi} = \sum</em>{i\in S,j\in A}n_t<sup>{\xi}(i,j)V_t</sup>{\xi}(i,j).$$<br>
<strong>åŸºäºå•ä¸ªå€¼å‡½æ•°çš„loss</strong> ç»™å‡ºå¼•ç†$1$ï¼Œæˆ‘ä»¬æ¨å¯¼å‡ºå¼å­$11$ä¸­çœŸå®lossçš„ä¸Šç•Œï¼Œå®ƒæœ‰æ•ˆåˆ©ç”¨äº†å•ä¸ªå€¼å‡½æ•°ï¼š<br>
\begin{align*}<br>
&amp;\sum</em>{\xi}\sum_t\left(f_w(\mathbf{n}<sup>{\xi})-R_t</sup>{\xi}\right)^2 \<br>
= &amp;\sum_{\xi}\sum_t\left(\sum_{i,j}n_t<sup>{\xi}(i,j)f_w(i,j,o(i,\mathbf{n}_t</sup>{\xi}))-\sum_{i,j}n_t<sup>{\xi}(i,j)V_t</sup>{\xi}(i,h)\right)^2\<br>
= &amp;\sum_{\xi}\sum_t\left( \sum_{i,j}n_t<sup>{\xi}(i,j)(f_w(i,j,o(i,\mathbf{n}_t</sup>{\xi}))-V_t<sup>{\xi}(i,h))\right)</sup>2\<br>
\le &amp;M\sum_{\xi}\sum_{t,i,j}n_t(i,j)\left(f_w(i,j,o(i,\mathbf{n}_t<sup>{\xi}))-V_t</sup>{\xi}(i,j)\right)^2<br>
\end{align*}<br>
å…¶ä¸­æœ€åä¸€éƒ¨ç”¨äº†æŸ¯è¥¿æ–½ç“¦èŒ¨ä¸ç­‰å¼ã€‚æˆ‘ä»¬ç”¨å¼å­(14)ä¸­ä¿®æ”¹è¿‡çš„lossè®­ç»ƒcriticã€‚æŒ‰ç…§ç»éªŒæ¥è¯´ï¼Œå¯¹äºè¾ƒå¤§çš„é—®é¢˜ï¼Œå¼å­(14)ä¸­çš„æ–°lossæ¯”å¼å­(13)ä¸­çš„åŸå§‹lossè¦æ”¶æ•›çš„å¿«å¾ˆå¤šã€‚ç›´è§‚ä¸Šæ¥è¯´ï¼Œè¿™æ˜¯å› ä¸ºå¼å­(14)ä¸­çš„æ–°losså°è¯•è°ƒæ•´æ¯ä¸€ä¸ªcriticç»„ä»¶$f_w(i,j,o(i,\mathbf{n}_t<sup>{\xi}))$æ›´æ¥è¿‘å®ƒçš„ç»éªŒå›æŠ¥$V_t</sup>{\xi}(i,j)$ã€‚ç„¶è€Œï¼ŒåŸå§‹çš„å¼å­(13)ä¸­çš„lossç€é‡äºæœ€å°åŒ–å…¨å±€lossï¼Œè€Œä¸æ˜¯è°ƒæ•´æ¯ä¸€ä¸ªå•ä¸ªçš„criticå› å­$f_w(\cdot)$åˆ°ç›¸å¯¹åº”çš„æ¯ä¸€ä¸ªç»éªŒå›æŠ¥ã€‚<br>
ç®—æ³•$1$å±•ç¤ºäº†CDec-POMDPä¸­ACç®—æ³•çš„å¤§çº²ã€‚ç¬¬$7$è¡Œå’Œç¬¬$8$è¡Œå±•ç¤ºäº†ä¸¤ç§ä¸åŒçš„æ–¹å¼è®­ç»ƒcriticã€‚ç¬¬$7$è¡Œä»£è¡¨åŸºäºå±€éƒ¨å€¼å‡½æ•°çš„criticæ›´æ–°ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºfactored cirticæ›´æ–°(fC)ã€‚ç¬¬$8$è¡Œå±•ç¤ºäº†åŸºäºå…¨å±€rewardæˆ–è€…å…¨å±€criticçš„æ›´æ–°Â©ã€‚ç¬¬$10$è¡Œå±•ç¤ºäº†ä½¿ç”¨å®šç†$2$(fA)è®¡ç®—çš„ç­–ç•¥æ¢¯åº¦ã€‚ç¬¬$11$è¡Œå±•ç¤ºäº†ç›´æ¥ä½¿ç”¨$f_w$è®¡ç®—çš„æ¢¯åº¦ã€‚</p>
<h2 id="å®éªŒ">å®éªŒ</h2>
<p>è¿™ä¸€èŠ‚ä¸­æ¯”è¾ƒäº†æˆ‘ä»¬çš„ACç®—æ³•å’Œå¦å¤–ä¸¤ä¸ªè§£å†³CDec-POMDPé—®é¢˜çš„ç®—æ³•ï¼ŒSoft-Max based flow update(SMFU)ï¼Œå’ŒæœŸæœ›æœ€å¤§åŒ–æ–¹æ³•ã€‚SMFUåªèƒ½ä¼˜åŒ–æ™ºèƒ½ä½“çš„actionä¾èµ–äºå±€éƒ¨stateçš„policyï¼Œ$\pi(a_t<sup>m|s_t</sup>m)$ï¼Œå› ä¸ºå®ƒé€šè¿‡è®¡ç®—åœ¨è§„åˆ’é˜¶æ®µå•ä¸ªæœ€æœ‰å¯èƒ½çš„è®¡æ•°å™¨å‘é‡æ¥ä¼°è®¡è®¡æ•°å™¨$\mathbf{n}$çš„ä½œç”¨ã€‚EMæ–¹æ³•ä¼˜åŒ–åŸºäºè®¡æ•°å™¨çš„åˆ†æ®µçº¿æ€§policyï¼Œå…¶ä¸­$\pi(a_t<sup>m|s_t</sup>m,\cdot)$æ˜¯æ‰€æœ‰å¯èƒ½çš„è®¡æ•°å™¨observation $o_t$ç©ºé—´ä¸Šçš„ä¸€ä¸ªåˆ†æ®µå‡½æ•°ã€‚<br>
ç®—æ³•$1$å±•ç¤ºäº†æ›´æ–°criticçš„ä¸¤ç§æ–¹å¼ï¼ˆç¬¬$7$è¡Œå’Œç¬¬$8$è¡Œï¼‰å’Œæ›´æ–°actorçš„ä¸¤ç§æ–¹å¼ï¼ˆç¬¬$10$è¡Œå’Œç¬¬$11$è¡Œï¼‰ï¼Œæ‰€ä»¥å°±æœ‰å››ç§å¯èƒ½çš„ACæ–¹æ³•ï¼fAfC,AC,FfC,fACã€‚æˆ‘ä»¬ä¹Ÿç ”ç©¶äº†ä¸åŒactor-criticæ–¹æ³•çš„å±æ€§ã€‚åœ¨é™„å½•ä¸­æœ‰ç¥ç»ç½‘ç»œçš„ç»“æ„å’Œå…¶ä»–ä¸€äº›å®éªŒè®¾ç½®ã€‚<br>
ä¸ºäº†å’Œä¹‹å‰æ–¹æ³•å…¬å¹³çš„è¿›è¡Œæ¯”è¾ƒï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸‰ç§ä¸åŒçš„æ¨¡å‹ç”¨äºåŸºäºè®¡æ•°çš„observation $o_t$ã€‚åœ¨$o0$è®¾ç½®ä¸­ï¼Œpolicyåªå–å†³äºæ™ºèƒ½ä½“çš„å±€éƒ¨state $s_t^m$å¹¶ä¸éœ€è¦è®¡æ•°å™¨ã€‚åœ¨$o1$è®¾ç½®ä¸­ï¼Œpolicyå–å†³äºå±€éƒ¨state $s_t^m$å’Œå•ä¸ªè®¡æ•°å™¨observation $n_t(s_t<sup>m)$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ™ºèƒ½ä½“åªèƒ½è§‚æµ‹åˆ°å…¶ä»–ä¹Ÿåœ¨å½“å‰çŠ¶æ€$s_t</sup>m$çš„æ™ºèƒ½ä½“çš„è®¡æ•°å™¨ã€‚åœ¨$oN$è®¾ç½®ä¸­ï¼Œæ™ºèƒ½ä½“èƒ½è§‚æµ‹åˆ°å®ƒçš„å±€éƒ¨state $s_t<sup>m$å’Œå½“å‰çŠ¶æ€$s_t</sup>m$çš„å±€éƒ¨ç›¸é‚»çŠ¶æ€å†…å…¶ä»–æ™ºèƒ½ä½“çš„è®¡æ•°å™¨ã€‚$oN$ observationæ¨¡å‹æä¾›ç»™æ™ºèƒ½ä½“æœ€å¤šçš„ä¿¡æ¯ã€‚ç„¶è€Œï¼Œå®ƒä¹Ÿæ˜¯æœ€éš¾ä¼˜åŒ–çš„å› ä¸ºpolicyæœ‰æ›´å¤šçš„å‚æ•°ã€‚SMFUæ–¹æ³•åªèƒ½åœ¨$o0$è®¾ç½®ä¸­èµ·ä½œç”¨ï¼ŒEMæ–¹æ³•å’Œæœ¬æ–‡ä¸­çš„ACæ–¹æ³•åœ¨æ‰€æœ‰è®¾ç½®ä¸­éƒ½èƒ½èµ·ä½œç”¨ã€‚</p>
<!--
**å‡ºç§Ÿè½¦è°ƒåº¦** æˆ‘ä»¬åœ¨ç¬¬äºŒèŠ‚ä¸­ä»‹ç»çš„ç°å®ä¸–ç•Œä¸­çš„åŸŸæµ‹è¯•äº†æœ¬æ–‡çš„æ–¹æ³•ã€‚åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œç›®æ ‡æ˜¯è®¡ç®—å‡ºç§Ÿè½¦policyä¼˜åŒ–æ•´ä¸ªè½¦é˜Ÿçš„æ”¶å…¥ã€‚æ•°æ®åŒ…å«äºšæ´²ä¸€ä¸ªå¤§åŸå¸‚è¶…è¿‡ä¸€å¹´çš„å‡ºç§Ÿè½¦è½¨è¿¹æ•°æ®ã€‚æˆ‘ä»¬ä½¿ç”¨äº†ä»æ•°æ®é›†ä¸­æå–åˆ°çš„è½¦è¾†è¯·æ±‚ä¿¡æ¯ã€‚å¹³å‡æ¥è¯´ï¼Œæ¯å¤©å¤§æ¦‚æœ‰$8000$è¾†å‡ºç§Ÿè½¦ã€‚æ•´ä¸ªåŸå¸‚è¢«åˆ’åˆ†ä¸º$81$ä¸ªç©ºé—´ï¼Œæ—¶é—´èŒƒå›´æ˜¯$24$ä¸ªå°æ—¶åˆ’åˆ†ä¸º$48$ä¸ªåŠå°æ—¶çš„åŒºé—´ã€‚
å›¾$2(a)$ä¸­å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨ä¸åŒçš„è§‚æµ‹æ¨¡å‹ï¼ˆ$'o0','o1','oN'$)ä¸Šçš„é‡åŒ–æ¯”è¾ƒã€‚æˆ‘ä»¬æµ‹è¯•äº†$4000$å’Œ$8000$è¾†å‡ºç§Ÿè½¦æ¥éªŒè¯æ˜¯å¦å‡ºç§Ÿè½¦çš„æ•°é‡ä¼šå½±å“ä¸åŒæ–¹æ³•çš„æ€§èƒ½ã€‚$y$è½´å±•ç¤ºäº†æ•´ä¸ªè½¦é˜Ÿæ¯å¤©çš„åˆ©æ¶¦ã€‚åœ¨$'o0'$è®¾ç½®ä¸‹ï¼Œæ‰€æœ‰çš„æ–¹æ³•ï¼ˆfAfC-$o0$,SMFU,EM-$o0$ï¼‰ç»™å‡ºè´¨é‡å·®ä¸å¤šçš„è§£ï¼Œåœ¨$8000$ä¸ªå‡ºç§Ÿè½¦ä¸ŠfAfC-$o0$å’ŒEM-$o0$è¡¨ç°çš„æ¯”SMFUç¨å¾®å¥½ä¸€äº›ã€‚åœ¨$'o1'$è®¾ç½®ä¸‹ï¼Œ
-->

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/01/21/em/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/21/em/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">EM(Expectation Maximization)ç®—æ³•</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-21 10:22:45" itemprop="dateCreated datePublished" datetime="2019-01-21T10:22:45+08:00">2019-01-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-21 11:18:34" itemprop="dateModified" datetime="2019-05-21T11:18:34+08:00">2019-05-21</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/æœºå™¨å­¦ä¹ /" itemprop="url" rel="index"><span itemprop="name">æœºå™¨å­¦ä¹ </span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å¼•è¨€-introduction">å¼•è¨€(Introduction)</h2>
<h3 id="ä»€ä¹ˆæ˜¯æœŸæœ›æœ€å¤§åŒ–ç®—æ³•">ä»€ä¹ˆæ˜¯æœŸæœ›æœ€å¤§åŒ–ç®—æ³•</h3>
<p>æœŸæœ›æœ€å¤§åŒ–ç®—æ³•(Expectation Maximization,EM)ï¼Œæ˜¯åˆ©ç”¨å‚æ•°ä¼°è®¡çš„è¿­ä»£æ³•æ±‚è§£æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„ä¸€ç§æ–¹æ³•ã€‚</p>
<h3 id="emå’Œmleå…³ç³»">EMå’ŒMLEå…³ç³»</h3>
<p>MLEçš„ç›®æ ‡æ˜¯æ±‚è§£å·²çŸ¥åˆ†å¸ƒç±»å‹çš„å•ä¸ªåˆ†å¸ƒçš„å‚æ•°ã€‚<br>
EMçš„ç›®æ ‡æ˜¯æ±‚è§£å·²çŸ¥åˆ†å¸ƒç±»å‹çš„å¤šä¸ªæ··åˆåˆ†å¸ƒçš„å‚æ•°ã€‚<br>
ä¸€èˆ¬æˆ‘ä»¬ç”¨åˆ°çš„æå¤§ä¼¼ç„¶ä¼°è®¡éƒ½æ˜¯æ±‚æŸç§å·²çŸ¥åˆ†å¸ƒç±»å‹çš„å•ä¸ªåˆ†å¸ƒçš„å‚æ•°ï¼Œå¦‚æ±‚é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ï¼›è€ŒEMç®—æ³•æ˜¯ç”¨æ¥æ±‚è§£å·²çŸ¥åˆ†å¸ƒç±»å‹ï¼Œå¤šä¸ªè¯¥å·²çŸ¥ç±»å‹åˆ†å¸ƒçš„æ··åˆåˆ†å¸ƒçš„å‚æ•°ï¼Œè¿™å¥è¯å¬èµ·æ¥å¯èƒ½æœ‰äº›æ‹—å£ï¼Œä¸¾ä¸ªæœ€å¸¸è§çš„ä¾‹å­ï¼Œé«˜æ–¯æ··åˆåˆ†å¸ƒå‚æ•°çš„æ±‚è§£ï¼Œè¿™ä¸ªæ··åˆåˆ†å¸ƒéƒ½æ˜¯é«˜æ–¯åˆ†å¸ƒï¼Œåªæ˜¯æ¯ä¸ªåˆ†å¸ƒçš„å‚æ•°ä¸åŒè€Œå·²ã€‚å¦‚æœä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒï¼Œä¸€ä¸ªå¡æ–¹åˆ†å¸ƒæ˜¯æ²¡æœ‰åŠæ³•æ±‚è§£çš„ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆå«å®ƒemç®—æ³•">ä¸ºä»€ä¹ˆå«å®ƒEMç®—æ³•</h3>
<p>å› ä¸ºè¿™ä¸ªç®—æ³•æ€»å…±æœ‰ä¸¤ä¸ªè¿­ä»£æ­¥éª¤ï¼ŒEæ­¥å’ŒMæ­¥ã€‚ç¬¬ä¸€æ­¥æ˜¯å¯¹å¤šä¸ªåˆ†å¸ƒæ±‚æœŸæœ›ï¼Œå›ºå®šæ¯ä¸€ä¸ªåˆ†å¸ƒçš„å‚æ•°ï¼Œè®¡ç®—å‡ºæ··åˆåˆ†å¸ƒçš„å‚æ•°ï¼Œå³Eæ­¥ï¼Œç¬¬äºŒæ­¥æ˜¯å¯¹è¿™ä¸ªæ··åˆåˆ†å¸ƒåˆ©ç”¨æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ–¹æ³•è¿›è¡Œå‚æ•°ä¼°è®¡ï¼Œå³Mæ­¥ã€‚</p>
<h2 id="æ¨ç†è¿‡ç¨‹">æ¨ç†è¿‡ç¨‹</h2>
<p>å‡è®¾æˆ‘ä»¬è¦æ±‚ä¸€ä¸ªæ··åˆåˆ†å¸ƒpçš„å‚æ•°$\theta$ï¼Œæ¯”å¦‚æ ¡å›­å†…ç”·ç”Ÿå’Œå¥³ç”Ÿçš„èº«é«˜å‚æ•°ï¼Œæ˜¾ç„¶ï¼Œç”·ç”Ÿå’Œå¥³ç”Ÿçš„èº«é«˜æœä»çš„åˆ†å¸ƒç±»å‹æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å‚æ•°æ˜¯ä¸ä¸€æ ·çš„ã€‚è¿™é‡Œé€šè¿‡å¼•å…¥ä¸€ä¸ªéšå˜é‡$z$ï¼Œæ±‚è§£å‡ºå¯¹åº”ä¸åŒ$z$å–å€¼çš„å‚æ•°$\theta$çš„å€¼ã€‚<br>
\begin{align*}<br>
p(x|\theta) &amp;= \sum_zp(x,z|\theta)\\<br>
&amp;=\sum_zp(z|\theta)p(x|\theta, z) \tag{0}<br>
\end{align*}<br>
å¦‚æœæˆ‘ä»¬å‡è®¾ç”·å¥³ç”Ÿçš„èº«é«˜åˆ†å¸ƒæ˜¯ä¸€ä¸ªé«˜æ–¯æ··åˆæ¨¡å‹ï¼Œç°åœ¨è¦æ±‚å®ƒçš„å‚æ•°$\theta$ã€‚æ··åˆæ¨¡å‹çš„è¡¨è¾¾å¼å¯ä»¥å†™ä¸ºï¼š<br>
\begin{align*}<br>
p(x|\theta) &amp;= \sum_zw(z)N(x|\mu_z,\sigma_z)\\<br>
&amp;=\sum_zp(z|\theta)p(x|\theta,z)<br>
\end{align*}<br>
å…¶ä¸­$\sum_zw(z) = 1,\theta={w, \mu, \sigma}$ï¼Œå¦‚æœç”¨æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ¥è§£è¯¥é—®é¢˜çš„è¯ï¼Œlogå‡½æ•°å†…æœ‰å’Œå¼ï¼Œä¸å¥½ä¼˜åŒ–ï¼Œæ‰€ä»¥å°±è¦æ¢ç§æ–¹æ³•ã€‚<br>
è§‚æµ‹æ•°æ®ï¼š$x=(x_1,\cdots, x_N)$<br>
å¯¹åº”çš„éšå˜é‡ï¼š$z=(z_1,\cdots, z_N)$ï¼Œ$z_i$æœ‰$c$ç§å–å€¼ã€‚</p>
<p>\begin{align*}<br>
l(\theta;x) &amp;= log p(x|\theta) \tag{1}\\<br>
&amp;= log\prod_{i=1}^N\ p(x_i|\theta) \tag{2}\\<br>
&amp;= \sum_{i=1}^Nlog\ p(x_i|\theta) \tag{3}\\<br>
&amp;= \sum_{i=1}^Nlog\sum_zp(x_i,z|\theta) \tag{4}\\<br>
\end{align*}<br>
è¿™é‡Œå¼å­(4)ä¸­$\sum_zp(x,z|\theta)$è¯¥æ€ä¹ˆå˜å½¢ï¼Œå› ä¸ºç°åœ¨è§£ä¸å‡ºæ¥äº†ã€‚<br>
æœ€å¼€å§‹æˆ‘æƒ³çš„æ˜¯ä½¿ç”¨æ¡ä»¶æ¦‚ç‡è¿›è¡Œå±•å¼€ï¼Œå³ï¼š<br>
$$\sum_zp(x_i, z|\theta) = \sum_zp(x_i|z, \theta)p(z|\theta)$$<br>
ä½†æ˜¯å¦‚æœå±•å¼€æˆè¿™æ ·å­ï¼Œå°±å˜æˆäº†æ–‡ç« å¼€å¤´ç»™å‡ºçš„å¼å­(0)ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œä¸èƒ½ç»§ç»­åŒ–ç®€äº†ã€‚<br>
æ‰€ä»¥å°±å¯¹å¼å­(4)åšä¸ªå˜å½¢<br>
\begin{align*}<br>
&amp;\ \ \ \ \sum_{i=1}^Nlog\sum_zp(x_i,z|\theta) \tag{4}\\<br>
&amp;= \sum_{i=1}^Nlog\sum_zq(z|x_i)\frac{p(x_i,z|\theta)}{q(z|x_i)}, \ \ s.t.\sum_zq(z|x_i)=1 \tag{5}\\<br>
&amp;\ge \sum_{i=1}^N \underbrace{\sum_zq(z|x_i)log\frac{p(x_i,z|\theta)}{q(z|x_i)}}_{L(q,\theta)},\ \ s.t. \sum_zq(z|x_i)=1 \tag{6}\\<br>
\end{align*}<br>
ç¬¬(4)æ­¥åˆ°ç¬¬(5)æ­¥å¼•å…¥äº†ä¸€ä¸ªåˆ†å¸ƒ$q(z|x)$ï¼Œå°±æ˜¯ç»™å®šä¸€ä¸ªè§‚æµ‹æ•°æ®$x$ï¼Œéšå˜é‡$z$å–å€¼çš„æ¦‚ç‡åˆ†å¸ƒã€‚æ³¨æ„ï¼Œ$q(z)$æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯ç»™å®š$x$ä¹‹åï¼Œ$q(z|x)$æ˜¯ä¸€ä¸ªå˜é‡ã€‚ç„¶åå› ä¸ºå˜å½¢ä¹‹åè¿˜æ˜¯æ²¡æœ‰æ±‚è§£ï¼Œå°±åˆ©ç”¨æ°æ£®ä¸ç­‰å¼åšäº†ç¼©æ”¾ï¼Œå°†$log(sum())$å˜æˆäº†$sum(log())$ï¼Œå°±å˜æˆäº†(6)å¼ã€‚<br>
è¿™é‡Œä½¿ç”¨Jensenä¸ç­‰å¼çš„ç›®çš„æ˜¯ä½¿å¾—ç¼©æ”¾åçš„å€¼è¿˜èƒ½å–å¾—å’ŒåŸå¼ç›¸ç­‰çš„å€¼ï¼Œé‡è¦çš„æ˜¯ç­‰å·èƒ½å¤Ÿå–åˆ°ã€‚</p>
<h3 id="jensenä¸ç­‰å¼">Jensenä¸ç­‰å¼</h3>
<p>å¯¹äºéšæœºå˜é‡çš„Jensenä¸ç­‰å¼ï¼Œå½“å‡½æ•°$f(x)$æ˜¯å‡¸å‡½æ•°çš„æ—¶å€™å¯ä»¥ç”¨ä¸‹å¼è¡¨ç¤ºï¼š<br>
$$f(E(x)) \le E(f(x))$$<br>
å½“$f(x)$æ˜¯å‡¹å‡½æ•°çš„æ—¶å€™ï¼Œæœ‰<br>
$$f(E(x)) \ge E(f(x))$$</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦æ±‚è§£ä½¿å¾—å¼å­(6)ä¸­æ°æ£®ä¸ç­‰å¼ç­‰å·æˆç«‹çš„$q$åˆ†å¸ƒçš„å–å€¼ã€‚è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ±‚è§£ã€‚</p>
<h3 id="æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•">æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•</h3>
<p>ä»¤<br>
$$L(q,\theta) = \sum_z q(z|x_i)log{\frac{p(x_i,z|\theta)}{q(z|x_i)}}, s.t.\sum q(z|x_i) = 1 \tag{7}$$<br>
æ„å»ºæ‹‰æ ¼æœ—æ—¥ç›®æ ‡å‡½æ•°ï¼š<br>
\begin{align*}<br>
L &amp;= L(q, \theta) + \lambda(\sum_zq(z|x)- 1) \tag{8}\\<br>
&amp;= \sum_z q(z|x_i)log{\frac{p(x_i,z|\theta)}{q(z|x_i)}} + \lambda(\sum_z q(z|x_i) - 1)  \tag{9}<br>
\end{align*}</p>
<p>å¯¹$L$æ±‚å¯¼ï¼Œå¾—åˆ°ï¼š<br>
$$\frac{\partial L}{\partial q(z|x_i)} = log\frac{p(x_i, z|\theta)}{q(z|x_i)} + q(z|x_i)(-\frac{1}{q(z|x_i)}) + \lambda \tag{10}$$<br>
ä»¤$\frac{\partial L}{\partial q(z|x_i)}$ç­‰äº$0$ï¼Œå¾—åˆ°ï¼š$$log\frac{p(x_i, z|\theta)}{q(z|x_i)} = 1 - \lambda$$<br>
ä¸¤è¾¹åŒå–$e$çš„å¯¹æ•°ï¼š<br>
$$\frac{p(x_i, z|\theta)}{q(z|x_i)} = e^{1-\lambda} \tag{11}$$<br>
$$q(z|x_i) = e^{\lambda - 1}p(x_i, z|\theta) \tag{12}$$<br>
ä¸¤è¾¹åŒæ—¶æ±‚å’Œå¾—ï¼š<br>
$$1 = e^{\lambda - 1}\sum_z p(x_i, z|\theta) \tag{13}$$<br>
ç”¨$p$è¡¨ç¤º$e^{\lambda-1}$å¾—åˆ°ï¼š<br>
$$e^{\lambda-1} = \frac{1}{\sum_z p(x_i, z|\theta)}$$<br>
å°†å…¶ä»£å…¥å¼å­(12)å¾—ï¼š<br>
\begin{align*}<br>
q(z|x_i) &amp;= \frac{p(x_i, z|\theta)}{\sum_z p(x_i, z|\theta)}\\<br>
&amp;= \frac{p(z, x_i|\theta)}{p(x_i|\theta)}\\<br>
&amp;= p(z|x_i, \theta)  \tag{14}<br>
\end{align*}</p>
<p>æœ€åæ±‚å‡ºæ¥$q(z|x_i) = p(z|x_i, \theta)$ã€‚</p>
<h3 id="æ°æ£®ä¸ç­‰å¼æˆç«‹æ¡ä»¶">æ°æ£®ä¸ç­‰å¼æˆç«‹æ¡ä»¶</h3>
<p>æ°æ£®ä¸ç­‰å¼æˆç«‹æ¡ä»¶æ˜¯å¸¸æ•°ï¼Œå³ï¼š<br>
$$\frac{p(x_i, z|\theta)}{q(z|x_i)} = c,  s.t. \sum q(z|x_i)=1 \tag{15}$$<br>
åˆ™æœ‰:<br>
$$p(x, z_i|\theta) = cq(z_i|x) \tag{16}$$<br>
åŒæ—¶å¯¹å¼å­å·¦å³ä¸¤è¾¹æ±‚å’Œï¼Œå¾—åˆ°ï¼š<br>
$$\sum p(x_i, z|\theta) = \sum cq(z|x_i) = c \tag{17}$$<br>
å°†$c = \sum p(x_i, z|\theta)$ä»£å…¥å¼å­(14)å¾—ï¼š<br>
\begin{align*}<br>
q(z|x_i) &amp;= \frac{p(x_i, z|\theta)}{\sum p(x_i,z|\theta)}\\<br>
&amp;= \frac{p(x_i, z)|\theta}{p(x_i|\theta)}\\<br>
&amp;= p(z|x_i, \theta) \tag{18}<br>
\end{align*}</p>
<h3 id="ç­‰å·æˆç«‹è¯æ˜">ç­‰å·æˆç«‹è¯æ˜</h3>
<p>ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•éƒ½ç®—å‡ºæ¥åœ¨$q(z|x_i) = p(z|x_i, \theta)$æ—¶$L$èƒ½å–å¾—æœ€å¤§å€¼ã€‚æ¥ä¸‹æ¥è¯æ˜è¿™ä¸ªè¿™ä¸ª$L$çš„æœ€å¤§å€¼å’Œ$l$ç›¸ç­‰ã€‚<br>
å°†$q = p(z|x_i, \theta)$ä»£å…¥$L(q, \theta)$å¾—ï¼š<br>
\begin{align*}<br>
L(q, \theta) &amp;= L(p(z|x_i, \theta^t), \theta^t)\\<br>
&amp;= \sum_z p(z|x_i, \theta^t) log\frac{p(z, x_i|\theta^t)}{p(z|x_i, \theta^t)} \\<br>
&amp;= \sum_z p(z|x_i, \theta^t) log p(x_i|\theta^t)\\<br>
&amp;= 1\cdot log p(x_i|\theta^t)\\<br>
&amp;= log p(x_i|\theta^t)\\<br>
&amp;= l(\theta^t; x_i)<br>
\end{align*}</p>
<h3 id="å¦ä¸€ç§ç­‰å·æˆç«‹æ¨å¯¼">å¦ä¸€ç§ç­‰å·æˆç«‹æ¨å¯¼</h3>
<p>\begin{align*}<br>
l(\theta; x) - L(q, \theta) &amp;= l(\theta; x_i) - \sum_z q(z|x_i) log{\frac{p(z, x_i|\theta)}{q(z|x_i)}}\\<br>
&amp;= \sum_z q(z|x_i) log p(x_i|\theta) - \sum_z q(z|x_i) log{\frac{p(z, x_i|\theta)}{q(z|x_i)}}\\<br>
&amp;= \sum_z q(z|x_i)log {\frac{p(x_i|\theta)q(z|x_i)}{p(z, x_i|\theta)}}\\<br>
&amp;= \sum_z q(z|x_i)log {\frac{q(z|x_i)}{p(z|x_i, \theta)}}\\<br>
&amp;= KL(q(z|x_i)||p(z|x_i,\theta))<br>
\end{align*}<br>
æœ€åç®—å‡ºæ¥ä¸¤ä¸ªå‡½æ•°ä¹‹å·®æ˜¯ä¸€ä¸ªKLæ•£åº¦ï¼Œæ˜¯ä»$p$åˆ°$q$çš„KLæ•£åº¦ã€‚å½“å‰ä»…å½“$p=q$æ—¶å–ç­‰ï¼Œå¦åˆ™å°±éè´Ÿã€‚</p>
<h3 id="mæ­¥">Mæ­¥</h3>
<p>\begin{align*}<br>
L(q, \theta) &amp; = \sum_z q(z|x_i) log\frac{p(z, x_i|\theta)}{q(z|x_i)} \\<br>
&amp; = \underbrace{\sum_z q(z|x_i)log{p(z, x_i|\theta)}}_{Expected\ complete\ log-likelyhood} - \underbrace{\sum_z q(z|x_i)l{q(z|x_i)}}_{Entropy}<br>
\end{align*}</p>
<h2 id="emæµç¨‹">EMæµç¨‹</h2>
<h3 id="è®¡ç®—æµç¨‹">è®¡ç®—æµç¨‹</h3>
<p>ï¼ˆï¼‘ï¼‰é¦–å…ˆéšæœºåˆå§‹åŒ–æ¨¡å‹çš„ä¸åŒéšå˜é‡å¯¹åº”çš„å‚æ•°ï¼Œ<br>
ï¼ˆï¼’ï¼‰å¯¹äºæ¯ä¸€ä¸ªè§‚æµ‹ï¼Œé¦–å…ˆåˆ¤æ–­å®ƒå¯¹åº”çš„éšå˜é‡çš„åˆ†å¸ƒã€‚<br>
ï¼ˆï¼“ï¼‰æ±‚æœŸæœ›<br>
ï¼ˆï¼”ï¼‰æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ±‚å‚æ•°<br>
ç”¨å…¬å¼æ¥è¡¨ç¤ºå¦‚ä¸‹ï¼š<br>
Eæ­¥ï¼š$q^{t+1} = arg\ max_q L(q, \theta^t)$<br>
Mæ­¥ï¼š$\theta^{t+1} = arg max_{\theta}L(q^{t+1}, \theta)$<br>
Eæ­¥å°±æ˜¯æ ¹æ®$t$æ—¶åˆ»çš„$\theta^t$åˆ©ç”¨æ¦‚ç‡$q$æ±‚å‡º$L$çš„æœŸæœ›ï¼Œç„¶åMæ­¥ä½¿ç”¨æœ€å¤§ä¼¼ç„¶ä¼°è®¡è®¡ç®—å‡ºæ–°çš„$\theta$ï¼Œå°±è¿™æ ·è¿­ä»£ä¸‹å»ã€‚</p>
<h2 id="emæ”¶æ•›æ€§åˆ†æ">EMæ”¶æ•›æ€§åˆ†æ</h2>
<p>EMç®—æ³•çš„æ”¶æ•›æ€§å°±æ˜¯è¦è¯æ˜$L(q=p(z|x_i, \theta^t) , \theta)$çš„å€¼ä¸€ç›´åœ¨å¢å¤§ã€‚<br>
\begin{align*}<br>
L(p(z|x_i, \theta^{t+1}) , \theta^{t+1}) - L(p(z|x_i, \theta^{t}) , \theta^{t}) &amp;= log p(x_i|\theta^{t+1}) - log p(x_i|\theta^t)\\<br>
&amp; \ge 0<br>
\end{align*}</p>
<h2 id="ä¾‹å­">ä¾‹å­</h2>
<p>å‡å¦‚æœ‰ä¸¤ä¸ªç¡¬å¸Aå’ŒBï¼Œå‡è®¾éšæœºä»A,Bä¸­é€‰ä¸€ä¸ªç¡¬å¸ï¼Œæ·$10$æ¬¡ï¼Œé‡å¤$5$æ¬¡å®éªŒï¼Œåˆ†åˆ«æ±‚å‡ºä¸¤ä¸ªç¡¬å¸æ­£é¢å‘ä¸Šçš„æ¦‚ç‡ã€‚å‡è®¾ç¡¬å¸æœä»äºŒé¡¹åˆ†å¸ƒ<br>
$5$æ¬¡å®éªŒç»“æœå¦‚ä¸‹ï¼š<br>
5H5T<br>
9H1T<br>
8H2T<br>
4H6T<br>
7H3T</p>
<p>è¿™ä¸ªæ—¶å€™æœ‰ä¸¤ç§æƒ…å†µ</p>
<h3 id="çŸ¥é“æ¯æ¬¡é€‰çš„æ˜¯aè¿˜æ˜¯b">çŸ¥é“æ¯æ¬¡é€‰çš„æ˜¯Aè¿˜æ˜¯B</h3>
<p>è¿™ä¸ªæ—¶å€™å°±å˜æˆäº†æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p>
<h3 id="ä¸çŸ¥é“æ¯æ¬¡é€‰çš„æ˜¯aè¿˜æ˜¯b">ä¸çŸ¥é“æ¯æ¬¡é€‰çš„æ˜¯Aè¿˜æ˜¯B</h3>
<p>è¿™ä¸ªæ—¶å€™å°±ç”¨EMç®—æ³•äº†ã€‚<br>
é¦–å…ˆéšæœºåˆå§‹åŒ–$\theta_A = 0.5, \theta_B = 0.5$ï¼Œ<br>
å¯¹äºæ¯ä¸€ä¸ªè§‚æµ‹ï¼Œé¦–å…ˆåˆ¤æ–­å®ƒå¯¹åº”çš„éšå˜é‡çš„åˆ†å¸ƒã€‚<br>
$i={1,2,3,4,5}$ï¼Œåˆ†åˆ«ä»£è¡¨$5$ä¸ªå®éªŒã€‚<br>
é¦–å…ˆæ±‚å‡º$\theta_A$çš„å‚æ•°ã€‚<br>
$$P(z = A|x_i, \theta_A, \theta_B) = \frac{P(z = A|x_i, \theta_A)}{P(z = A|x_i, \theta_A) + P(z = B|x_i, \theta_B)}$$<br>
$$P(z = B|x_i, \theta_A, \theta_B) = 1 - P(z = A|x_i,\theta_A,\theta_B)$$<br>
ç„¶åè®¡ç®—ä¸‹å¼ï¼š<br>
\begin{align*}<br>
L(q,\theta_A) &amp;= \sum_{i=1}^5 \sum_zp(z|x_i, \theta_A, \theta_B)log p(x_i|\theta)\\<br>
&amp;= \sum_{i=1}^5 (p(z=A|x_i, \theta_A)log p(x_i|\theta_A) + p(z=B|x_i, \theta_B)log p(x_i|\theta_B))<br>
\end{align*}<br>
ç„¶ååˆ©ç”¨æå¤§æ—¢ç„¶ä¼°è®¡è®¡ç®—$\theta_A$å’Œ$\theta_B$çš„å€¼ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<p>1.<a href="https://www.zhihu.com/question/27976634/answer/153567695" target="_blank" rel="noopener">https://www.zhihu.com/question/27976634/answer/153567695</a><br>
2.<a href="https://en.wikipedia.org/wiki/Jensen%27s_inequality" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Jensen's_inequality</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/01/06/bayesian-networks/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/06/bayesian-networks/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">Bayesian Networks</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-06 14:32:55" itemprop="dateCreated datePublished" datetime="2019-01-06T14:32:55+08:00">2019-01-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-07 00:22:27" itemprop="dateModified" datetime="2019-05-07T00:22:27+08:00">2019-05-07</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/æœºå™¨å­¦ä¹ /" itemprop="url" rel="index"><span itemprop="name">æœºå™¨å­¦ä¹ </span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ä»‹ç»">ä»‹ç»</h2>
<p>è´å¶æ–¯ç½‘ç»œæ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾(directed acyclic graphs)ï¼Œå®ƒç”¨èŠ‚ç‚¹ä»£è¡¨éšæœºå˜é‡ï¼Œç”¨è¾¹ä»£è¡¨å˜é‡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p>
<h2 id="æ„ä¹‰">æ„ä¹‰</h2>
<p>è´å¶æ–¯ç½‘ç»œå¯ä»¥ç”¨æ¥è¡¨ç¤ºä»»æ„çš„è”åˆåˆ†å¸ƒã€‚</p>
<h2 id="æ¨ç†">æ¨ç†</h2>
<p>è´å¶æ–¯ç½‘ç»œçš„ä¸€ä¸ªåŸºæœ¬ä»»åŠ¡å°±æ˜¯æ±‚åéªŒæ¦‚ç‡ã€‚<br>
åœ¨AIè¿™æœ¬ä¹¦ä¸­ï¼Œè´å¶æ–¯ç½‘ç»œä¸­çš„å˜é‡è¢«åˆ†ä¸ºäº†è¯æ®å˜é‡(evidence variable)ï¼Œéšå˜é‡(hidden variable)å’ŒæŸ¥è¯¢å˜é‡(query variable)ã€‚<br>
è€Œåœ¨PRMLè¿™æœ¬ä¹¦ä¸­ï¼Œè´å¶æ–¯ç½‘ç»œä¸­çš„å˜é‡è¢«åˆ†ä¸ºäº†è§‚æµ‹å˜é‡(observed variable)å’Œéšå˜é‡(latent variable,hidden variable)ã€‚</p>
<h2 id="none"></h2>
<p>å…·ä½“çš„å¯ä»¥çœ‹å¦å¤–ä¸¤ç¯‡ç¬”è®°æœ‰è¯¦ç»†çš„è®°å½•ã€‚</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/01/06/AI-chapter-14-Probabilistic-reasoning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
      <meta itemprop="description" content="è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" class="post-title-link" itemprop="http://mxxhcm.github.io/page/14/index.html">AI chapter 14 Probabilistic reasoning</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-06 14:32:16" itemprop="dateCreated datePublished" datetime="2019-01-06T14:32:16+08:00">2019-01-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-07 00:22:27" itemprop="dateModified" datetime="2019-05-07T00:22:27+08:00">2019-05-07</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/æœºå™¨å­¦ä¹ /" itemprop="url" rel="index"><span itemprop="name">æœºå™¨å­¦ä¹ </span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>åœ¨è¿™é‡ŒåŠ ä¸€äº›è‡ªå·±çš„æ€»ç»“ï¼Œè¿™ä¸€ç« ä¸»è¦è®²çš„æ˜¯è´å¶æ–¯ç½‘ç»œï¼Œé¦–å…ˆä»‹ç»äº†è´å¶æ–¯ç½‘ç»œçš„å®šä¹‰ï¼Œæ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼ŒèŠ‚ç‚¹ä»£è¡¨éšæœºå˜é‡ï¼Œè¾¹ä»£è¡¨å› æœå…³ç³»ã€‚è¿™é‡Œç»™å‡ºäº†è´å¶æ–¯å…¬å¼çš„ä¸¤ä¸ªæ„ä¹‰ï¼Œä¸€ä¸ªæ˜¯æ•°å€¼æ„ä¹‰ï¼Œç”¨è´å¶æ–¯ç½‘ç»œè¡¨ç¤ºå…¨æ¦‚ç‡åˆ†å¸ƒï¼Œå¦ä¸€ä¸ªæ˜¯æ‹“æ‰‘æ„ä¹‰ï¼Œç»™å®šæŸä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹æ¡ä»¶ç‹¬ç«‹äºæ‰€æœ‰å®ƒçš„éåè£”èŠ‚ç‚¹ï¼Œæˆ–è€…ç»™å®šæŸä¸ªèŠ‚ç‚¹çš„é©¬å°”ç§‘å¤«æ¯¯ï¼Œè¿™ä¸ªèŠ‚ç‚¹æ¡ä»¶ç‹¬ç«‹äºæ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ã€‚æ¥ä¸‹æ¥è®²äº†æ¡ä»¶ç‹¬ç«‹çš„é«˜æ•ˆè¡¨ç¤ºï¼Œå™ªéŸ³æˆ–æ¨¡å‹è¡¨ç¤ºç¦»æ•£å‹çˆ¶èŠ‚ç‚¹å’Œç¦»æ•£å‹å­èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ï¼Œç”¨å‚æ•°åŒ–æ¨¡å‹è¡¨ç¤ºè¿ç»­å‹çˆ¶èŠ‚ç‚¹å’Œè¿ç»­å‹å­èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ï¼Œç”¨probitæ¨¡å‹æˆ–è€…logitæ¨¡å‹è¡¨ç¤ºè¿ç»­å‹çˆ¶èŠ‚ç‚¹å’Œç¦»æ•£å‹å­èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ã€‚æ¥ä¸‹æ¥å°±ä»‹ç»äº†è´å¶æ–¯ç²¾ç¡®æ¨ç†è®¡ç®—åéªŒåˆ†å¸ƒçš„é›†ä¸­æ–¹æ³•ï¼Œä¸€ç§æ˜¯æšä¸¾æ¨ç†ï¼Œä¸€ç§æ˜¯æ¶ˆå…ƒæ³•ã€‚å› ä¸ºç²¾ç¡®æ¨ç†çš„å¤æ‚åº¦å¤ªé«˜äº†ï¼Œæ²¡æœ‰å®é™…åº”ç”¨ä»·å€¼ï¼Œæ‰€ä»¥å°±ç»™å‡ºäº†ä¸€äº›ä¼°è®¡æ¨ç†çš„æ–¹æ³•ï¼Œç›´æ¥é‡‡æ ·ï¼Œæ‹’ç»é‡‡æ ·ï¼Œä»¥åŠå¯èƒ½æ€§åŠ æƒï¼Œè¿˜æœ‰å¦ä¸€ç±»é‡‡æ ·æ–¹æ³•ï¼Œè’™ç‰¹å¡æ´›ç®—æ³•ï¼Œä¸»è¦ä»‹ç»äº†å‰å¸ƒæ£®é‡‡æ ·ï¼Œå¤§æ¦‚å°±æ˜¯è¿™äº›ã€‚åé¢çš„ä¸¤ä¸ªå°èŠ‚æ²¡æœ‰çœ‹ã€‚</p>
<p>ç¬¬$13$ç« è®²çš„æ˜¯æ¦‚ç‡è®ºçš„åŸºç¡€çŸ¥è¯†å¹¶ä¸”å¼ºè°ƒäº†åœ¨æ¦‚ç‡è¡¨ç¤ºä¸­ç‹¬ç«‹(independence)å’Œæ¡ä»¶ç‹¬ç«‹(conditional independence)ä¹‹é—´çš„å…³ç³»ã€‚æœ¬ç« å¼•å…¥äº†ä¸€ä¸ªç³»ç»Ÿçš„æ–¹å¼â€“è´å¶æ–¯ç½‘ç»œå»è¡¨ç°ç‹¬ç«‹å’Œæ¡ä»¶ç‹¬ç«‹ä¹‹é—´çš„å…³ç³»ã€‚æ¦‚æ‹¬çš„æ¥è¯´ï¼Œæœ¬ç« çš„å†…å®¹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹äº”éƒ¨åˆ†ï¼š</p>
<ol>
<li>é¦–å…ˆå®šä¹‰äº†è´å¶æ–¯ç½‘ç»œçš„è¯­æ³•(syntax)å’Œè¯­ä¹‰(semantics)ï¼Œå¹¶ä¸”å±•ç¤ºäº†å¦‚ä½•ç”¨è´å¶æ–¯ç½‘ç»œè¡¨ç¤ºä¸ç¡®å®šçŸ¥è¯†ã€‚</li>
<li>æ¥ä¸‹æ¥ä»‹ç»äº†æ¦‚ç‡æ¨ç†åœ¨æœ€åçš„æƒ…å†µä¸‹æ˜¯å¾ˆéš¾è®¡ç®—çš„(computionally intratable)ï¼Œä½†æ˜¯åœ¨å¾ˆå¤šæƒ…å†µä¸‹å¯ä»¥é«˜æ•ˆçš„å®Œæˆã€‚</li>
<li>ä»‹ç»äº†ä¸€ç³»åˆ—åœ¨ç²¾ç¡®æ¨ç†(exact inference)ä¸å¯è¡Œæ—¶å¯ä»¥é‡‡ç”¨çš„ä¼°è®¡æ¨ç†ç®—æ³•(approximate inference algorithms)ã€‚</li>
<li>ä»‹ç»äº†ä¸€äº›åœ¨æ¦‚ç‡è®ºä¸­å¯ä»¥è¢«åº”ç”¨åˆ°å¸¦å¯¹è±¡å’Œå…³ç³»çš„ä¸–ç•Œçš„æ–¹æ³•ï¼Œå³ä¸å‘½é¢˜ï¼Œè¡¨ç¤ºç›¸å¯¹çš„ä¸€é˜¶æ¨¡å‹ã€‚</li>
<li>æœ€åï¼Œä»‹ç»äº†ä¸€äº›å…¶å®ƒä¸ç¡®å®šæ€§æ¨ç†çš„æ–¹æ³•ã€‚</li>
</ol>
<h2 id="ä¸ç¡®å®šåŸŸçš„çŸ¥è¯†è¡¨ç¤º-representing-knowledge-in-an-uncertain-domain">ä¸ç¡®å®šåŸŸçš„çŸ¥è¯†è¡¨ç¤º(Representing knowledge in an uncertain domain)</h2>
<p>æˆ‘ä»¬å¯ä»¥æ ¹æ®è”åˆæ¦‚ç‡åˆ†å¸ƒ(full joint probability distribution)ç®—å‡ºä»»ä½•æƒ³è¦çš„æ¦‚ç‡å€¼ï¼Œä½†æ˜¯éšç€éšæœºå˜é‡ä¸ªæ•°çš„å¢åŠ ï¼Œè”åˆæ¦‚ç‡åˆ†å¸ƒå¯èƒ½ä¼šå˜å¾—ç‰¹åˆ«å¤§ã€‚æ­¤å¤–ï¼Œä¸€ä¸ªä¸€ä¸ªçš„æŒ‡å®šå¯èƒ½ä¸–ç•Œä¸­çš„æ¦‚ç‡æ˜¯ä¸å¯è¡Œçš„ã€‚</p>
<h3 id="è´å¶æ–¯ç½‘ç»œçš„å®šä¹‰">è´å¶æ–¯ç½‘ç»œçš„å®šä¹‰</h3>
<p>å¦‚æœåœ¨è”åˆæ¦‚ç‡ä¸­å¼•å…¥ç‹¬ç«‹å’Œæ¡ä»¶ç‹¬ç«‹ï¼Œå°†ä¼šæ˜¾è‘—çš„å‡å°‘å®šä¹‰è”åˆæ¦‚ç‡åˆ†å¸ƒæ‰€éœ€è¦çš„æ¦‚ç‡ã€‚æ‰€ä»¥è¿™èŠ‚å°±ä»‹ç»äº†è´å¶æ–¯ç½‘ç»œæ¥è¡¨ç¤ºå˜é‡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚æœ¬è´¨ä¸Šè´å¶æ–¯ç½‘ç»œå¯ä»¥è¡¨ç¤ºä»»ä½•è”åˆæ¦‚ç‡åˆ†å¸ƒï¼Œè€Œä¸”åœ¨å¾ˆå¤šæƒ…å†µä¸‹æ˜¯éå¸¸ç²¾ç¡®åœ°è¡¨ç¤ºã€‚ä¸€ä¸ªè´å¶æ–¯ç½‘ç»œæ˜¯ä¸€ä¸ªæœ‰å‘å›¾ï¼Œå›¾ä¸­çš„èŠ‚ç‚¹åŒ…å«é‡åŒ–åçš„æ¦‚ç‡ä¿¡æ¯ã€‚å…·ä½“çš„è¯´æ˜å¦‚ä¸‹ï¼š</p>
<ol>
<li>æ¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªéšæœºå˜é‡ï¼Œè¿™ä¸ªéšæœºå˜é‡å¯ä»¥æ˜¯ç¦»æ•£çš„ä¹Ÿå¯ä»¥æ˜¯è¿ç»­çš„ã€‚</li>
<li>æœ‰å‘è¾¹æˆ–è€…ç®­å¤´è¿æ¥ä¸€å¯¹èŠ‚ç‚¹ã€‚å¦‚æœç®­å¤´æ˜¯ä»èŠ‚ç‚¹$X$åˆ°èŠ‚ç‚¹$Y$ï¼Œé‚£ä¹ˆèŠ‚ç‚¹$X$ç§°ä¸ºèŠ‚ç‚¹$Y$çš„çˆ¶èŠ‚ç‚¹ã€‚å›¾ä¸­ä¸èƒ½æœ‰ç¯ï¼Œå› æ­¤è´å¶æ–¯ç½‘ç»œæ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾(directed acyclic graph,DAG)ã€‚</li>
<li>æ¯ä¸€ä¸ªèŠ‚ç‚¹$X_i$æœ‰ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$P(x_i|Parents(X_i))$é‡åŒ–(quantifiy)çˆ¶èŠ‚ç‚¹å¯¹å…¶å½±å“ã€‚</li>
</ol>
<p>ç½‘ç»œçš„æ‹“æ‰‘ï¼Œå³èŠ‚ç‚¹å’Œè¾¹çš„é›†åˆï¼ŒæŒ‡å®šäº†æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å…³ç³»ã€‚ç®­å¤´çš„ç›´è§‚æ„ä¹‰æ˜¯èŠ‚ç‚¹$X$å¯¹èŠ‚ç‚¹$Y$æœ‰ç›´æ¥çš„å½±å“ï¼Œ$Y$å‘ç”Ÿçš„åŸå› æ˜¯å…¶çˆ¶èŠ‚ç‚¹çš„å½±å“ã€‚é€šå¸¸å¯¹äºä¸€ä¸ªé¢†åŸŸ(domain)çš„ä¸“å®¶æ¥è¯´ï¼ŒæŒ‡å‡ºè¯¥åŸŸå—å“ªäº›å› ç´ çš„ç›´æ¥å½±å“è¦æ¯”ç›´æ¥ç»™å‡ºå®ƒçš„æ¦‚ç‡å€¼ç®€å•çš„å¤šã€‚ä¸€æ—¦è´å¶æ–¯ç½‘ç»œçš„æ‹“æ‰‘ç»“æ„å®šäº†ï¼Œç»™å‡ºä¸€ä¸ªå˜é‡çš„çˆ¶èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ä»…ä»…éœ€è¦ç»™å‡ºæ¯ä¸ªèŠ‚ç‚¹çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒã€‚æˆ‘ä»¬èƒ½çœ‹å‡ºï¼Œæ‹“æ‰‘å’Œæ¡ä»¶æ¦‚ç‡çš„ç»„åˆèƒ½è®¡ç®—å‡ºæ‰€æœ‰å˜é‡çš„è”åˆæ¦‚ç‡åˆ†å¸ƒã€‚</p>
<h3 id="è´å¶æ–¯ç½‘ç»œçš„ç¤ºä¾‹">è´å¶æ–¯ç½‘ç»œçš„ç¤ºä¾‹</h3>
<h4 id="ç‰™ç–¼å’Œå¤©æ°”">ç‰™ç–¼å’Œå¤©æ°”</h4>
<p>ç»™å®šä¸€ç»„éšæœºå˜é‡ç‰™ç–¼(Toothache)ï¼Œè›€ç‰™(Cavity)ï¼Œæ‹”ç‰™(Catch)å’Œå¤©æ°”(Weather)ã€‚Weatheræ˜¯ç‹¬ç«‹äºå¦å¤–ä¸‰ä¸ªéšæœºå˜é‡çš„ï¼Œæ­¤å¤–ï¼Œç»™å®šCavityï¼ŒCatchå’ŒToothacheæ˜¯æ¡ä»¶ç‹¬ç«‹çš„ï¼Œå³ç»™å®šCavityï¼ŒCatchå’ŒToothacheæ˜¯ç›¸äº’ä¸å—å½±å“çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ­£å¼çš„ï¼šç»™å®šCavityï¼ŒToochacheå’ŒCatchæ˜¯æ¡ä»¶ç‹¬ç«‹çš„ï¼Œå›¾ä¸­Toothacheå’ŒCatchä¹‹é—´ç¼ºå¤±çš„è¾¹ä½“ç°å‡ºäº†æ¡ä»¶ç‹¬ç«‹ã€‚ç›´è§‚ä¸Šï¼Œç½‘ç»œè¡¨ç°å‡ºCavityæ˜¯Toothacheå’ŒCatchå‘ç”Ÿçš„ç›´æ¥åŸå› ï¼Œç„¶è€Œåœ¨Toothacheå’ŒCatchä¹‹é—´æ²¡æœ‰ç›´æ¥çš„å› æœå…³ç³»ã€‚<br>
<img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.1"></p>
<h4 id="è­¦æŠ¥å’Œæ‰“ç”µè¯">è­¦æŠ¥å’Œæ‰“ç”µè¯</h4>
<p>æˆ‘å®¶é‡Œæœ‰ä¸€ä¸ªæ–°å®‰è£…çš„é˜²ç›—è­¦æŠ¥(burglar alarm)ï¼Œè¿™ä¸ªè­¦æŠ¥å¯¹äºå°å·çš„æ£€æµ‹æ˜¯ç›¸å½“å¯é çš„ï¼Œä½†æ˜¯ä¹Ÿä¼šå¯¹å¶ç„¶å‘ç”Ÿçš„å¾®å°çš„åœ°éœ‡å“åº”ã€‚æˆ‘æœ‰ä¸¤ä¸ªé‚»å±…(Maryå’ŒJohn)ï¼Œä»–ä»¬å¬åˆ°è­¦æŠ¥åä¼šæ‰“ç”µè¯ç»™æˆ‘ã€‚Johnæœ‰æ—¶ä¼šæŠŠç”µè¯é“ƒå’Œè­¦æŠ¥å¼„æ··äº†ï¼Œä¹Ÿä¼šæ‰“ç”µè¯ã€‚Maryå¬éŸ³ä¹å¾ˆå¤§å£°ï¼Œç»å¸¸ä¼šé”™è¿‡è­¦æŠ¥ã€‚ç°åœ¨ç»™å‡ºJohnæˆ–è€…Maryè°æ˜¯å¦æ‰“ç”µè¯ï¼Œä¼°è®¡è­¦æŠ¥å“äº†çš„æ¦‚ç‡ã€‚<br>
<img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.2"><br>
è¯¥ä¾‹å­çš„è´å¶æ–¯ç½‘ç»œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚è¯¥ç½‘ç»œä½“ç°äº†å°å·å’Œåœ°éœ‡ä¸¤ä¸ªå› ç´ ä¼šç›´æ¥å½±å“è­¦æŠ¥å“çš„æ¦‚ç‡ï¼Œä½†æ˜¯Johnå’ŒMaryä¼šä¸ä¼šæ‰“ç”µè¯åªå–å†³äºè­¦æŠ¥æœ‰æ²¡æœ‰å“ã€‚è´å¶æ–¯ç½‘ç»œå±•ç¤ºå‡ºäº†æˆ‘ä»¬çš„å‡è®¾ï¼Œå³Johnå’ŒMaryä¸ç›´æ¥è§‚å¯Ÿå°å·æœ‰æ²¡æœ‰æ¥ï¼Œä¹Ÿä¸ç›´æ¥è§‚å¯Ÿå°çš„åœ°éœ‡æ˜¯å¦ï¼Œä¹Ÿä¸å—ä¹‹å‰æ˜¯å¦æ‰“è¿‡ç”µè¯çš„å½±å“ã€‚ä¸Šå›¾ä¸­çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒä»¥ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒè¡¨(conditional probability table,CPT)çš„å½¢å¼å±•ç°äº†å‡ºæ¥ã€‚è¿™ä¸ªè¡¨é€‚åˆç¦»æ•£å‹çš„éšæœºå˜é‡ï¼Œä½†æ˜¯ä¸é€‚åˆè¿ç»­æ€§éšæœºå˜é‡ã€‚æ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹åªæœ‰ä¸€è¡Œï¼Œç”¨æ¥è¡¨ç¤ºéšæœºå˜é‡çš„å¯èƒ½å–å€¼çš„å…ˆéªŒæ¦‚ç‡(prior probabilities)ã€‚<br>
æ³¨æ„åˆ°è¿™ä¸ªç½‘ç»œä¸­æ²¡æœ‰èŠ‚ç‚¹å¯¹åº”Maryå¬éŸ³ä¹å¾ˆå¤§æ—¶ï¼Œä¹Ÿæ²¡æœ‰èŠ‚ç‚¹å¯¹åº”JohnæŠŠç”µè¯é“ƒå£°å½“æˆäº†è­¦æŠ¥ã€‚äº‹å®ä¸Šè¿™äº›å› ç´ éƒ½è¢«åŒ…å«åœ¨å’Œè¾¹Alarmåˆ°JohnCallså’ŒMaryCallç›¸å…³çš„ä¸ç¡®å®šæ€§ä¸­äº†ï¼Œæ¦‚ç‡åŒ…å«äº†æ— æ•°ç§æƒ…å†µå¯èƒ½è®©è­¦æŠ¥å¤±çµï¼ˆåœç”µï¼Œè€é¼ å’¬åäº†ï¼Œç­‰ç­‰ï¼‰æˆ–è€…Johnå’ŒMaryæ²¡æœ‰æ‰“ç”µè¯çš„åŸå› ï¼ˆåƒé¥­å»äº†ï¼Œåˆç¡äº†ï¼Œä¼‘å‡äº†ç­‰ç­‰ï¼‰ï¼Œè¿™äº›ä¸ç¡®å®šæ€§éƒ½åŒ…å«åœ¨äº†æ¦‚ç‡ä¸­äº†ã€‚</p>
<h2 id="è´å¶æ–¯ç½‘ç»œçš„æ„ä¹‰-the-semantics-of-bayesian-networks">è´å¶æ–¯ç½‘ç»œçš„æ„ä¹‰(the semantics of bayesian networks)</h2>
<p>ä¸Šä¸€èŠ‚ä¸»è¦è®²çš„æ˜¯ä»€ä¹ˆæ˜¯è´å¶æ–¯ç½‘ç»œï¼Œä½†æ˜¯æ²¡æœ‰è®²å®ƒçš„æ„ä¹‰ã€‚æœ¬èŠ‚ä¸»è¦ç»™å‡ºä¸¤ç§æ–¹å¼å¯ä»¥ç†è§£è´å¶æ–¯ç½‘ç»œçš„æ„ä¹‰ã€‚ç¬¬ä¸€ä¸ªæ˜¯ä¸€ç§æ•°å€¼åŒ–çš„æ„ä¹‰ï¼Œå³&quot;numerical semantics&quot;ï¼ŒæŠŠå®ƒå½“æˆè”åˆæ¦‚ç‡åˆ†å¸ƒçš„ä¸€ç§è¡¨ç¤ºå½¢å¼ã€‚ç¬¬äºŒä¸ªæ˜¯ä¸€ç§æ‹“æ‰‘çš„æ„ä¹‰ï¼Œå³&quot;topological semantics&quot;ï¼Œå°†å®ƒçœ‹æˆæ¡ä»¶ç‹¬ç«‹çš„ä¸€ç§ç¼–ç æ–¹å¼ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼Œä½†æ˜¯ç¬¬ä¸€ç§æ–¹å¼æ›´æœ‰åŠ©äºç†è§£å¦‚ä½•æ„å»ºè´å¶æ–¯ç½‘ç»œï¼Œç¬¬äºŒç§æ–¹å¼æ›´æœ‰åŠ©äºè®¾è®¡æ¨ç†è¿‡ç¨‹ã€‚</p>
<h3 id="è´å¶æ–¯ç½‘ç»œè¡¨ç¤ºè”åˆåˆ†å¸ƒ-representing-the-full-joint-distribution">è´å¶æ–¯ç½‘ç»œè¡¨ç¤ºè”åˆåˆ†å¸ƒ(Representing the full joint distribution)</h3>
<h4 id="å®šä¹‰">å®šä¹‰</h4>
<p>ä¸€ä¸ªè´å¶æ–¯ç½‘ç»œæ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæ•°å€¼å‚æ•°ã€‚æ•°å€¼æ–¹å¼ç»™å‡ºè¿™ä¸ªç½‘ç»œçš„æ„ä¹‰æ˜¯ï¼Œå®ƒä»£è¡¨äº†æ‰€æœ‰å˜é‡çš„è”åˆæ¦‚ç‡åˆ†å¸ƒã€‚ä¹‹å‰è¯´è¿‡èŠ‚ç‚¹ä¸Šçš„å€¼ä»£è¡¨çš„æ˜¯æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$P(X_i|Parents(X_i)$ï¼Œè¿™æ˜¯å¯¹çš„ï¼Œä½†æ˜¯å½“èµ‹äºˆæ•´ä¸ªç½‘ç»œæ„ä¹‰ä»¥åï¼Œè¿™é‡Œæˆ‘ä»¬è®¤ä¸ºå®ƒä»¬åªæ˜¯ä¸€äº›æ•°å­—$\theta(X_i|Parents(X_i)$ã€‚<br>
è”åˆæ¦‚ç‡ä¸­çš„ä¸€ä¸ªå…·ä½“é¡¹(entry)è¡¨ç¤ºçš„æ˜¯æ¯ä¸€ä¸ªéšæœºå˜é‡å–æŸä¸ªå€¼çš„è”åˆæ¦‚ç‡ï¼Œå¦‚$P(X_1=x_1 \wedge \cdots\wedge X_n = x_n)$ï¼Œç¼©å†™ä¸º$P(x_1,\cdots,x_n)$ã€‚è¿™ä¸ªé¡¹çš„å€¼å¯ä»¥é€šè¿‡ä»¥ä¸‹å…¬å¼è¿›è¡Œè®¡ç®—ï¼š<br>
$$P(x_1,\cdots,x_n) = \prod_{i=1}^n \theta(x_i|parents(X_i)),$$<br>
å…¶ä¸­$parents(X_i)$è¡¨ç¤ºèŠ‚ç‚¹$X_i$åœ¨$x_1,\cdots,x_n$ä¸­çš„çˆ¶èŠ‚ç‚¹ã€‚å› æ­¤ï¼Œè”åˆæ¦‚ç‡åˆ†å¸ƒä¸­çš„æ¯ä¸€é¡¹éƒ½å¯ä»¥ç”¨è´å¶æ–¯ç½‘ç»œä¸­æŸäº›æ¡ä»¶æ¦‚ç‡çš„ä¹˜ç§¯è¡¨ç¤ºã€‚ä»å®šä¹‰ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¾ˆå®¹æ˜“è¯æ˜$\theta(x_i|parents(X_i))$å°±æ˜¯æ¡ä»¶æ¦‚ç‡$P(x_i|parents(X_i))$ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šå¼å†™æˆï¼š<br>
$$P(x_1,\cdots,x_n) = \prod_{i=1}^n P(x_i|parents(X_i)),$$<br>
æ¢å¥è¯è¯´ï¼šæ ¹æ®ä¸Šä¸Šä¸ªå¼å­å®šä¹‰çš„è´å¶æ–¯ç½‘ç»œçš„æ„ä¹‰ï¼Œæˆ‘ä»¬ä¹‹å‰å«çš„æ¡ä»¶æ¦‚ç‡è¡¨çœŸçš„æ˜¯æ¡ä»¶æ¦‚ç‡è¡¨ã€‚ï¼ˆè¿™å¥è¯ã€‚ã€‚ã€‚ï¼‰</p>
<h4 id="ç¤ºä¾‹">ç¤ºä¾‹</h4>
<p>æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºè­¦æŠ¥å“äº†ï¼Œä½†æ˜¯æ²¡æœ‰å°å·æˆ–è€…åœ°éœ‡å‘ç”Ÿï¼ŒJohnå’ŒMaryéƒ½æ‰“ç”µè¯äº†çš„æ¦‚ç‡ã€‚å³è®¡ç®—è”åˆåˆ†å¸ƒ$P(j,m,a,\neg b, \neg e)$ï¼ˆä½¿ç”¨å°å†™å­—æ¯è¡¨ç¤ºå˜é‡çš„å€¼ï¼‰ï¼š<br>
\begin{align*}<br>
P(j,m,a,\neg b, \neg e) &amp;=P(j|a)P(m|a)P(a|\neg b \wedge \neg e)P(\neg b)P(\neg e)\<br>
&amp;=0.90\times 0.70\times 0.001 \times 0.999 \times 0.998\<br>
&amp;=0.000628<br>
\end{align*}</p>
<h4 id="æ„å»ºè´å¶æ–¯ç½‘ç»œ-constructing-bayesian-networks">æ„å»ºè´å¶æ–¯ç½‘ç»œ(Constructing Bayesian networks)</h4>
<p>ä¸Šé¢ç»™å‡ºäº†è´å¶æ–¯ç½‘ç»œçš„ä¸€ç§æ„ä¹‰ï¼Œæ¥ä¸‹æ¥ç»™å‡ºå¦‚ä½•æ ¹æ®è¿™ç§æ„ä¹‰å»æ„å»ºä¸€ä¸ªè´å¶æ–¯ç½‘ç»œã€‚ç¡®å®šçš„æ¡ä»¶ç‹¬ç«‹å¯ä»¥ç”¨æ¥æŒ‡å¯¼ç½‘ç»œæ‹“æ‰‘çš„æ„å»ºã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠè”åˆæ¦‚ç‡çš„é¡¹ç”¨ä¹˜æ³•å…¬å¼å†™æˆæ¡ä»¶æ¦‚ç‡è¡¨ç¤ºï¼š<br>
$$P(x_1,\cdots,x_n) = P(x_n|x_{n-1},\cdots,x_1)P(x_{n-1},\cdots,x_1)$$<br>
æ¥ä¸‹æ¥é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œå°†è”åˆæ¦‚ç‡(conjunctive probability)åˆ†è§£æˆä¸€ä¸ªæ¡ä»¶æ¦‚ç‡å’Œä¸€ä¸ªæ›´å°çš„è”åˆæ¦‚ç‡ã€‚æœ€åå¾—åˆ°ä¸‹å¼ï¼š<br>
\begin{align*}<br>
P(x_1,\cdots,x_n) &amp;= P(x_n|x_{n-1},\cdots,x_1)P(x_{n-1}|,x_{n-2}\cdots,x_1)\cdots P(x_2|x_1)P(x_1)\<br>
&amp;= \prod_{i=1}^nP(x_i|x_{i-1},\cdots,x_1)<br>
\end{align*}<br>
è¿™ä¸ªå…¬å¼è¢«ç§°ä¸ºé“¾å¼æ³•åˆ™ï¼Œå®ƒå¯¹äºä»»æ„çš„éšæœºå˜é‡é›†éƒ½æˆç«‹ã€‚å¯¹äºè´å¶æ–¯ç½‘ç»œä¸­çš„æ¯ä¸€ä¸ªå˜é‡$X_i$ï¼Œå¦‚æœç»™å®š$Parents(X_i) \subset {X_{i-1},\cdots,X_1}$ï¼ˆæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„åºå·åº”è¯¥å’Œå›¾ç»“æ„çš„ååºç»“æ„ä¸€è‡´ï¼‰ï¼Œé‚£ä¹ˆæœ‰ï¼š<br>
$$P(x_1,\cdots,x_n) = \prod_{i=1}^n P(x_i|parents(X_i)),$$<br>
å°†å®ƒå’Œä¸Šå¼å¯¹æ¯”ï¼Œå¾—å‡ºï¼š<br>
$$P(X_i|X_{i-1},\cdots,X_1) = P(X_i|Parents(X_i).$$<br>
è¿™ä¸ªå…¬å¼æˆç«‹çš„æ¡ä»¶æ˜¯ç»™å®šæ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œå®ƒæ¡ä»¶ç‹¬ç«‹äºæ‰€æœ‰å®ƒçš„éçˆ¶å‰ç½®èŠ‚ç‚¹ã€‚è¿™é‡Œç»™å‡ºä¸€ä¸ªç”Ÿæˆè´å¶æ–¯ç½‘ç»œçš„æ–¹å¼ï¼š</p>
<ol>
<li>èŠ‚ç‚¹ï¼šé¦–å…ˆï¼Œç¡®å®šéœ€è¦å¯¹é¢†åŸŸå»ºæ¨¡æ‰€éœ€è¦çš„éšæœºå˜é‡é›†åˆã€‚å¯¹å®ƒä»¬è¿›è¡Œæ’åºï¼š${X_1,\cdots,X_n}$ï¼Œä»»æ„é¡ºåºéƒ½è¡Œï¼Œä½†æ˜¯å¦‚æœéšæœºå˜é‡çš„å› (causes)åœ¨æœ(effects)ä¹‹å‰ï¼Œæœ€ç»ˆçš„ç»“æœä¼šæ›´åŠ ç´§å‡‘ã€‚</li>
<li>è¾¹ï¼šä»$i = 1$åˆ°$n$ï¼Œ</li>
</ol>
<ul>
<li>ä»$X_1,\cdots,X_{i-1}$ä¸­é€‰å‡º$X_i$çš„æœ€å°çˆ¶èŠ‚ç‚¹é›†åˆã€‚</li>
<li>å¯¹äºæ¯ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œæ’å…¥ä¸€æ¡ä»çˆ¶èŠ‚ç‚¹åˆ°$X_i$çš„è¾¹ã€‚</li>
<li>å†™ä¸‹æ¡ä»¶æ¦‚ç‡è¡¨ï¼Œ$P(X_i| Parents(X_i))$ã€‚</li>
</ul>
<p>ç›´è§‚ä¸Šï¼Œ$X_i$çš„çˆ¶èŠ‚ç‚¹åº”è¯¥åŒ…å«$X_1,\cdots,X_{i-1}$ä¸­æ‰€æœ‰ç›´æ¥å½±å“$X_i$çš„èŠ‚ç‚¹ã€‚å› ä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½åªå’Œå®ƒå‰é¢çš„èŠ‚ç‚¹ç›¸è¿ï¼Œè¿™å°±ä¿è¯äº†æ¯ä¸ªç½‘ç»œéƒ½æ˜¯æ— ç¯çš„(acyclic)ã€‚æ­¤å¤–ï¼Œè´å¶æ–¯ç½‘ç»œè¿˜ä¸åŒ…å«å†—ä½™çš„æ¦‚ç‡å€¼ï¼Œå¦‚æœæœ‰å†—ä½™å€¼ï¼Œå°±ä¼šäº§ç”Ÿä¸ä¸€è‡´ï¼šä¸å¯èƒ½ç”Ÿæˆä¸€ä¸ªè¿åæ¦‚ç‡è®ºå…¬ç†çš„è´å¶æ–¯ç½‘ç»œã€‚</p>
<h4 id="ç´§å‡‘æ€§å’ŒèŠ‚ç‚¹é¡ºåº-compactness-and-node-ordering">ç´§å‡‘æ€§å’ŒèŠ‚ç‚¹é¡ºåº(Compactness and node ordering)</h4>
<h5 id="ç´§å‡‘æ€§-compactness">ç´§å‡‘æ€§(compactness)</h5>
<p>å› ä¸ºä¸åŒ…å«å†—ä½™ä¿¡æ¯ï¼Œè´å¶æ–¯ç½‘ç»œä¼šæ¯”è”åˆæ¦‚ç‡åˆ†å¸ƒæ›´åŠ ç´§å‡‘ï¼Œè¿™è®©å®ƒèƒ½å¤Ÿå¤„ç†æ‹¥æœ‰å¾ˆå¤šå˜é‡çš„ä»»åŠ¡ã€‚è´å¶æ–¯ç½‘ç»œçš„ç´§å‡‘æ€§æ˜¯ç¨€ç–(sparse)ç³»ç»Ÿæˆ–è€…å±€éƒ¨ç»“æ„åŒ–(local structured)ç³»ç»Ÿæ™®éæ‹¥æœ‰çš„ç¨€ç–æ€§çš„ä¸€ä¸ªä¾‹å­ã€‚åœ¨ä¸€ä¸ªå±€éƒ¨ç»“æ„åŒ–ç³»ç»Ÿä¸­ï¼Œæ¯ä¸€ä¸ªå­éƒ¨ä»¶ä»…ä»…å’Œæœ‰é™æ•°é‡çš„å…¶ä»–éƒ¨ä»¶è¿›è¡Œäº¤äº’ï¼Œè€Œä¸ç”¨ç®¡æ•´ä¸ªç³»ç»Ÿã€‚å±€éƒ¨ç»“æ„åŒ–çš„å¤æ‚åº¦é€šå¸¸æ˜¯çº¿æ€§å¢åŠ çš„è€Œä¸æ˜¯æŒ‡æ•°å¢åŠ çš„ã€‚åœ¨è´å¶æ–¯ç½‘ç»œä¸­ï¼Œä¸€ä¸ªéšæœºå˜é‡å¾€å¾€æœ€å¤šå—$k$ä¸ªå…¶ä»–éšæœºå˜é‡ç›´æ¥å½±å“ï¼Œè¿™é‡Œçš„$k$æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬å‡è®¾æœ‰$n$ä¸ªå¸ƒå°”å˜é‡ï¼ŒæŒ‡å®šä¸€ä¸ªæ¡ä»¶æ¦‚ç‡è¡¨æ‰€éœ€è¦çš„æ•°å­—æœ€å¤šæ˜¯$2<sup>k$ä¸ªï¼Œæ•´ä¸ªç½‘ç»œåˆ™éœ€è¦$n2</sup>k$ä¸ªå€¼ï¼›ä½œä¸ºå¯¹æ¯”ï¼Œè”åˆæ¦‚ç‡åˆ†å¸ƒéœ€è¦$2^n$ä¸ªå€¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æœ‰$n=30$ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹è‡³å¤šæœ‰äº”ä¸ªçˆ¶èŠ‚ç‚¹(k=5)ï¼Œé‚£ä¹ˆè´å¶æ–¯ç½‘ç»œåªéœ€è¦$960$ä¸ªå€¼ï¼Œè€Œè”åˆæ¦‚ç‡åˆ†å¸ƒéœ€è¦è¶…è¿‡åäº¿ä¸ªå€¼ã€‚<br>
ä½†æ˜¯åœ¨æŸäº›é¢†åŸŸï¼Œå¯èƒ½æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä¼šè¢«æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ç›´æ¥å½±å“ï¼Œè¿™æ—¶å€™ç½‘ç»œå°±æˆäº†å…¨è¿æ¥çš„ç½‘ç»œ(fully connected)ï¼Œå®ƒå’Œè”åˆæ¦‚ç‡åˆ†å¸ƒéœ€è¦åŒæ ·å¤šçš„ä¿¡æ¯ã€‚æœ‰æ—¶å€™ï¼Œå¢åŠ ä¸€æ¡è¾¹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªä¾èµ–å…³ç³»ï¼Œå¯èƒ½ä¼šå¯¹ç»“æœäº§ç”Ÿå½±å“ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªä¾èµ–å¾ˆå¼±(tenuous)ï¼Œæ·»åŠ è¿™æ¡è¾¹çš„èŠ±è´¹æ¯”è·å¾—çš„æ”¶ç›Šè¿˜è¦å¤§ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦åŠ è¿™æ¡è¾¹äº†ã€‚æ¯”å¦‚ï¼Œè­¦æŠ¥çš„é‚£ä¸ªä¾‹å­ï¼Œå¦‚æœJohnå’ŒMaryæ„Ÿå—åˆ°äº†åœ°éœ‡ï¼Œä»–ä»¬è®¤ä¸ºè­¦æŠ¥æ˜¯åœ°éœ‡å¼•èµ·çš„ï¼Œæ‰€ä»¥å°±ä¸æ‰“ç”µè¯äº†ã€‚æ˜¯å¦æ·»åŠ Earthquakeåˆ°JohnCallså’ŒMaryCallsè¿™ä¸¤æ¡è¾¹å–å†³äºé¢å¤–çš„èŠ±è´¹å’Œå¾—åˆ°æ›´é«˜çš„è­¦æŠ¥ç‡ä¹‹é—´çš„å…³ç³»ã€‚</p>
<h5 id="èŠ‚ç‚¹é¡ºåº-node-ordering">èŠ‚ç‚¹é¡ºåº(node ordering)</h5>
<p>å³ä½¿åœ¨ä¸€ä¸ªå±€éƒ¨ç»“æ„åŒ–çš„é¢†åŸŸï¼Œåªæœ‰å½“æˆ‘ä»¬é€‰æ‹©å¥½çš„èŠ‚ç‚¹é¡ºåºçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰èƒ½å¾—åˆ°ä¸€ä¸ªç´§å‡‘çš„è´å¶æ–¯ç½‘ç»œã€‚è€ƒè™‘è­¦æŠ¥çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç»™å‡ºä¸‹å›¾ï¼š<br>
<img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.3"><br>
Figure 14.2å’ŒFigure 14.3ä¸¤å¼ å›¾ä¸­çš„ä¸‰ä¸ªè´å¶æ–¯ç½‘ç»œè¡¨è¾¾çš„éƒ½æ˜¯åŒä¸€ä¸ªè”åˆåˆ†å¸ƒï¼Œä½†æ˜¯Figure 14.3ä¸­çš„ä¸¤å¼ å›¾æ²¡æœ‰è¡¨ç°å‡ºæ¥æ¡ä»¶ç‹¬ç«‹ï¼Œå°¤å…¶æ˜¯Figure 14.3(b)ä¸­çš„è´å¶æ–¯ç½‘ç»œï¼Œå®ƒéœ€è¦ç”¨å’Œè”åˆåˆ†å¸ƒå·®ä¸å¤šç›¸åŒä¸ªæ•°çš„å€¼æ‰èƒ½è¡¨ç°å‡ºæ¥ã€‚å¯ä»¥çœ‹å‡ºæ¥ï¼ŒèŠ‚ç‚¹çš„é¡ºåºä¼šå½±å“ç´§å‡‘æ€§ã€‚</p>
<h3 id="è´å¶æ–¯ç½‘ç»œä¸­çš„æ¡ä»¶ç‹¬ç«‹-conditional-independence-relations-in-bayesion-networks">è´å¶æ–¯ç½‘ç»œä¸­çš„æ¡ä»¶ç‹¬ç«‹(Conditional independence relations in Bayesion networks)</h3>
<p>è´å¶æ–¯ç½‘ç»œçš„ä¸€ä¸ªæ•°å€¼æ„ä¹‰(â€œnumericalâ€ semantics)æ˜¯ç”¨æ¥è¡¨ç¤ºè”åˆæ¦‚ç‡åˆ†å¸ƒã€‚æ ¹æ®è¿™ä¸ªæ„ä¹‰ï¼Œç»™å®šæ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œä½¿å¾—æ¯ä¸€ä¸ªèŠ‚ç‚¹æ¡ä»¶ç‹¬ç«‹äºå®ƒçš„çˆ¶èŠ‚ç‚¹ä¹‹å¤–çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬èƒ½æ„å»ºä¸€ä¸ªè´å¶æ–¯ç½‘ç»œã€‚æ­¤å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»ç”¨å›¾ç»“æ„ç¼–ç æ•´ä¸ªæ¡ä»¶ç‹¬ç«‹å…³ç³»çš„æ‹“æ‰‘æ„ä¹‰å‡ºå‘ï¼Œç„¶åæ¨å¯¼å‡ºè´å¶æ–¯ç½‘ç»œçš„æ•°å€¼æ„ä¹‰ã€‚æ‹“æ‰‘è¯­ä¹‰è¯´çš„æ˜¯ç»™å®šæ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œåˆ™è¯¥èŠ‚ç‚¹æ¡ä»¶ç‹¬ç«‹äºæ‰€æœ‰å®ƒçš„éåè£”(non-descendants)èŠ‚ç‚¹ã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒFigure 14.2çš„è­¦æŠ¥ä¾‹å­ä¸­ï¼Œç»™å®šalarmåï¼ŒJohnCallsç‹¬ç«‹äºBurglary,Eqrthquakeå’ŒMaryCallsã€‚å¦‚å›¾Figuree 14.4(a)ä¸­æ‰€ç¤ºã€‚ä»æ¡ä»¶ç‹¬ç«‹æ–­è¨€(assertions)å’Œç½‘ç»œå‚æ•°$\theta(x_i|parents(X_i))$å°±æ˜¯æ¡ä»¶æ¦‚ç‡$P(x_i|parents(X_i))$çš„è§£é‡Šä¸­ï¼Œè”åˆæ¦‚ç‡å¯ä»¥è®¡ç®—å‡ºæ¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°å€¼æ„ä¹‰å’Œæ‹“æ‰‘è¯­ä¹‰æ˜¯ç›¸åŒçš„ã€‚<br>
å¦ä¸€ä¸ªæ‹“æ‰‘æ„ä¹‰çš„é‡è¦å±æ€§æ˜¯ï¼šç»™å®šæŸä¸ªèŠ‚ç‚¹çš„é©¬å°”ç§‘å¤«æ¯¯(Markov blanket)ï¼Œå³èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹æ¡ä»¶ç‹¬ç«‹äºæ‰€æœ‰å…¶ä»–çš„èŠ‚ç‚¹ã€‚å¦‚å›¾Figure 14.4(b)æ‰€ç¤ºã€‚</p>
<h2 id="æ¡ä»¶åˆ†å¸ƒçš„é«˜æ•ˆè¡¨ç¤º-efficient-representation-of-conditional-distributions">æ¡ä»¶åˆ†å¸ƒçš„é«˜æ•ˆè¡¨ç¤º(Efficient representation of conditional distributions)</h2>
<p>å³ä½¿æ¯ä¸ªèŠ‚ç‚¹æœ‰$k$ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œä¸€ä¸ªèŠ‚ç‚¹çš„CPTè¿˜éœ€è¦$O(2^k)$ï¼Œæœ€åçš„æƒ…å†µä¸‹çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹æ˜¯ä»»æ„è¿æ¥çš„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ç§å…³ç³»å¯ä»¥ç”¨ç¬¦åˆä¸€äº›æ ‡å‡†æ¨¡å¼(standard pattern)çš„è§„èŒƒåˆ†å¸ƒ(canonical distribution)è¡¨ç¤ºï¼Œè¿™æ ·å­å°±å¯ä»¥ä»…ä»…æä¾›åˆ†å¸ƒçš„ä¸€äº›å‚æ•°å°±èƒ½ç”Ÿæˆæ•´ä¸ªCPTã€‚<br>
æœ€ç®€å•çš„ä¾‹å­æ˜¯ç¡®å®šæ€§èŠ‚ç‚¹(deterministic node)ã€‚ä¸€ä¸ªç¡®å®šæ€§èŠ‚ç‚¹çš„å€¼è¢«å®ƒçš„çˆ¶èŠ‚ç‚¹çš„å€¼ç²¾ç¡®ç¡®å®šã€‚è¿™ä¸ªç¡®å®šæ€§å…³ç³»å¯ä»¥æ˜¯é€»è¾‘å…³ç³»ï¼šçˆ¶èŠ‚ç‚¹æ˜¯åŠ æ‹¿å¤§ï¼Œç¾å›½å’Œå¢¨è¥¿å“¥ï¼Œå­èŠ‚ç‚¹æ˜¯åŒ—ç¾æ´²ï¼Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»æ˜¯å­èŠ‚ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹æ‰€åœ¨çš„æ´²ã€‚è¿™ä¸ªå…³ç³»ä¹Ÿå¯ä»¥æ˜¯æ•°å€¼å‹çš„ï¼Œä¸€æ¡æ²³çš„æµé‡æ˜¯æµå…¥å®ƒçš„æµé‡å‡å»æµå‡ºå®ƒçš„æµé‡ã€‚<br>
ä¸ç¡®å®šå…³ç³»é€šå¸¸ç§°ä¸ºå™ªéŸ³é€»è¾‘å…³ç³»(noisy logical relationships)ã€‚ä¸€ä¸ªä¾‹å­æ˜¯å™ªéŸ³æˆ–(noisy-OR)ï¼Œå®ƒæ˜¯é€»è¾‘æˆ–çš„æ¨å¹¿ã€‚åœ¨å‘½é¢˜é€»è¾‘ä¸­ï¼Œå½“ä¸”ä»…å½“æ„Ÿå†’(Cold)ï¼Œæµæ„Ÿ(Flu)æˆ–è€…ç–Ÿç–¾(Malaria)æ˜¯çœŸçš„æ—¶å€™ï¼Œå‘çƒ§(Fever)æ‰æ˜¯çœŸçš„ã€‚å™ªéŸ³æˆ–æ¨¡å‹å…è®¸ä¸ç¡®å®šæ€§ï¼Œå³æ¯ä¸€ä¸ªçˆ¶èŠ‚ç‚¹éƒ½æœ‰å¯èƒ½è®©å­èŠ‚ç‚¹ä¸ºçœŸï¼Œå¯èƒ½çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»è¢«æŠ‘åˆ¶äº†(inhibited)ï¼Œå¯èƒ½ä¸€ä¸ªäººæ„Ÿå†’äº†ï¼Œä½†æ˜¯æ²¡æœ‰è¡¨ç°å‡ºå‘çƒ§ã€‚è¿™ä¸ªæ¨¡å‹åšäº†ä¸¤ä¸ªå‡è®¾ã€‚ç¬¬ä¸€ä¸ªï¼Œå®ƒå‡è®¾æ‰€æœ‰çš„åŸå› éƒ½è¢«åˆ—äº†å‡ºæ¥ï¼Œæœ‰æ—¶å€™ä¼šåŠ ä¸€ä¸ªèŠ‚ç‚¹(leak node)åŒ…å«æ‰€æœ‰çš„å…¶ä»–åŸå› (miscellaneous causes)ã€‚ç¬¬äºŒä¸ªï¼ŒæŠ‘åˆ¶æ¯ä¸€ä¸ªçˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ä¹‹é—´çš„åŸå› æ˜¯ç‹¬ç«‹çš„ï¼Œæ¯”å¦‚æŠ‘åˆ¶ç–Ÿç–¾äº§ç”Ÿå‘çƒ§å’ŒæŠ‘åˆ¶æ„Ÿå†’äº§ç”Ÿå‘çƒ§çš„åŸå› æ˜¯ç‹¬ç«‹çš„ã€‚æ‰€ä»¥ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰çš„çˆ¶èŠ‚ç‚¹éƒ½æ˜¯å‡çš„æ—¶å€™ï¼Œå‘çƒ§æ‰ä¸€å®šä¸ä¼šå‘ç”Ÿã€‚ç»™å‡ºä»¥ä¸‹çš„å‡è®¾ï¼š<br>
$q_{cold} = P(\neg fever| cold,\neg flu, \neg malaria) = 0.6$<br>
$q_{flu} = P(\neg fever|\neg cold, flu, \neg malaria) = 0.2$<br>
$q_{malaria} = P(\neg fever|\neg cold,\neg flu, malaria) = 0.1$<br>
æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œä»¥åŠå™ªéŸ³æˆ–çš„å‡è®¾ï¼Œæ•´ä¸ªCPTå¯ä»¥è¢«åˆ›å»ºã€‚ä¸€èˆ¬çš„è§„åˆ™æ˜¯ï¼š<br>
$P(x_i|parents(X_i)) = 1 - \prod_{j:X_j=ture} q_j.$<br>
æœ€åç”Ÿæˆå¦‚ä¸‹çš„è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">Cold</th>
<th style="text-align:center">Flu</th>
<th style="text-align:center">Malaria</th>
<th style="text-align:center">P(Fever)</th>
<th style="text-align:center">P($\neg$Fever)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">F</td>
<td style="text-align:center">F</td>
<td style="text-align:center">$0.0$</td>
<td style="text-align:center">$1.0$</td>
</tr>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">F</td>
<td style="text-align:center">T</td>
<td style="text-align:center">$0.9$</td>
<td style="text-align:center">$0.1$</td>
</tr>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">T</td>
<td style="text-align:center">F</td>
<td style="text-align:center">$0.8$</td>
<td style="text-align:center">$0.2$</td>
</tr>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">T</td>
<td style="text-align:center">T</td>
<td style="text-align:center">$0.98$</td>
<td style="text-align:center">$0.1\times 0.2=0.02$</td>
</tr>
<tr>
<td style="text-align:center">T</td>
<td style="text-align:center">F</td>
<td style="text-align:center">F</td>
<td style="text-align:center">$0.4$</td>
<td style="text-align:center">$0.6$</td>
</tr>
<tr>
<td style="text-align:center">T</td>
<td style="text-align:center">F</td>
<td style="text-align:center">T</td>
<td style="text-align:center">$0.94$</td>
<td style="text-align:center">$0.6\times 0.1 = 0.06 $</td>
</tr>
<tr>
<td style="text-align:center">T</td>
<td style="text-align:center">T</td>
<td style="text-align:center">F</td>
<td style="text-align:center">$0.88$</td>
<td style="text-align:center">$0.5\times 0.2 = 0.12 $</td>
</tr>
<tr>
<td style="text-align:center">T</td>
<td style="text-align:center">T</td>
<td style="text-align:center">T</td>
<td style="text-align:center">$0.988$</td>
<td style="text-align:center">$0.6\times 0.2\times 0.1 = 0.012$</td>
</tr>
</tbody>
</table>
<p>å¯¹äºè¿™ä¸ªè¡¨ï¼Œæ„Ÿè§‰è‡ªå·±ä¸€ç›´æœ‰ç‚¹è½¬ä¸è¿‡æ¥åœˆã€‚å°±æ˜¯æœ‰ç—‡çŠ¶ä¸ä¸€å®šå‘çƒ§ï¼Œä¹Ÿå¯èƒ½ä¸å‘çƒ§ï¼Œæ²¡æœ‰ç—‡çŠ¶ä¸€å®šä¸å‘çƒ§ã€‚ä»€ä¹ˆæ—¶å€™ä¸å‘çƒ§å‘¢ï¼Œåªæœ‰æŸä¸ªç—‡çŠ¶è¡¨ç°å‡ºæ¥ä¸å‘çƒ§ï¼Œå¦‚æœå¤šä¸ªç—‡çŠ¶çš„è¯ï¼Œç›´æ¥æŠŠæœ‰ç—‡çŠ¶è¡¨ç°ä½†ä¸å‘çƒ§çš„æ¦‚ç‡ç›¸ä¹˜ã€‚<br>
ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå™ªå£°é€»è¾‘æ¨¡å‹ä¸­ï¼Œæœ‰$k$ä¸ªçˆ¶èŠ‚ç‚¹çš„å˜é‡å¯ä»¥ç”¨$O(k)$ä¸ªå‚æ•°è¡¨ç¤ºè€Œä¸æ˜¯$O(2^k)$å»è¡¨ç¤ºæ•´ä¸ªCPTã€‚è¿™è®©è®¿é—®(assessment)å’Œå­¦ä¹ (learning)æ›´å®¹æ˜“äº†ã€‚</p>
<h3 id="è¿ç»­æ€§éšæœºå˜é‡çš„è´å¶æ–¯ç½‘ç»œ-bayesian-nets-with-continuous-variables">è¿ç»­æ€§éšæœºå˜é‡çš„è´å¶æ–¯ç½‘ç»œ(Bayesian nets with continuous variables)</h3>
<h4 id="å¸¸ç”¨æ–¹æ³•">å¸¸ç”¨æ–¹æ³•</h4>
<p>ç°å®ä¸­å¾ˆå¤šé—®é¢˜éƒ½æ˜¯è¿ç»­å‹çš„éšæœºå˜é‡ï¼Œå®ƒä»¬æœ‰æ— æ•°å¯èƒ½çš„å–å€¼ï¼Œæ‰€ä»¥æ˜¾å¼çš„æŒ‡å®šæ¯ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡è¡Œä¸é€šã€‚å¸¸ç”¨çš„æ€»å…±æœ‰ä¸‰ç§æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå¯èƒ½çš„æ–¹æ³•æ˜¯ç¦»æ•£(discretization)è¿ç»­å‹éšæœºå˜é‡ï¼Œå°†éšæœºå˜é‡çš„å¯èƒ½å–å€¼åˆ’åˆ†æˆå›ºå®šçš„åŒºé—´ã€‚æ¯”å¦‚ï¼Œæ¸©åº¦å¯ä»¥åˆ†æˆï¼Œå°äº$0$åº¦çš„ï¼Œ$0$åº¦åˆ°$100$åº¦ä¹‹é—´çš„ï¼Œå¤§äº$100$åº¦çš„ã€‚ç¦»æ•£æœ‰æ—¶å€™æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯é€šå¸¸ä¼šé€ æˆç²¾åº¦çš„ç¼ºå¤±å’Œéå¸¸å¤§çš„CPTã€‚ç¬¬äºŒä¸ªæ–¹æ³•ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯é€šè¿‡æŒ‡å®šæ ‡å‡†æ¦‚ç‡å¯†åº¦å‡½æ•°çš„å‚æ•°ï¼Œæ¯”å¦‚æŒ‡å®šé«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ã€‚ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯éå‚æ•°åŒ–(nonparametric)è¡¨ç¤ºï¼Œç”¨éšå¼çš„è·ç¦»å»å®šä¹‰æ¡ä»¶åˆ†å¸ƒã€‚</p>
<h4 id="ç¤ºä¾‹-v2">ç¤ºä¾‹</h4>
<p>ä¸€ä¸ªåŒæ—¶æ‹¥æœ‰ç¦»æ•£å‹å’Œéšæœºæ€§å˜é‡çš„ç½‘ç»œè¢«ç§°ä¸ºæ··åˆè´å¶æ–¯ç½‘ç»œ(hybrid Bayesian network)ã€‚ä¸ºäº†åˆ›å»ºè¿™æ ·ä¸€ä¸ªç½‘ç»œï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ç§æ–°çš„åˆ†å¸ƒã€‚ä¸€ç§æ˜¯ç»™å®šç¦»æ•£æˆ–è€…è¿ç»­çš„çˆ¶èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹æ˜¯è¿ç»­å‹éšæœºå˜é‡çš„æ¡ä»¶æ¦‚ç‡ï¼Œå¦ä¸€ç§æ˜¯ç»™å®šè¿ç»­çš„çˆ¶èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹æ˜¯ç¦»æ•£å‹éšæœºå˜é‡çš„æ¡ä»¶æ¦‚ç‡ã€‚</p>
<h5 id="è¿ç»­å‹å­èŠ‚ç‚¹">è¿ç»­å‹å­èŠ‚ç‚¹</h5>
<p><img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.5"><br>
è€ƒè™‘Figure 14.5çš„ä¾‹å­ï¼Œä¸€ä¸ªé¡¾å®¢ä¹°äº†ä¸€äº›æ°´æœï¼Œä¹°æ°´æœçš„é‡å–å†³å–æ°´æœçš„ä»·æ ¼(Cost)ï¼Œæ°´æœçš„ä»·æ ¼å–å†³äºæ”¶æˆ(Harvest)å’Œæ”¿åºœæ˜¯å¦æœ‰è¡¥åŠ©(Subsidy)ã€‚å…¶ä¸­ï¼ŒCostæ˜¯è¿ç»­å‹éšæœºå˜é‡ï¼Œä»–æœ‰è¿ç»­çš„çˆ¶èŠ‚ç‚¹Harvestå’Œç¦»æ•£çš„çˆ¶èŠ‚ç‚¹Subsidyï¼ŒBuysæ˜¯ç¦»æ•£çš„ï¼Œæœ‰ä¸€ä¸ªè¿ç»­å‹çš„çˆ¶èŠ‚ç‚¹Costã€‚<br>
å¯¹äºå˜é‡Costï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šæ¡ä»¶æ¦‚ç‡$P(Cost|Subsidy,Harvest)$ã€‚ç¦»æ•£çš„çˆ¶èŠ‚ç‚¹é€šè¿‡æšä¸¾(enumeration)æ¥è¡¨ç¤ºï¼ŒæŒ‡å®š$P(Cost|subsidy,Harvest)$å’Œ$P(Cost|\neg subsidy,Harvest)$ã€‚ä¸ºäº†è¡¨ç¤ºHarvestï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªåˆ†å¸ƒæ¥è¡¨ç¤ºå˜é‡Costçš„å€¼$c$å–å†³äºè¿ç»­æ€§éšæœºå˜é‡Harvestçš„å€¼$h$ã€‚æ¢å¥è¯è¯´ï¼Œå°†$c$çœ‹åšä¸€ä¸ª$h$çš„å‡½æ•°ï¼Œç„¶åç»™å‡ºè¿™ä¸ªå‡½æ•°çš„å‚æ•°å³å¯ï¼Œæœ€å¸¸ç”¨çš„æ˜¯çº¿æ€§é«˜æ–¯åˆ†å¸ƒã€‚æ¯”å¦‚è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ä¸ªä¸åŒå‚æ•°çš„é«˜æ–¯åˆ†å¸ƒæ¥è¡¨ç¤ºæœ‰è¡¥è´´å’Œæ²¡è¡¥è´´æ—¶Harvestå¯¹Costçš„å½±å“ï¼š<br>
$$P(c|h, subsidy) = N(a_th+b_t,\sigma_t^2)Â© = \frac{1}{\sigma_t \sqrt{2\pi} }e^{- \frac{1}{2}(\frac{c-(a_th+b_t)}{\sigma_t})^2}$$<br>
$$P(c|h,\neg subsidy) = N(a_fh+b_t,\sigma_f^2)Â© = \frac{1}{\sigma_f \sqrt{2\pi} }e^{- \frac{1}{2}(\frac{c-(a_fh+b_f)}{\sigma_f})^2}$$<br>
æ‰€ä»¥ï¼Œåªéœ€è¦ç»™å‡º$a_t,b_t,\sigma_t,a_f,b_f,\sigma_f$è¿™å‡ ä¸ªå‚æ•°å°±è¡Œäº†ï¼ŒFigure 14.6(a)å’Œ(b)å°±æ˜¯ä¸€ä¸ªç¤ºä¾‹å›¾ã€‚æ³¨æ„åˆ°å¡åº¦(slope)æ˜¯è´Ÿçš„ï¼Œå› ä¸ºéšç€ä¾›åº”çš„å¢åŠ ï¼Œcoståœ¨ä¸‹é™ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªçº¿æ€§æ¨¡å‹åªæœ‰åœ¨harveståœ¨å¾ˆå°çš„ä¸€ä¸ªåŒºé—´å†…æ‰æˆç«‹ï¼Œè€Œä¸”costæœ‰å¯èƒ½ä¸ºè´Ÿã€‚å‡è®¾æœ‰è¡¥è´´å’Œæ²¡è¡¥è´´çš„ä¸¤ç§å¯èƒ½æ€§ç›¸ç­‰ï¼Œæ˜¯$0.5$ï¼Œé‚£ä¹ˆå°±æœ‰äº†Figure 14.6Â©çš„å›¾$P(c|h)$ã€‚</p>
<h5 id="è¿ç»­å‹çˆ¶èŠ‚ç‚¹">è¿ç»­å‹çˆ¶èŠ‚ç‚¹</h5>
<p>å½“ç¦»æ•£å‹éšæœºå˜é‡æœ‰è¿ç»­å‹çˆ¶èŠ‚ç‚¹æ—¶ï¼Œå¦‚Figure 14.5ä¸­çš„BuysèŠ‚ç‚¹ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªåˆç†çš„å‡è®¾æ˜¯ï¼šå½“costé«˜çš„æ—¶å€™ï¼Œä¸ä¹°ï¼Œcoståº•çš„æ—¶å€™ï¼Œä¹°ï¼Œåœ¨ä¸­é—´åŒºåŸŸä¹°ä¸ä¹°æ˜¯ä¸€ä¸ªå˜åŒ–å¾ˆå¹³æ»‘çš„æ¦‚ç‡ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ¡ä»¶åˆ†å¸ƒå½“æˆä¸€ä¸ªè½¯é˜ˆå€¼å‡½æ•°(soft-threshold)ï¼Œä¸€ç§æ–¹å¼æ˜¯ç”¨æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„ç§¯åˆ†(intergral)ã€‚<br>
$$\Phi(x) = \int_{-\infty}^{x} N(0,1)(x)dx$$<br>
ç»™å®šCostä¹°çš„æ¦‚ç‡å¯èƒ½æ˜¯:<br>
$$P(buys|Cost = c) = \Phi((-x+\nu)/ \sigma))$$<br>
å…¶ä¸­costçš„é˜ˆå€¼åœ¨$\nu$é™„è¿‘ï¼Œé˜ˆå€¼çš„åŒºåŸŸå’Œæ­£æ¯”äº$\sigma$ï¼Œå½“ä»·æ ¼å‡é«˜çš„æ—¶å€™ï¼Œä¹°çš„æ¦‚ç‡ä¼šä¸‹é™ã€‚è¿™ä¸ªprobit distributionæ¨¡å‹å¦‚Figure 14.7(a)æ‰€ç¤ºã€‚<br>
å¦ä¸€ä¸ªå¯é€‰æ‹©çš„æ¨¡å‹æ˜¯logit distributionï¼Œä½¿ç”¨logistic function $1/(1+e^{-x})$æ¥ç”Ÿæˆä¸€ä¸ªè½¯é˜ˆå€¼ï¼š<br>
$$P(buys|Cost = c) = \frac{1}{1+exp(-2\frac{-c+u}{\sigma})}.$$<br>
å¦‚Figure 14.7(b)æ‰€ç¤ºï¼Œè¿™ä¸¤ä¸ªåˆ†å¸ƒå¾ˆåƒï¼Œä½†æ˜¯logitæœ‰æ›´é•¿çš„å°¾å·´ã€‚probitæ›´ç¬¦åˆå®é™…æƒ…å†µï¼Œä½†æ˜¯logitæ•°å­¦ä¸Šæ›´å¥½ç®—ã€‚å®ƒä»¬éƒ½å¯ä»¥é€šè¿‡å¯¹çˆ¶èŠ‚ç‚¹è¿›è¡Œçº¿æ€§ç»„åˆæ¨å¹¿åˆ°å¤šä¸ªè¿ç»­æ€§çˆ¶èŠ‚ç‚¹çš„æƒ…å†µã€‚</p>
<h2 id="è´å¶æ–¯ç½‘ç»œçš„ç²¾ç¡®æ¨ç†-exact-inference-in-bayesian-networks">è´å¶æ–¯ç½‘ç»œçš„ç²¾ç¡®æ¨ç†(Exact inference in bayesian networks)</h2>
<p>æ¦‚ç‡æ¨ç†ç³»ç»Ÿçš„åŸºæœ¬ä»»åŠ¡å°±æ˜¯ç»™å‡ºä¸€äº›è§‚å¯Ÿåˆ°çš„äº‹ä»¶ï¼Œå³ç»™è¯æ®å˜é‡(evidence variable)èµ‹å€¼ï¼Œç„¶åè®¡ç®—ä¸€ç³»åˆ—æŸ¥è¯¢å˜é‡(query variable)çš„åéªŒæ¦‚ç‡ã€‚æˆ‘ä»¬ç”¨$X$è¡¨ç¤ºæŸ¥è¯¢å˜é‡ï¼Œç”¨$\mathbf{E}$è¡¨ç¤ºè¯æ®å˜é‡$E_1,\cdots,E_m$çš„é›†åˆï¼Œ$\mathbf{e}$æ˜¯ä¸€ä¸ªç‰¹å®šçš„è§‚æµ‹äº‹ä»¶ï¼Œ$\mathbf{Y}$è¡¨ç¤ºæ—¢ä¸æ˜¯è¯æ®å˜é‡ï¼Œä¹Ÿä¸æ˜¯æŸ¥è¯¢å˜é‡çš„å˜é‡$Y_1,\cdots,Y_l$çš„é›†åˆï¼ˆéšå˜é‡,hidden variables)ã€‚å˜é‡çš„æ‰€æœ‰é›†åˆæ˜¯$\mathbf{X}={X}\cup \mathbf{E}\cup \mathbf{Y}$ã€‚ä¸€ä¸ªå…¸å‹çš„æŸ¥è¯¢æ˜¯æ±‚åéªŒæ¦‚ç‡$P(X|\mathbf{e})$ã€‚<br>
åœ¨è¿™ä¸€èŠ‚ä¸­ä¸»è¦è®¨è®ºçš„æ˜¯è®¡ç®—åéªŒæ¦‚ç‡çš„ç²¾ç¡®ç®—æ³•ä»¥åŠè¿™äº›ç®—æ³•çš„å¤æ‚åº¦ã€‚äº‹å®ä¸Šï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ç²¾ç¡®æ¨ç†çš„å¤æ‚åº¦éƒ½æ˜¯å¾ˆé«˜çš„ï¼Œä¸ºäº†é™ä½å¤æ‚åº¦ï¼Œå°±åªèƒ½è¿›è¡Œä¼°è®¡æ¨ç†(approximate inference)äº†ï¼Œè¿™ä¸ªä¼šåœ¨ä¸‹ä¸€èŠ‚ä¸­ä»‹ç»åˆ°ã€‚</p>
<h3 id="æšä¸¾å®ç°ç²¾ç¡®æ¨ç†-inference-by-enumeration">æšä¸¾å®ç°ç²¾ç¡®æ¨ç†(Inference by enumeration)</h3>
<p>ä»»ä½•æ¡ä»¶æ¦‚ç‡éƒ½å¯ä»¥ç”¨è”åˆæ¦‚ç‡åˆ†å¸ƒçš„é¡¹ç›¸åŠ å¾—åˆ°ï¼Œå³ï¼š<br>
$$P(X|\mathbf{e}) = \alpha P(X,\mathbf{e}) = \alpha \sum_{\mathbf{y}}P(X,\mathbf{e},\mathbf{y})$$<br>
è´å¶æ–¯ç½‘ç»œç»™å‡ºäº†æ‰€æœ‰çš„è”åˆæ¦‚ç‡åˆ†å¸ƒï¼Œä»»ä½•é¡¹$P(x,\mathbf{e},\mathbf{y})$éƒ½å¯ä»¥ç”¨è´å¶æ–¯ç½‘ç»œä¸­çš„æ¡ä»¶æ¦‚ç‡çš„ä¹˜ç§¯è¡¨ç¤ºå‡ºæ¥ã€‚æ¯”å¦‚è­¦æŠ¥ä¾‹å­ä¸­çš„æŸ¥è¯¢$P(Burglary|JohnCalls=true,MaryCalls=true)$ã€‚éšå˜é‡æ˜¯Earthquakeå’ŒAlarmï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡ºï¼š<br>
$$P(B|j,m) = \alpha P(B,j,m) = \alpha \sum_{e}\sum_{a}P(B,j,m,e,a).$$<br>
è´å¶æ–¯ç½‘ç»œå·²ç»ç»™å‡ºäº†æ‰€æœ‰CPTé¡¹çš„è¡¨è¾¾å¼ï¼Œæ¯”å¦‚å½“Burglary = trueæ—¶ï¼š<br>
$$P(b|j,m) = \alpha \sum_e\sum_aP(b,j,m,e,a) = \alpha \sum_e\sum_aP(b)P(e)P(a|b,e)P(j|a)P(m|a).$$<br>
ä¸ºäº†è®¡ç®—è¿™ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¾—è®¡ç®—ä¸€ä¸ªå››é¡¹çš„åŠ æ³•ï¼Œåˆ†åˆ«æ˜¯eä¸ºtrueå’Œfalse,aä¸ºtrueå’Œfalseå¯¹åº”çš„$P(b,j,m)$çš„å€¼ï¼Œæ¯ä¸€é¡¹éƒ½æ˜¯äº”ä¸ªæ•°çš„ä¹˜æ³•ã€‚æœ€åçš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„å˜é‡éƒ½ç”¨åˆ°äº†ï¼Œé‚£ä¹ˆæ‹¥æœ‰$n$ä¸ªå¸ƒå°”å˜é‡çš„è´å¶æ–¯ç½‘ç»œçš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n2^n)$ã€‚æˆ‘ä»¬å¯ä»¥åšä¸€äº›ç®€åŒ–ï¼Œå°†ä¸€äº›é‡å¤çš„è®¡ç®—ä¿å­˜ä¸‹æ¥ï¼Œæ¯”å¦‚å°†ä¸Šé¢çš„å¼å­å˜æˆï¼š<br>
$$P(b|j,m) = \alpha \sum_e\sum_aP(b,j,m,e,a) = \alpha P(b) \sum_eP(e)\sum_aP(a|b,e)P(j|a)P(m|a).$$<br>
è¿™æ ·å­å¯ä»¥æŒ‰ç…§é¡ºåºè¿›è¡Œè®¡ç®—ï¼Œå…·ä½“çš„è®¡ç®—è¿‡ç¨‹å¦‚Figure 14.8æ‰€ç¤ºã€‚è¿™ç§ç®—æ³•å«åšENUMERATION-ASKï¼Œå®ƒçš„ç©ºé—´å¤æ‚åº¦æ˜¯çº¿æ€§çš„ï¼Œä½†æ˜¯å®ƒçš„äº‹ä»¶å¤æ‚åº¦æ˜¯$O(2<sup>n)$æ¯”$O(n2</sup>n)$è¦å¥½ï¼Œå´ä»ç„¶æ˜¯å®é™…ä¸Šä¸å¯è¡Œçš„ã€‚ï¼ˆè¿™é‡Œæˆ‘ç†è§£çš„æ˜¯$O(2<sup>n)$è€Œä¸æ˜¯$O(n2</sup>n)$çš„åŸå› æ˜¯ï¼Œæ€»å…±æœ‰$n$ä¸ªå¸ƒå°”å˜é‡ï¼Œæ‰€ä»¥æ€»å…±æœ‰$2^n$ä¸ªå¯èƒ½çš„å–å€¼ï¼Œæ¯æ¬¡ç®—ä¸€ä¸ªï¼Œå­˜ä¸€ä¸ªï¼Œè€ŒåŸæ¥çš„æ˜¯ç®—å®Œä¹‹åä¸å­˜ã€‚ï¼‰<br>
äº‹å®ä¸Šï¼ŒFigure 14.8ä¸­çš„è®¡ç®—è¿‡ç¨‹è¿˜æœ‰å¾ˆå¤šé‡å¤è®¡ç®—ï¼Œæ¯”å¦‚$P(j|a)P(m|a)$å’Œ$P(j|\neg a)P(m|\neg a)$è¿™ä¸¤é¡¹è¢«è®¡ç®—äº†ä¸¤æ¬¡ã€‚æˆ‘åŸæ¥åœ¨æƒ³è¿™é‡Œæ˜¯ä¸æ˜¯å’Œä¸Šé¢ä¸€æ®µè¯´çš„å†²çªäº†ï¼Œäº‹å®ä¸Šæ˜¯æ²¡æœ‰çš„ï¼Œè¿™$2^n$ä¸ªå€¼ï¼Œå…¶ä¸­å¯èƒ½ä¼šæœ‰$P(b,j,m,e,a)$å’Œ$P(b,j,m,e,\neg a)$ï¼Œè¿™ä¸¤ä¸ªæ¦‚ç‡ä¸­éƒ½ç”¨åˆ°äº†$P(j|a)P(m|a)$ï¼Œä½†æ˜¯è¿™é‡Œå°±ä¼šè®¡ç®—ä¸¤æ¬¡ï¼Œäº‹å®ä¸Šæœ‰å¾ˆå¤šå€¼éƒ½ä¼šè¢«é‡å¤è®¡ç®—å¾ˆå¤šæ¬¡ã€‚ä¸‹é¢å°±ä»‹ç»ä¸€ä¸ªé¿å…è¿™ç§è¿ç®—çš„æ–¹æ³•ã€‚</p>
<h3 id="æ¶ˆå…ƒæ³•-the-variable-elimination-algorithm">æ¶ˆå…ƒæ³•(The variable elimination algorithm)</h3>
<p>ä¸Šé¢é—®é¢˜çš„è§£å†³æ€è·¯å°±æ˜¯ä¿å­˜å·²ç»è®¡ç®—è¿‡çš„å€¼ï¼Œå®é™…ä¸Šè¿™æ˜¯ä¸€ç§åŠ¨æ€è§„åˆ’ã€‚è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™é‡Œä»‹ç»äº†æœ€ç®€å•çš„æ¶ˆå…ƒç®—æ³•ã€‚æ¶ˆå…ƒæ³•å¯¹è¡¨è¾¾å¼è¿›è¡Œä»å³è‡³å·¦çš„è®¡ç®—ï¼Œè€Œæšä¸¾æ³•æ˜¯è‡ªåº•å‘ä¸Šçš„ã€‚æ‰€æœ‰çš„ä¸­é—´å€¼è¢«æŠ¥å­˜èµ·æ¥ï¼Œæœ€å¯¹å’Œæ¯ä¸ªå˜é‡æœ‰å…³çš„è¡¨è¾¾å¼è¿›è¡Œæ±‚å’Œã€‚ä¾‹å¦‚å¯¹äºä¸‹åˆ—è¡¨è¾¾å¼ï¼š<br>
$$P(B|j,m) = \alpha \underbrace{P(B)}<em>{f_1(B)} \sum_e\underbrace{P(e)}</em>{f_2(E)} \sum_a\underbrace{P(a|B,e)}<em>{f_3(A,B,E)} \underbrace{P(j|a)}</em>{f_4(A)} \underbrace{P(m|a)}_{f_5(A)}.$$<br>
è¡¨è¾¾å¼çš„æ¯ä¸€éƒ¨åˆ†éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å› å­ï¼Œæ¯ä¸€ä¸ªå› å­éƒ½æ˜¯ç”±å®ƒçš„å‚æ•°å˜é‡(argument variables)å†³å®šçš„çŸ©é˜µï¼Œå‚æ•°å˜é‡æŒ‡å®šçš„å–å€¼æ˜¯æ²¡æœ‰å›ºå®šçš„å˜é‡ã€‚æ¯”å¦‚å› å­$f_4(A)$å’Œ$f_5(A)$å¯¹åº”$P(j|a)$å’Œ$P(m|a)$çš„è¡¨è¾¾å¼åªå–å†³äº$A$çš„å€¼å› ä¸º$J$å’Œ$M$åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­éƒ½æ˜¯å›ºå®šçš„ã€‚å®ƒä»¬éƒ½æ˜¯ä¸¤ä¸ªå…ƒç´ çš„å‘é‡ï¼š<br>
$$f_4(A) = \begin{pmatrix}P(j|a)\P(j|\neg a)\end{pmatrix} = \begin{pmatrix}0.90\0.05\end{pmatrix}$$<br>
$$f_5(A) = \begin{pmatrix}P(m|a)\P(m|\neg a)\end{pmatrix} = \begin{pmatrix}0.70\0.01\end{pmatrix}$$<br>
$f_3(A,B,E)$æ˜¯ä¸€ä¸ª$2\times 2\times 2$çš„çŸ©é˜µã€‚ç”¨å› å­è¡¨è¾¾çš„è¯ï¼ŒæŸ¥è¯¢çš„è¡¨è¾¾å¼å˜æˆäº†ï¼š<br>
$$P(B|j,m) = \alpha f_1(B)\times \sum_ef_2(E)\times \sum_af_3(A,B,E)\times f_4(A)\times f_5(A)$$<br>
å…¶ä¸­$\times$ä¸æ˜¯æ™®é€šçš„çŸ©é˜µä¹˜æ³•ï¼Œè€Œæ˜¯å¯¹åº”å…ƒç´ ç›¸ä¹˜(pointwise product)ã€‚æ•´ä¸ªè¡¨è¾¾å¼çš„è®¡ç®—è¿‡ç¨‹å¯ä»¥çœ‹æˆä»å³åˆ°å·¦å˜é‡ç›¸åŠ çš„è¿‡ç¨‹ï¼Œå°†ç°æœ‰çš„å› å­æ¶ˆå»äº§ç”Ÿæ–°çš„å› å­ï¼Œæœ€ååªå‰©ä¸‹ä¸€ä¸ªå› å­çš„è¿‡ç¨‹ã€‚å…·ä½“çš„æ­¥éª¤å¦‚ä¸‹ï¼š<br>
é¦–å…ˆå…ˆåˆ©ç”¨$f_3,f_4,f_5$æŠŠå˜é‡$A$æ¶ˆæ‰ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„$2\times 2$çš„åªå«æœ‰å˜é‡$B$å’Œ$E$çš„æ–°å› å­$f_6(B,E)$ï¼š<br>
\begin{align*}<br>
f_6(B,E) &amp;= \sum_af_3(A,B,E)\times f_4(A) \times f_5(A)\<br>
&amp;= (f_3(a,B,E)\times f_4(a) \times f_5(a)) + (f_3(\neg a,B,E)\times f_4(\neg a)\times f_5(\neg a)<br>
\end{align*}<br>
è¿™æ ·ç›®æ ‡å˜æˆäº†ï¼š<br>
$$P(B|j,m) = \alpha f_1(B)\times \sum_ef_2(E)\times \sum_af_6(B,E)$$<br>
åˆ©ç”¨$f_2,f_6$æ¶ˆå»$E$ï¼š<br>
\begin{align*}<br>
f_7(B) &amp;= \sum_ef_2(E)\times \sum_af_6(B,E)\<br>
&amp; = f_2(e)\times f_6(B,e) + f_2(\neg e)\times f_6(B,\neg e)<br>
\end{align*}<br>
å°†è¡¨è¾¾å¼åŒ–æˆï¼š<br>
$$P(B|j,m) = \alpha f_1(B)\times f_7(B)$$<br>
æ˜¾ç„¶ï¼Œæ ¹æ®è¿™ä¸ªè¡¨è¾¾å¼å°±å¯ä»¥è®¡ç®—å‡ºæˆ‘ä»¬æƒ³è¦çš„ç»“æœäº†ã€‚ä¸Šé¢çš„è¿‡ç¨‹å¯ä»¥æ€»ç»“æˆä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯point-wiseçš„å› å­ä¹˜æ³•ï¼Œç¬¬äºŒæ­¥æ˜¯åˆ©ç”¨å› å­çš„ä¹˜æ³•è¿›è¡Œæ¶ˆå…ƒã€‚</p>
<h4 id="å› å­è¿ç®—-operations-on-factors">å› å­è¿ç®—(Operations on factors)</h4>
<p>ä¸¤ä¸ªå› å­$f_1$å’Œ$f_2$è¿›è¡Œpoint-wiseä¹˜æ³•è¿ç®—äº§ç”Ÿæ–°çš„å› å­(factor)$f$çš„å˜é‡æ˜¯$f_1$å’Œ$f_2$å˜é‡çš„å¹¶ï¼Œæ–°çš„å› å­ä¸­çš„å…ƒç´ çš„å€¼æ˜¯$f_1$å’Œ$f_2$ä¸­å¯¹åº”é¡¹çš„ç§¯ã€‚å‡è®¾ä¸¤ä¸ªå› å­æœ‰å…¬å…±å˜é‡$Y_1,\cdots,Y_k$ï¼Œé‚£ä¹ˆå°±æœ‰ï¼š<br>
$$f(X_1,\cdots,X_j,Y_1,\cdots,Y_k,Z_1,\cdots,Z_l)=f_1(X_1,\cdots,X_j,Y_1,\cdots,Y_k)f_2(Y_1,\cdots,Y_k,Z_1,\cdots,Z_l).$$<br>
å¦‚æœæ‰€æœ‰çš„å˜é‡éƒ½æ˜¯äºŒå€¼åŒ–çš„ï¼Œé‚£ä¹ˆ$f_1$å’Œ$f_2$å„æœ‰$2<sup>{j+l}$å’Œ$2</sup>{l+k}$é¡¹ï¼Œ$f$æœ‰$2^{j+l+k}$é¡¹ã€‚æ¯”å¦‚ï¼Œ$f_1(A,B),f_2(B,C)$ï¼Œé‚£ä¹ˆpoint-wiseä¹˜æ³•äº§ç”Ÿçš„$f_3(A,B,C)=f_1\times f_2$æœ‰$8$é¡¹ï¼Œå¦‚Figure 14.10æ‰€ç¤ºã€‚<br>
<img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.10"><br>
æ ¹æ®å›¾ä¸­ç»™å‡ºçš„å€¼ï¼Œæ¶ˆå»$f_3(A,B,C)$ä¸­çš„$A$ï¼š<br>
\begin{align*}<br>
f(B,C) &amp;= \sum_af_3(A,B,C)\<br>
&amp;= f_3(a,B,C) + f_3(\neg a,B,C)\<br>
&amp;= \begin{pmatrix} 0.06&amp;0.24\0.42&amp;0.28\end{pmatrix} + \begin{pmatrix}0.18&amp;0.72\0.06&amp;0.04\end{pmatrix}\<br>
&amp;= \begin{pmatrix}0.24&amp;0.96\048&amp;0.32\end{pmatrix}<br>
\end{align*}<br>
äº§ç”Ÿæ–°çš„å› å­ç”¨çš„æ˜¯pointwiseä¹˜æ³•ï¼Œæ¶ˆå…ƒç”¨çš„æ˜¯ç´¯ä¹˜ã€‚ç»™å®špointwiseä¹˜æ³•å’Œæ¶ˆå…ƒå‡½æ•°ï¼Œæ¶ˆå…ƒç®—æ³•å°±å˜å¾—å¾ˆç®€å•ï¼Œä¸€ä¸ªæ¶ˆå…ƒç®—æ³•å¦‚Figure 14.11æ‰€ç¤ºã€‚<br>
<img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.11"></p>
<h4 id="å˜é‡é¡ºåºå’Œå˜é‡ç›¸å…³æ€§-variable-ordering-and-variable-relevance">å˜é‡é¡ºåºå’Œå˜é‡ç›¸å…³æ€§(Variable ordering and variable relevance)</h4>
<p>Figure 14.11ä¸­çš„ç®—æ³•åŒ…å«ä¸€ä¸ªæ²¡æœ‰ç»™å‡ºå…·ä½“å®ç°çš„æ’åºå‡½æ•°Order()å¯¹è¦æ¶ˆå»çš„å˜é‡è¿›è¡Œæ’åºï¼Œæ¯ä¸€ç§æ’åºé€‰æ‹©éƒ½ä¼šäº§ç”Ÿä¸€ç»„æœ‰æ•ˆçš„ç®—æ³•ï¼Œä½†æ˜¯ä¸åŒçš„æ¶ˆå…ƒé¡ºåºä¼šäº§ç”Ÿä¸åŒçš„ä¸­é—´å› å­ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¶ˆå…ƒæ³•çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦æ˜¯ç”±ç®—æ³•äº§ç”Ÿçš„æœ€å¤§å› å­å†³å®šçš„ï¼Œè¿™ä¸ªæœ€å¤§å› å­æ˜¯ç”±æ¶ˆå…ƒçš„é¡ºåºå’Œè´å¶æ–¯ç½‘ç»œçš„ç»“æ„å†³å®šçš„ï¼Œé€‰å–æœ€ä¼˜çš„æ¶ˆå…ƒé¡ºåºæ˜¯å¾ˆå›°éš¾çš„ï¼Œä½†æ˜¯æœ‰ä¸€äº›å°çš„æŠ€å·§ï¼šæ€»æ˜¯æ¶ˆå»è®©æ–°äº§ç”Ÿçš„å› å­æœ€å°çš„å˜é‡ã€‚<br>
å¦ä¸€ä¸ªå±æ€§æ˜¯ï¼šæ¯ä¸€ä¸ªä¸æ˜¯æŸ¥è¯¢å˜é‡æˆ–è€…è¯æ®å˜é‡çš„ç¥–å…ˆå˜é‡éƒ½å’Œè¿™æ¬¡æŸ¥è¯¢æ— å…³ï¼Œåœ¨å®ç°æ¶ˆå…ƒç®—æ³•çš„æ—¶å€™å¯ä»¥æŠŠè¿™äº›å˜é‡éƒ½å»æ‰ã€‚ï¼ˆå…·ä½“çš„ç¤ºä¾‹å¯ä»¥çœ‹ç¬¬åå››ç« ï¼Œåœ¨$528$é¡µï¼‰ã€‚</p>
<h3 id="ç²¾ç¡®æ¨ç†çš„å¤æ‚åº¦-the-complexity-of-exact-inference">ç²¾ç¡®æ¨ç†çš„å¤æ‚åº¦(The complexity of exact inference)</h3>
<p>è´å¶æ–¯ç½‘ç»œçš„ç²¾ç¡®æ¨ç†è·Ÿç½‘ç»œçš„ç»“æ„æœ‰å¾ˆå¤§çš„å…³ç³»ã€‚<br>
Figure 14.2ä¸­è­¦æŠ¥è´å¶æ–¯ç½‘ç»œä¸­çš„å¤æ‚åº¦æ˜¯çº¿æ€§çš„ã€‚è¯¥ç½‘ç»œä¸­ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€æ¡è·¯å¾„ï¼Œè¿™ç§ç½‘ç»œç§°ä¸ºå•è¿æ¥çš„(singly-connected)æˆ–è€…å¤šæ ‘(polytrees)ï¼Œè¿™ç§ç»“æ„æœ‰ä¸€ä¸ªå¾ˆå¥½çš„å±æ€§å°±æ˜¯ï¼šå¤šæ ‘ç»“æ„ä¸­ç²¾ç¡®æ¨ç†çš„æ—¶é—´ï¼Œç©ºé—´å¤æ‚åº¦å¯¹äºç½‘ç»œå¤§å°æ¥è¯´éƒ½æ˜¯çº¿æ€§å…³ç³»ï¼Œè¿™é‡Œç½‘ç»œå¤§å°æŒ‡çš„æ˜¯CPTé¡¹çš„ä¸ªæ•°ã€‚å¦‚æœæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªæœ‰ç•Œçš„å¸¸æ•°ï¼Œé‚£ä¹ˆå¤æ‚åº¦å’ŒèŠ‚ç‚¹æ•°ä¹‹é—´ä¹Ÿæ˜¯çº¿æ€§å…³ç³»ã€‚<br>
å¯¹äºå¤šè¿æ¥(multiply connected)çš„ç½‘ç»œï¼Œå¦‚Figure 14.12(a)æ‰€ç¤ºï¼Œæœ€åæƒ…å†µä¸‹ï¼Œå³ä½¿æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸ªæ•°éƒ½æ˜¯æœ‰ç•Œå¸¸æ•°ï¼Œæ¶ˆå…ƒæ³•çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ä¹Ÿéƒ½æ˜¯æŒ‡æ•°çº§åˆ«çš„ã€‚å› ä¸ºè´å¶æ–¯ç½‘ç»œçš„æ¨ç†ä¹Ÿæ˜¯NPéš¾é—®é¢˜ã€‚<br>
<img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.12"></p>
<h3 id="èšç±»ç®—æ³•-clustering-algorithms">èšç±»ç®—æ³•(clustering algorithms)</h3>
<p>ç”¨æ¶ˆå…ƒæ³•æ¥è®¡ç®—å•ä¸ªçš„åéªŒæ¦‚ç‡æ˜¯ç®€å•è€Œé«˜æ•ˆçš„ï¼Œä½†æ˜¯å¦‚æœè¦è®¡ç®—ç½‘ç»œä¸­æ‰€æœ‰å˜é‡çš„åéªŒæ¦‚ç‡æ˜¯å¾ˆä½æ•ˆçš„ã€‚ä¾‹å¦‚ï¼šåœ¨å•è¿æ¥çš„ç½‘ç»œä¸­ï¼Œæ¯ä¸€ä¸ªæŸ¥è¯¢éƒ½æ˜¯$O(n)$ï¼Œæ€»å…±æœ‰$O(n)$ä¸ªæŸ¥è¯¢ï¼Œæ‰€ä»¥æ€»å…±çš„ä»£ä»·æ˜¯$O(n^2)$ã€‚ä½¿ç”¨èšç±»ç®—æ³•(clustering algorithms)ï¼Œä»£ä»·å¯ä»¥é™åˆ°$O(n)$ï¼Œå› æ­¤è´å¶æ–¯ç½‘ç»œä¸­çš„èšç±»ç®—æ³•å·²ç»è¢«å¹¿æ³›å•†ç”¨ã€‚ï¼ˆè¿™é‡Œä¸æ˜ç™½ä¸ºä»€ä¹ˆï¼Ÿï¼‰ã€‚<br>
èšç±»ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯å°†ç½‘ç»œä¸­çš„ä¸€äº›èŠ‚ç‚¹è¿æ¥æˆèšç‚¹(cluster nodes)ï¼Œæœ€åå½¢æˆä¸€ä¸ªå¤šæ ‘(polytree)ç»“æ„ã€‚ä¾‹å¦‚Figure 14.12(a)ä¸­çš„å¤šè¿æ¥ç½‘ç»œå¯ä»¥è½¬æ¢æˆFigure 14.12(b)æ‰€ç¤ºçš„å¤šæ ‘ï¼ŒSprinklerå’ŒRainèŠ‚ç‚¹å½¢æˆäº†SPrinkler+Rainèšç‚¹ï¼Œè¿™ä¸¤ä¸ªå¸ƒå°”å˜é‡è¢«ä¸€ä¸ªå¤§èŠ‚ç‚¹(meganode)å–ä»£ï¼Œè¿™ä¸ªå¤§èŠ‚ç‚¹æœ‰å››ä¸ªå¯èƒ½çš„å–å€¼ï¼š$tt,tf,ft,ff$ã€‚ä¸€æ—¦ä¸€ä¸ªå¤šæ ‘å½¢å¼çš„ç½‘ç»œç”Ÿæˆäº†ä»¥åï¼Œå°±éœ€è¦ç‰¹æ®Šçš„æ¨ç†ç®—æ³•è¿›è¡Œæ¨ç†äº†ï¼Œå› ä¸ºæ™®é€šçš„æ¨ç†ç®—æ³•ä¸èƒ½å¤„ç†å…±äº«å˜é‡çš„å¤§èŠ‚ç‚¹ï¼Œæœ‰äº†è¿™æ ·ä¸€ä¸ªç‰¹æ®Šçš„ç®—æ³•ï¼ŒåéªŒæ¦‚ç‡çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯çº¿æ€§äºèšç±»ç½‘ç»œçš„å¤§å°ã€‚ä½†æ˜¯ï¼ŒNPé—®é¢˜å¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œå¦‚æœæ¶ˆå…ƒéœ€è¦æŒ‡æ•°çº§åˆ«çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ï¼Œèšç±»ç½‘ç»œä¸­çš„CPTä¹Ÿæ˜¯æŒ‡æ•°çº§åˆ«å¤§å°ã€‚</p>
<h2 id="è´å¶æ–¯ç½‘ç»œçš„ä¼°è®¡æ¨ç†-approximate-inference-in-bayesian-networks">è´å¶æ–¯ç½‘ç»œçš„ä¼°è®¡æ¨ç†(Approximate inference in bayesian networks)</h2>
<p>å› ä¸ºå¤šè¿æ¥ç½‘ç»œä¸­çš„æ¨ç†æ˜¯ä¸å¯è¡Œçš„ï¼Œæ‰€ä»¥ç”¨ä¼°è®¡æ¨ç†å–ä»£ç²¾ç¡®æ¨ç†æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚è¿™ä¸€èŠ‚ä¼šä»‹ç»éšæœºé‡‡æ ·ç®—æ³•ï¼Œä¹Ÿå«è’™ç‰¹å¡æ´›ç®—æ³•(Monte Carlo)ï¼Œå®ƒçš„ç²¾ç¡®åº¦å–å†³äºç”Ÿæˆçš„æ ·æœ¬æ•°é‡ã€‚æˆ‘ä»¬çš„ç›®çš„æ˜¯é‡‡æ ·ç”¨äºè®¡ç®—åéªŒæ¦‚ç‡ã€‚è¿™é‡Œç»™å‡ºäº†ä¸¤ç±»ç®—æ³•ï¼Œç›´æ¥é‡‡æ ·(direct sampling)å’Œé©¬å°”ç§‘å¤«é“¾é‡‡æ ·(Markov chain sampling)ã€‚å˜åˆ†æ³•(variational methods)å’Œå¾ªç¯ä¼ æ’­(loopy propagation)å°†ä¼šåœ¨æœ¬ç« çš„æœ€åè¿›è¡Œä»‹ç»ã€‚</p>
<h3 id="ç›´æ¥é‡‡æ ·-direct-sampling-methods">ç›´æ¥é‡‡æ ·(Direct sampling methods)</h3>
<p>ä»»ä½•é‡‡æ ·ç®—æ³•éƒ½æ˜¯é€šè¿‡ä¸€ä¸ªå·²çŸ¥çš„å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒç”Ÿæˆæ ·æœ¬ã€‚æ¯”å¦‚ä¸€ä¸ªå…¬å¹³çš„ç¡¬å¸ï¼Œæœä»ä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒ$P(coin) = &lt;0.5,0.5 &gt; $ï¼Œä»è¿™ä¸ªåˆ†å¸ƒä¸­é‡‡æ ·å°±åƒæŠ›ç¡¬å¸ã€‚<br>
ä¸€ä¸ªæœ€ç®€å•çš„ä»è´å¶æ–¯ç½‘ç»œä¸­è¿›è¡Œéšæœºé‡‡æ ·çš„æ–¹æ³•å°±æ˜¯ï¼šä»æ²¡æœ‰è¯æ®å’Œå®ƒç›¸å…³çš„ç½‘ç»œä¸­ç”Ÿæˆäº‹ä»¶ï¼Œå³æŒ‰ç…§æ‹“æ‰‘é¡ºåºå¯¹æ¯ä¸€ä¸ªå˜é‡è¿›è¡Œé‡‡æ ·ã€‚å¦‚Figure 14.13æ‰€ç¤ºçš„ç®—æ³•ï¼Œæ¯ä¸€ä¸ªå˜é‡çš„é‡‡æ ·éƒ½å–å†³äºå‰ä¹‹å‰å·²ç»é‡‡æ ·è¿‡äº†çš„çˆ¶èŠ‚ç‚¹å˜é‡çš„å€¼ã€‚æŒ‰ç…§Figure 14.13ä¸­çš„ç®—æ³•å¯¹Figure 14.12(a)ä¸­çš„ç½‘ç»œè¿›è¡Œé‡‡æ ·ï¼Œå‡è®¾ä¸€ä¸ªé‡‡æ ·é¡ºåºæ˜¯[Cloudy,Sprinkler,Rain,WetGrass]ï¼š</p>
<ol>
<li>ä»$P(Cloudy)=&lt;0.5,0.5&gt;$ä¸­é‡‡æ ·ï¼Œé‡‡æ ·å€¼æ˜¯trueï¼›</li>
<li>ä»$P(Sprinkler|Cloudy=true) = &lt;0.1,0.9&gt;$ä¸­é‡‡æ ·ï¼Œé‡‡æ ·å€¼æ˜¯falseï¼›</li>
<li>ä»$P(Rain|Cloudy=true)=&lt;0.8,0.2&gt;$ä¸­é‡‡æ ·ï¼Œé‡‡æ ·å€¼æ˜¯trueï¼›</li>
<li>ä»$P(WetGrass|Sprinkler=false,Rain=true)=&lt;0.9,0.1&gt;$ä¸­é‡‡æ ·ï¼Œé‡‡æ ·å€¼æ˜¯trueï¼›</li>
</ol>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼ŒPRIOR-SAMPLEç®—æ³•è¿”å›äº‹ä»¶[true,false,true,true]ã€‚å¯ä»¥çœ‹å‡ºæ¥ï¼ŒPRIOR-SAMPLEç®—æ³•æ ¹æ®è´å¶æ–¯ç½‘ç»œæŒ‡å®šçš„å…ˆéªŒè”åˆåˆ†å¸ƒç”Ÿæˆæ ·æœ¬ã€‚å‡è®¾$S_{PS}(x_1,\cdot,x_n)$æ˜¯PRIOR-SAMPLEç®—æ³•ç”Ÿæˆçš„ä¸€ä¸ªæ ·æœ¬äº‹ä»¶ï¼Œä»é‡‡æ ·è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼š<br>
$$S_{PS}(x_1,\cdots,x_n) = \prod_{i=1}^nP(x_i|parents(X_i))$$<br>
å³æ¯ä¸€æ­¥é‡‡æ ·éƒ½åªå–å†³äºçˆ¶èŠ‚ç‚¹çš„å€¼ã€‚è¿™ä¸ªå¼å­å’Œè´å¶æ–¯ç½‘ç»œçš„è”åˆæ¦‚ç‡åˆ†å¸ƒæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š<br>
$$S_{PS} = P(x_1,\cdots,x_n).$$<br>
é€šè¿‡é‡‡æ ·è®©è¿™ä¸ªè”åˆåˆ†å¸ƒçš„æ±‚è§£å¾ˆç®€å•ã€‚<br>
<img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.13"><br>
äº‹å®ä¸Šåœ¨ä»»ä½•é‡‡æ ·ç®—æ³•ä¸­ï¼Œç»“æœéƒ½æ˜¯é€šè¿‡å¯¹äº§ç”Ÿçš„æ ·æœ¬è¿›è¡Œè®¡æ•°å¾—åˆ°çš„ã€‚å‡è®¾ç”Ÿæˆäº†$N$ä¸ªæ ·æœ¬ï¼Œ$N_{PS}(x_1,\cdots,x_n)$æ˜¯æ ·æœ¬é›†ä¸­çš„ä¸€ä¸ªå…·ä½“äº‹ä»¶$(x_1,\cdots,x_n)$å‘ç”Ÿçš„æ¬¡æ•°ã€‚æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªå€¼æ¯”ä¸Šæ ·æœ¬æ€»æ•°å–æé™å’Œé‡‡æ ·æ¦‚ç‡$S_{PS}$æ˜¯ä¸€æ ·çš„ï¼Œå³ï¼š<br>
$$ lim_{N\rightarrow \infty}\frac{N_{PS}(x_1,\cdots,x_n)}{N} = S_{PS}(x_1,\cdots,x_n) = P(x_1,\cdots,x_n).$$<br>
ä¾‹å¦‚ä¹‹å‰åˆ©ç”¨PRIOR-SAMPLEç®—æ³•äº§ç”Ÿçš„äº‹ä»¶[true,false,true,true]ï¼Œè¿™ä¸ªäº‹ä»¶çš„é‡‡æ ·æ¦‚ç‡æ˜¯ï¼š<br>
$$S_{PS}(true,false,true,true) = 0.5 \times 0.9 \times 0.8 \times 0.9 = 0.324.$$<br>
å³å½“$N$å–æé™æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰$32.4%$çš„æ ·æœ¬éƒ½æ˜¯è¿™ä¸ªäº‹ä»¶ã€‚(è¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨é‡‡æ ·è¿›è¡Œè®¡ç®—å‘¢ï¼Œæˆ‘çš„æƒ³æ³•æ˜¯å› ä¸ºå®é™…æƒ…å†µä¸­ï¼Œé‡‡æ ·æ¦‚ç‡$S_{PS}$æ˜¯å¾ˆéš¾è®¡ç®—çš„ï¼Œå°±é€šè¿‡ä¸æ–­çš„é‡‡æ ·ï¼Œè®¡ç®—å‡ºæŸä¸ªæ ·æœ¬å‡ºç°çš„æ¦‚ç‡ã€‚)<br>
æˆ‘ä»¬ç”¨$\approx$è¡¨ç¤ºä¼°è®¡æ¦‚ç‡(estimated probability)åœ¨æ ·æœ¬æ•°é‡$N$å–æé™æ—¶å’ŒçœŸå®æ¦‚ç‡ä¸€æ ·çš„ä¼°è®¡ï¼Œè¿™å«ä¸€è‡´(consistent)ä¼°è®¡ã€‚æ¯”å¦‚ï¼Œå¯¹äºä»»æ„çš„å«æœ‰éšå˜é‡çš„äº‹ä»¶(partially spefified event)ï¼Œ$x_1,\cdots,x_m,m\le n$ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªä¸€è‡´ä¼°è®¡ï¼š<br>
$$P(x_1,\cdots,x_m)\approx N_{PS}(x_1,\cdots,x_m)/N.$$<br>
è¿™ä¸ªäº‹ä»¶çš„æ¦‚ç‡å¯ä»¥çœ‹æˆæ‰€æœ‰æ»¡è¶³è§‚æµ‹å˜é‡æ¡ä»¶çš„æ ·æœ¬äº‹ä»¶ï¼ˆéšå˜é‡æ‰€æœ‰å€¼éƒ½å¯ä»¥å–ï¼‰æ¯”ä¸Šæ‰€æœ‰æ ·æœ¬äº‹ä»¶çš„æ¯”å€¼ã€‚æ¯”å¦‚åœ¨Spinklerç½‘ç»œä¸­ï¼Œç”Ÿæˆ$1000$ä¸ªæ ·æœ¬ï¼Œå…¶ä¸­æœ‰$511$ä¸ªæ ·æœ¬çš„Rain=trueï¼Œé‚£ä¹ˆrainçš„ä¼°è®¡æ¦‚ç‡å°±æ˜¯$\hat{P}(Rain=true) = 0.511.$</p>
<h4 id="è´å¶æ–¯ç½‘ç»œçš„æ‹’ç»é‡‡æ ·-rejection-sampling-in-bayesian-networks">è´å¶æ–¯ç½‘ç»œçš„æ‹’ç»é‡‡æ ·(Rejection sampling in Bayesian networks)</h4>
<h5 id="ç®—æ³•">ç®—æ³•</h5>
<p><img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.14"><br>
æ‹’ç»é‡‡æ ·(rejection sampling)åˆ©ç”¨å®¹æ˜“é‡‡æ ·çš„åˆ†å¸ƒæ¥ç”Ÿæˆéš¾é‡‡æ ·åˆ†å¸ƒçš„æ ·æœ¬ï¼Œè®¡ç®—åéªŒæ¦‚ç‡$P(X|\mathbf{e})$ï¼Œç®—æ³•æµç¨‹å¦‚Figure 14.14æ‰€ç¤ºï¼Œé¦–å…ˆæ ¹æ®è´å¶æ–¯ç½‘ç»œçš„å…ˆéªŒåˆ†å¸ƒç”Ÿæˆæ ·æœ¬ï¼Œæ¥ä¸‹æ¥æ‹’ç»(reject)é‚£äº›å’Œè¯æ®å˜é‡ä¸åŒ¹é…çš„ç»“æœï¼Œæœ€ååœ¨å‰©ä¸‹çš„æ ·æœ¬ä¸­ç»Ÿè®¡æ¯ä¸ª$X=x$å‡ºç°çš„æ¦‚ç‡ï¼Œä¼°è®¡$\hat{P}(X|\mathbf{e}).$<br>
ç”¨$\hat{P}(X|\mathbf{e})$è¡¨ç¤ºä¼°è®¡æ¦‚ç‡åˆ†å¸ƒï¼Œåˆ©ç”¨æ‹’ç»é‡‡æ ·ç®—æ³•çš„å®šä¹‰è®¡ç®—ï¼š<br>
$$\hat{P}(X|\mathbf{e}) = \alpha N_{PS}(X,\mathbf{e}) = \frac{N_{PS}(X,\mathbf{e})}{N_{PS}(\mathbf{e})}.$$<br>
è€Œæ ¹æ®$P(x_1,\cdots,x_m)\approx N_{PS}(x_1,\cdots,x_m)/N$ï¼Œå°±æœ‰ï¼š<br>
$$\hat{P}(X|\mathbf{e}) = \alpha N_{PS}(X,\mathbf{e}) = \frac{N_{PS}(X,\mathbf{e})}{N_{PS}(\mathbf{e})} =  \frac {P(X,\mathbf{e})}{P(\mathbf{e})} = P(X|\mathbf{e}).$$<br>
æ‰€ä»¥ï¼Œæ‹’ç»é‡‡æ ·äº§ç”Ÿäº†çœŸå®æ¦‚ç‡çš„ä¸€ä¸ªä¸€è‡´ä¼°è®¡(consistent estimate)ï¼Œä½†æ˜¯è¿™ä¸ªä¸€è‡´ä¼°è®¡å’Œæ— åä¼°è®¡è¿˜ä¸ä¸€æ ·ã€‚</p>
<h5 id="ç¤ºä¾‹-v3">ç¤ºä¾‹</h5>
<p>ä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼Œå‡è®¾æˆ‘ä»¬è¦ä¼°è®¡æ¦‚ç‡$P(Rain|Sprinkler=true)$ï¼Œç”Ÿæˆäº†$100$ä¸ªæ ·æœ¬ï¼Œå…¶ä¸­$73$ä¸ªæ˜¯$Sprinkler=false$ï¼Œ$27$æ˜¯$Sprinkler=true$ï¼Œè¿™$27$ä¸ªä¸­æœ‰$8$ä¸ª$Rain=true$ï¼Œæœ‰$19$ä¸ª$Rain=false$ï¼Œå› æ­¤ï¼š<br>
$$P(Rain|Sprinkler=true)\approx NORMALIZE \lt\lt 8,19&gt;&gt; = &lt;0.296,0.704&gt;.$$<br>
æ­£ç¡®ç­”æ¡ˆæ˜¯$&lt;0.3,0.7&gt;$ï¼Œå¯ä»¥çœ‹å‡ºæ¥ï¼Œä¼°è®¡å€¼å’ŒçœŸå®å€¼å·®çš„ä¸å¤šã€‚ç”Ÿæˆçš„æ ·æœ¬è¶Šå¤šï¼Œä¼°è®¡å€¼å°±ä¼šå’Œæ­£ç¡®å€¼è¶Šæ¥è¿‘ï¼Œæ¦‚ç‡çš„ä¼°è®¡è¯¯å·®å’Œ$1/\sqrt{n}$æˆæ¯”ä¾‹ï¼Œ$n$æ˜¯ç”¨æ¥ä¼°è®¡æ¦‚ç‡çš„æ ·æœ¬æ•°é‡ã€‚</p>
<h5 id="ä¸è¶³">ä¸è¶³</h5>
<p>æ‹’ç»é‡‡æ ·æœ€å¤§çš„é—®é¢˜æ˜¯å®ƒæ‹’ç»äº†å¾ˆå¤šæ ·æœ¬ï¼Œéšç€è¯æ®å˜é‡çš„å¢åŠ ï¼Œå’Œè¯æ®$\mathbf{e}$ä¸€è‡´çš„æ ·æœ¬æŒ‡æ•°é€Ÿåº¦å‡å°‘ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•å¯¹äºå¤æ‚çš„é—®é¢˜æ˜¯ä¸å¯è¡Œçš„ã€‚æ‹’ç»å‡è®¾å’Œç°å®ç”Ÿæ´»ä¸­æ¡ä»¶æ¦‚ç‡æ˜¯å¾ˆåƒçš„ï¼Œæ¯”å¦‚ä¼°è®¡è§‚æµ‹åˆ°æ™šä¸Šå¤©ç©ºæ˜¯çº¢çš„ï¼Œç¬¬äºŒå¤©ä¸‹é›¨çš„æ¦‚ç‡$P(Rain|RedSkyAtNight=ture)$ï¼Œè¿™ä¸ªæ¡ä»¶æ¦‚ç‡çš„ä¼°è®¡å°±æ˜¯æ ¹æ®æ—¥å¸¸ç”Ÿæ´»çš„è§‚å¯Ÿå®ç°çš„ã€‚ä½†æ˜¯å¦‚æœå¤©ç©ºå¾ˆå°‘æ˜¯çº¢çš„ï¼Œå°±éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½ä¼°è®¡å®ƒçš„å€¼ï¼Œè¿™å°±æ˜¯æ‹’ç»å‡è®¾çš„ç¼ºç‚¹ã€‚</p>
<h4 id="å¯èƒ½æ€§åŠ æƒ-likelihood-weighting">å¯èƒ½æ€§åŠ æƒ(Likelihood weighting)</h4>
<h5 id="ç®—æ³•-v2">ç®—æ³•</h5>
<p>å¯èƒ½æ€§åŠ æƒ(Likelihood weighting)åªäº§ç”Ÿå’Œè¯æ®$\mathbf{e}$ä¸€è‡´çš„äº‹ä»¶ï¼Œå› æ­¤é¿å…äº†æ‹’ç»é‡‡æ ·çš„ä½æ•ˆã€‚å®ƒæ˜¯ç»Ÿè®¡å­¦ä¸­é‡è¦æ€§é‡‡æ ·çš„ä¸€ä¸ªä¾‹å­ï¼Œä¸“é—¨ä¸ºè´å¶æ–¯æ¨ç†è®¾è®¡çš„ã€‚<br>
å¦‚Figure 14.15æ‰€ç¤ºï¼ŒåŠ æƒä¼¼ç„¶å›ºå®šè¯æ®å˜é‡$\mathbf{E}$çš„å€¼ï¼Œåªå¯¹éè¯æ®å˜é‡è¿›è¡Œé‡‡æ ·ï¼Œè¿™å°±ä¿è¯äº†æ¯ä¸€ä¸ªäº‹ä»¶éƒ½æ˜¯å’Œè¯æ®ä¸€è‡´çš„ã€‚ä½†æ˜¯ï¼Œä¸æ˜¯æ‰€æœ‰çš„äº‹ä»¶æƒé‡éƒ½æ˜¯ä¸€æ ·çš„ã€‚ç»™å®šæ¯ä¸€ä¸ªè¯æ®å˜é‡çš„çˆ¶èŠ‚ç‚¹ï¼Œå®ƒçš„å¯èƒ½æ€§(likelihood)æ˜¯è¯æ®å˜é‡çš„æ¡ä»¶æ¦‚ç‡çš„ä¹˜ç§¯ï¼Œæ¯ä¸€ä¸ªäº‹ä»¶éƒ½æ ¹æ®è¯æ®çš„å¯èƒ½æ€§è¿›è¡ŒåŠ æƒã€‚</p>
<h5 id="ç¤ºä¾‹-v4">ç¤ºä¾‹</h5>
<p>å¯¹äºFigure 14.12(a)ä¸­çš„ä¾‹å­ï¼Œè®¡ç®—åéªŒæ¦‚ç‡$P(Rain|Cloudy=true,WetGrass=true)$ï¼Œé‡‡æ ·é¡ºåºæ˜¯Cloudy,Sprinkler,Rain,WetGrassã€‚è¿‡ç¨‹å¦‚ä¸‹ï¼Œé¦–å…ˆï¼Œæƒé‡$w$è®¾ä¸º$1$ï¼Œä¸€ä¸ªäº‹ä»¶ç”Ÿæˆè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>Cloudyæ˜¯ä¸€ä¸ªè¯æ®å˜é‡ï¼Œå®ƒçš„å€¼æ˜¯true,å› æ­¤ï¼Œä»¤ï¼š<br>
$$w\leftarrow w\times P(cloudy=true) = 0.5.$$</li>
<li>Sprinkleræ˜¯éšå˜é‡ï¼Œæ‰€ä»¥ä»$P(Sprinkler|Cloudy=true)=&lt;0.1,0.9&gt;$ä¸­é‡‡æ ·ï¼Œå‡è®¾é‡‡æ ·ç»“æœæ˜¯falseï¼›</li>
<li>Rainæ˜¯éšå˜é‡ï¼Œä»$P(Rain|Cloudy=true)=&lt;0.8,0.2&gt;$ä¸­é‡‡æ ·ï¼Œå‡è®¾é‡‡æ ·ç»“æœæ˜¯trueï¼›</li>
<li>WetGrassæ˜¯è¯æ®å˜é‡ï¼Œå€¼æ˜¯true,ä»¤ï¼š<br>
$$w\leftarrow w\times P(WetGrass=true|Sprinkler=false,Rain=true) = 0.45.$$</li>
</ol>
<p>æ‰€ä»¥WEIGHTED-SAMPLEç®—æ³•ç”Ÿæˆäº‹ä»¶[true,false,true,true]ï¼Œç›¸åº”çš„æƒé‡æ˜¯$0.45$ã€‚</p>
<h5 id="åŸç†">åŸç†</h5>
<p>ç”¨$S_{WS}$è¡¨ç¤ºWEIGHTED-SAMPLEç®—æ³•ä¸­äº‹ä»¶çš„é‡‡æ ·æ¦‚ç‡ï¼Œè¯æ®å˜é‡$\mathbf{E}$çš„å–å€¼$\mathbf{e}$æ˜¯å›ºå®šçš„ï¼Œç”¨$\mathbf{Z}$è¡¨ç¤ºéè¯æ®å˜é‡ï¼ŒåŒ…æ‹¬éšå˜é‡$\mathbf{Y}$å’ŒæŸ¥è¯¢å˜é‡$\mathbf{X}$ã€‚ç»™å®šå˜é‡$\mathbf{Z}$çš„çˆ¶èŠ‚ç‚¹ï¼Œç®—æ³•å¯¹å˜é‡$\mathbf{Z}$è¿›è¡Œé‡‡æ ·ï¼š<br>
$$S_{WS}(\mathbf{z},\mathbf{e}) = \prod_{i=1}^lP(z_i|parents(Z_i)).$$<br>
å…¶ä¸­$Parents(Z_i)$å¯èƒ½åŒæ—¶åŒ…å«è¯æ®å˜é‡å’Œéè¯æ®å˜é‡ã€‚<br>
å’Œå…ˆéªŒåˆ†å¸ƒ$P(\mathbf{z})$ä¸åŒçš„æ˜¯ï¼Œæ¯ä¸€ä¸ªå˜é‡$Z_i$çš„å–å€¼ä¼šå—åˆ°$Z_i$çš„ç¥–å…ˆ(ancestor)å˜é‡çš„å½±å“ã€‚æ¯”å¦‚ï¼Œå¯¹Sprinklerè¿›è¡Œé‡‡æ ·çš„æ—¶å€™ï¼Œç®—æ³•ä¼šå—åˆ°å®ƒçš„çˆ¶èŠ‚ç‚¹ä¸­çš„è¯æ®å˜é‡Cloudy=trueçš„å½±å“ï¼Œè€Œå…ˆéªŒåˆ†å¸ƒä¸ä¼šã€‚å¦ä¸€æ–¹é¢ï¼Œ$S_{WS}$æ¯”åéªŒåˆ†å¸ƒ$P(\mathbf{z}|\mathbf{e})$å—è¯æ®çš„å½±å“æ›´å°ï¼Œå› ä¸ºå¯¹$Z_i$çš„é‡‡æ ·å¿½ç•¥äº†$Z_i$çš„éç¥–å…ˆ(non-ancestor)å˜é‡ä¸­çš„è¯æ®ã€‚æ¯”å¦‚ï¼Œå¯¹Sprinklerå’ŒRainè¿›è¡Œé‡‡æ ·çš„æ—¶å€™ï¼Œç®—æ³•å¿½ç•¥äº†å­èŠ‚ç‚¹ä¸­çš„è¯æ®å˜é‡WetGrass=trueï¼Œäº‹å®ä¸Šè¿™ä¸ªè¯æ®å·²ç»æ’é™¤äº†(rule out)Sprinkler=falseå’ŒRain=falseçš„æƒ…å†µï¼Œä½†æ˜¯WEIGHTED-SAMPLEè¿˜ä¼šäº§ç”Ÿå¾ˆå¤šè¿™æ ·çš„æ ·æœ¬äº‹ä»¶ã€‚<br>
ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªé‡‡æ ·åˆ†å¸ƒå’ŒçœŸå®çš„åéªŒæ¦‚ç‡$P(\mathbf{z}|\mathbf{e})$ç›¸ç­‰ï¼Œä¸å¹¸çš„æ˜¯ä¸å­˜åœ¨è¿™æ ·çš„å¤šé¡¹å¼æ—¶é—´çš„ç®—æ³•ã€‚å¦‚æœæœ‰è¿™æ ·çš„ç®—æ³•çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¤šé¡¹å¼æ•°é‡çš„æ ·æœ¬ä»¥ä»»æ„ç²¾åº¦é€¼è¿‘æƒ³è¦æ±‚çš„æ¦‚ç‡å€¼ã€‚<br>
å¯èƒ½æ€§æƒé‡$w$å¼¥è¡¥äº†å®é™…çš„åˆ†å¸ƒå’Œæˆ‘ä»¬æƒ³è¦çš„åˆ†å¸ƒä¹‹é—´çš„å·®è·ã€‚ä¸€ä¸ªç”±$\mathbf{z}$å’Œ$\mathbf{e}$ç»„æˆçš„æ ·æœ¬$\mathbf{x}$çš„æƒé‡æ˜¯ç»™å®šäº†çˆ¶èŠ‚ç‚¹çš„è¯æ®å˜é‡çš„å¯èƒ½æ€§ä¹˜ç§¯ï¼š<br>
$$w(\mathbf{z},\mathbf{e}) = \prod_{i=1}^mP(e_i|parents(E_i)).$$<br>
å°†ä¸Šé¢çš„ä¸¤ä¸ªå¼å­ä¹˜èµ·æ¥ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ ·æœ¬çš„åŠ æƒæ¦‚ç‡(weighted probability)æ˜¯ï¼š<br>
$$S_{WS}(\mathbf{z},\mathbf{e})w(\mathbf{z},\mathbf{e}) = \prod_{i=1}<sup>lP(z_i|parents(Z_i))\prod_{i=1}</sup>mP(e_i|parents(E_i)) = P(\mathbf{z},\mathbf{e}).$$<br>
å¯èƒ½æ€§åŠ æƒä¼°è®¡æ˜¯ä¸€è‡´ä¼°è®¡ã€‚å¯¹äºä»»æ„çš„$x$ï¼Œä¼°è®¡çš„åéªŒæ¦‚ç‡æŒ‰ä¸‹å¼è®¡ç®—ï¼š<br>
\begin{align*}<br>
\hat{P}(x|\mathbf{e}) &amp;= \alpha \sum_{\mathbf{y}} N_{WS}(x,\mathbf{y},\mathbf{e})w(x,\mathbf{y},\mathbf{e})\<br>
&amp;\approx \alphaâ€™\sum_{\mathbf{y}}S_{WS}(x,\mathbf{y},\mathbf{e})w(x,\mathbf{y},\mathbf{e})\<br>
&amp;=\alphaâ€™\sum_{\mathbf{y}}P(x,\mathbf{y},\mathbf{e})\<br>
&amp;=\alphaâ€™\sum_{\mathbf{y}}P(x,\mathbf{y},\mathbf{e})\<br>
&amp;=P(x|\mathbf{e})<br>
\end{align*}<br>
ç®—æ³•ä¸­çœŸå®å®ç°çš„æ˜¯ç¬¬ä¸€è¡Œï¼Œå³ç»Ÿè®¡å‡ºç”¨WEIGHTED-SAMPLEäº§ç”Ÿçš„æ ·æœ¬$(x,\mathbf{y},\mathbf{e})$æ•°é‡$N_{WS}$ï¼Œä»¥åŠå¯¹åº”çš„æƒé‡$w(x,\mathbf{y},\mathbf{e})$ï¼Œåé¢çš„éƒ½æ˜¯ç†è®ºæ¨å¯¼ï¼Œå½“$N$å–æé™çš„æ—¶å€™$lim_{N\rightarrow \infty}\frac{N_{WS}(x_1,\cdots,x_n)}{N} = S_{WS}(x_1,\cdots,x_n)$ï¼Œåé¢çš„éƒ½æ˜¯ä¸ºäº†è¯æ˜ç®—æ³•æ˜¯ä¸€è‡´ä¼°è®¡ã€‚</p>
<h5 id="ä¸è¶³-v2">ä¸è¶³</h5>
<p>å¯èƒ½æ€§åŠ æƒç®—æ³•ä½¿ç”¨äº†æ‰€æœ‰ç”Ÿæˆçš„æ ·æœ¬ï¼Œå®ƒæ¯”æ‹’ç»å‡è®¾ç®—æ³•æ›´é«˜æ•ˆã€‚ç„¶è€Œï¼Œéšç€è¯æ®å˜é‡çš„å¢åŠ ï¼Œç®—æ³•æ€§èƒ½ä¼šé€€åŒ–(degradation)ï¼Œè¿™æ˜¯å› ä¸ºå¾ˆå¤šæ ·æœ¬çš„æƒé‡éƒ½ä¼šå¾ˆå°ï¼Œå› æ­¤åŠ æƒä¼°è®¡å¯èƒ½ä¼šå—ä¸€å°éƒ¨åˆ†æƒé‡å¾ˆå¤§çš„æ ·æœ¬çš„å½±å“(dominated)ã€‚å¦‚æœè¯æ®å˜é‡åœ¨éè¯æ®å˜é‡çš„åè¾¹ï¼Œè¿™ä¸ªé—®é¢˜ä¼šåŠ å‰§ï¼Œå› ä¸ºå®ƒä»¬çš„çˆ¶èŠ‚ç‚¹æˆ–è€…ç¥–å…ˆèŠ‚ç‚¹æ²¡æœ‰è¯æ®å˜é‡æ¥æŒ‡å¯¼æ ·æœ¬çš„ç”Ÿæˆã€‚è¿™å°±æ„å‘³ç€ç”Ÿæˆçš„æ ·æœ¬å’Œè¯æ®å˜é‡æ”¯æ’‘çš„çœŸå®æƒ…å†µå¯èƒ½å·®è·å¾ˆå¤§(bear little resemblance)ã€‚</p>
<h3 id="é©¬å°”ç§‘å¤«é“¾ä»¿çœŸæ¨ç†-inference-by-markov-chain-simulation">é©¬å°”ç§‘å¤«é“¾ä»¿çœŸæ¨ç†(Inference by Markov chain simulation)</h3>
<p>é©¬å°”ç§‘å¤«é“¾è’™ç‰¹å¡æ´›(Markov chain Monte Carlo,MCMC)ç®—æ³•å’Œæ‹’ç»é‡‡æ ·ä»¥åŠå¯èƒ½æ€§åŠ æƒå¾ˆä¸ä¸€æ ·ã€‚é‚£ä¸¤ä¸ªæ–¹æ³•æ¯æ¬¡éƒ½ä»å¤´å¼€å§‹ç”Ÿæˆæ ·æœ¬ï¼Œè€ŒMCMCç®—æ³•åœ¨ä¹‹å‰çš„æ ·æœ¬ä¸Šåšä¸€äº›éšæœºçš„å˜åŒ–ã€‚å¯ä»¥å°†MCMCç®—æ³•çœ‹æˆæŒ‡å®šäº†æ¯ä¸€ä¸ªå˜é‡å€¼çš„ç‰¹æ®Šå½“å‰çŠ¶æ€(current state)ï¼Œé€šè¿‡å¯¹å½“å‰çŠ¶æ€(current state)åšä»»æ„çš„æ”¹å˜ç”Ÿæˆä¸‹ä¸€ä¸ªçŠ¶æ€(next state)ã€‚è¿™ä¸€èŠ‚è¦ä»‹ç»çš„ä¸€ç§MCMCç®—æ³•æ˜¯å‰å¸ƒæ£®é‡‡æ ·(Gibbs sampling)ã€‚</p>
<h4 id="è´å¶æ–¯ç½‘ç»œä¸­çš„å‰å¸ƒæ£®é‡‡æ ·-gibbs-sampling-in-bayesian-networks">è´å¶æ–¯ç½‘ç»œä¸­çš„å‰å¸ƒæ£®é‡‡æ ·(Gibbs sampling in Bayesian networks)</h4>
<h5 id="ç®—æ³•-v3">ç®—æ³•</h5>
<p>è´å¶æ–¯ç½‘ç»œä¸­çš„å‰å¸ƒæ£®é‡‡æ ·ä»ä»»æ„ä¸€ä¸ªçŠ¶æ€å¼€å§‹ï¼Œå…¶ä¸­è¯æ®å˜é‡çš„å–å€¼å›ºå®šä¸ºè§‚æµ‹å€¼ï¼Œé€šè¿‡éšæœºé€‰å–éè¯æ®å˜é‡$X_i$çš„å€¼ç”Ÿæˆä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚å˜é‡$X_i$çš„é‡‡æ ·å–å†³äºå˜é‡$X_i$çš„é©¬å°”ç§‘å¤«æ¯¯çš„å½“å‰å€¼ã€‚ç®—æ³•åœ¨çŠ¶æ€ç©ºé—´ï¼ˆæ‰€æœ‰éè¯æ®å˜é‡çš„å…¨éƒ¨å¯èƒ½å–å€¼ç©ºé—´ï¼‰ä¸­éšæœºé‡‡æ ·ï¼Œæ¯æ¬¡é‡‡æ ·éƒ½ä¿æŒè¯æ®å˜é‡ä¸å˜ï¼Œä¸€æ¬¡æ”¹å˜ä¸€ä¸ªéè¯æ®å˜é‡çš„å€¼ã€‚å®Œæ•´çš„ç®—æ³•å¦‚Figure 14.16æ‰€ç¤ºã€‚<br>
<img src="/2019/01/06/AI-chapter-14-Probabilistic-reasoning/" alt="figure 14.16"></p>
<h5 id="ç¤ºä¾‹-v5">ç¤ºä¾‹</h5>
<p>Figure 14.12(a)ä¸­çš„æŸ¥è¯¢(query)$P(Rain|Sprinkler=true, WetGrass=true)$ï¼Œè¯æ®å˜é‡Spinklerå’ŒWetGrasså–å®ƒä»¬çš„è§‚æµ‹å€¼ä¸å˜ï¼Œéè¯æ®å˜é‡Cloudyå’ŒRainéšæœºåˆå§‹åŒ–ï¼Œå‡è®¾å–çš„æ˜¯trueå’Œfalseã€‚é‚£ä¹ˆåˆå§‹çŠ¶æ€å°±æ˜¯[true,true,false,true]ï¼Œæ¥ä¸‹æ¥å¯¹éè¯æ®å˜é‡è¿›è¡Œé‡å¤çš„éšæœºé‡‡æ ·ã€‚<br>
æ¯”å¦‚ç¬¬ä¸€æ¬¡å¯¹Cloudyé‡‡æ ·ï¼ˆä¹Ÿå¯ä»¥å¯¹Rainé‡‡æ ·ï¼‰ï¼Œç»™å®šå®ƒçš„é©¬å°”ç§‘å¤«æ¯¯å˜é‡ï¼Œç„¶åä»$P(Cloudy|Sprinkler=true,Rain=false)$ä¸­è¿›è¡Œé‡‡æ ·ï¼Œå‡è®¾é‡‡æ ·ç»“æœæ˜¯falseï¼Œæ–°çš„çŠ¶æ€å°±æ˜¯[false,true,false,true]ã€‚æ¥ä¸‹æ¥éšæœºå¯ä»¥å¯¹Rainé‡‡æ ·ï¼ˆä¹Ÿå¯ä»¥å¯¹Cloudyé‡‡æ ·ï¼‰ï¼Œç»™å®šRainçš„é©¬å°”ç§‘å¤«æ¯¯å˜é‡çš„å–å€¼ï¼Œä»$P(Rain|Cloudy=false,Sprinkler=true,WetGrass=true)$ä¸­è¿›è¡Œé‡‡æ ·ï¼Œå‡è®¾é‡‡æ ·å€¼æ˜¯true,é‚£ä¹ˆæ–°çš„çŠ¶æ€æ˜¯[true,true,false,false]ã€‚æ¥ä¸‹æ¥å¯ä»¥ä¸€ç›´è¿›è¡Œé‡‡æ ·ã€‚ã€‚æœ€ç»ˆåˆ©ç”¨ç”Ÿæˆçš„æ ·æœ¬è®¡ç®—å‡ºç›¸åº”çš„æ¦‚ç‡ã€‚</p>
<h4 id="ä¸ºä»€ä¹ˆå‰å¸ƒæ£®é‡‡æ ·æœ‰ç”¨-why-gibbs-sampling-works">ä¸ºä»€ä¹ˆå‰å¸ƒæ£®é‡‡æ ·æœ‰ç”¨(Why Gibbs sampling works)</h4>
<p>æ¥ä¸‹æ¥ç»™å‡ºä¸ºä»€ä¹ˆå‰å¸ƒæ£®é‡‡æ ·è®¡ç®—åéªŒæ¦‚ç‡æ˜¯ä¸€è‡´ä¼°è®¡ã€‚åŸºæœ¬çš„è§£é‡Šæ˜¯ç›´æˆªäº†å½“çš„ï¼šé‡‡æ ·è¿‡ç¨‹å»ºç«‹äº†ä¸€ä¸ªåŠ¨æ€å¹³è¡¡ï¼Œæ¯ä¸ªçŠ¶æ€èŠ±è´¹çš„æ—¶é—´é•¿æœŸæ¥è¯´å’Œå®ƒçš„åéªŒæ¦‚ç‡æ˜¯æˆæ¯”ä¾‹çš„ã€‚<br>
å…·ä½“çš„ï¼Œä¸æƒ³çœ‹äº†ã€‚ã€‚ã€‚å°±éšç¼˜å§</p>
<h2 id="å…³ç³»å’Œä¸€é˜¶æ¦‚ç‡æ¨¡å‹-relational-and-first-order-probability-models">å…³ç³»å’Œä¸€é˜¶æ¦‚ç‡æ¨¡å‹(Relational and first-order probability models)</h2>
<h2 id="å…¶ä»–ä¸ç¡®å®šæ€§æ¨ç†çš„æ–¹æ³•-other-approaches-to-uncertain-reasoning">å…¶ä»–ä¸ç¡®å®šæ€§æ¨ç†çš„æ–¹æ³•(Other approaches to uncertain reasoning)</h2>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<p>1.<a href="http://aima.cs.berkeley.edu/" target="_blank" rel="noopener">Artificial Intelligence A Modern Approach Third Edition,Stuart Russell,Peter Norvig.</a><br>
2.<a href="https://en.wikipedia.org/wiki/Chain_rule_(probability)" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Chain_rule_(probability)</a><br>
3.<a href="https://en.wikipedia.org/wiki/Consistent_estimator" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Consistent_estimator</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/13/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/15/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/favicon.jpg" alt="é©¬æ™“é‘«çˆ±é©¬èŸèŸ">
            
              <p class="site-author-name" itemprop="name">é©¬æ™“é‘«çˆ±é©¬èŸèŸ</p>
              <p class="site-description motion-element" itemprop="description">è®°å½•ç¡•å£«ä¸‰å¹´è‡ªå·±çš„ç§¯ç´¯</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">153</span>
                    <span class="site-state-item-name">æ—¥å¿—</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">åˆ†ç±»</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">160</span>
                    <span class="site-state-item-name">æ ‡ç­¾</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/mxxhcm" title="GitHub &rarr; https://github.com/mxxhcm" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:mxxhcm@gmail.com" title="E-Mail &rarr; mailto:mxxhcm@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">é©¬æ™“é‘«çˆ±é©¬èŸèŸ</span>

  

  
</div>


  <div class="powered-by">ç”± <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v6.6.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script src="/js/src/utils.js?v=6.6.0"></script>

  <script src="/js/src/motion.js?v=6.6.0"></script>



  
  


  <script src="/js/src/affix.js?v=6.6.0"></script>

  <script src="/js/src/schemes/pisces.js?v=6.6.0"></script>



  

  


  <script src="/js/src/bootstrap.js?v=6.6.0"></script>



  



  






<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    







  





  

  

  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<style>
.MathJax_Display {
    overflow: auto hidden;
}
</style>

    
  


  
  

  

  

  

  

  

  

</body>
</html>
