<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
































<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">



  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.jpg?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.jpg?v=6.6.0">










<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.6.0',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="记录硕士三年自己的积累">
<meta property="og:type" content="website">
<meta property="og:title" content="mxxhcm&#39;s blog">
<meta property="og:url" content="http://mxxhcm.github.io/index.html">
<meta property="og:site_name" content="mxxhcm&#39;s blog">
<meta property="og:description" content="记录硕士三年自己的积累">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mxxhcm&#39;s blog">
<meta name="twitter:description" content="记录硕士三年自己的积累">



  <link rel="alternate" href="/atom.xml" title="mxxhcm's blog" type="application/atom+xml">




  <link rel="canonical" href="http://mxxhcm.github.io/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>mxxhcm's blog</title>
  












  <noscript>
  <style>
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion .logo-line-before i { left: initial; }
    .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">mxxhcm's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/12/06/C-function-pointer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/12/06/C-function-pointer/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">C/C++ function pointer</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-12-06 15:34:54 / 修改时间：17:04:15" itemprop="dateCreated datePublished" datetime="2019-12-06T15:34:54+08:00">2019-12-06</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/C-C/" itemprop="url" rel="index"><span itemprop="name">C/C++</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="函数指针">函数指针</h2>
<p>函数指针指向的是函数而不是对象。和其他指针一样，函数指针指向某种特定类型。函数的类型由它的返回值和形参共同决定，和函数名无关。例如：<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">lengthCompare</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;, <span class="keyword">const</span> <span class="built_in">string</span> &amp;)</span></span>;</span><br></pre></td></tr></table></figure></p>
<p>这个函数的类型是<code>bool(const string &amp;, const string &amp;)</code>，要想声明一个指向该函数的指针，只需要使用指针代替函数名字即可：<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> (*pf)(<span class="keyword">const</span> <span class="built_in">string</span> &amp;, <span class="keyword">const</span> <span class="built_in">string</span> &amp;);</span><br></pre></td></tr></table></figure></p>
<p>从声明符中的变量名字开始，<code>pf</code>前面有个<code>*</code>，所以<code>pf</code>是个指针，右侧是形参列表，左侧是函数的返回值类型。因此，<code>pf</code>是一个指向函数的指针，函数的参数是两个<code>const string</code>的引用，返回值是<code>bool</code>类型。</p>
<h2 id="使用函数指针">使用函数指针</h2>
<p>**当我们把函数名作为一个值使用时，这个函数自动的转换成指针。**如下所示的两个语句是等价的：<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pf = lengthCompare;</span><br><span class="line">pf = &amp;lengthCompare;</span><br></pre></td></tr></table></figure></p>
<p>同时，可以直接使用指向函数的指针调用函数，而不需要进行解引用运算。下面的三个语句是等价的：<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> b1 = pf(<span class="string">"hello"</span>, <span class="string">"world"</span>);</span><br><span class="line"><span class="keyword">bool</span> b2 = (*pf)(<span class="string">"hello"</span>, <span class="string">"world"</span>);</span><br><span class="line"><span class="keyword">bool</span> b3 = lengthCompare(<span class="string">"hello"</span>, <span class="string">"world"</span>);</span><br></pre></td></tr></table></figure></p>
<p>指向不同函数类型之间的指针不存在转换规则，但是可以为函数指针赋值<code>nullptr</code>或者0，表示它不指向任何函数。</p>
<h2 id="重载函数指针">重载函数指针</h2>
<p>当函数重载之后，上下文必须能够告诉编译器到底选择哪个函数，指针必须和重载函数中的某一个精确匹配。</p>
<h2 id="函数指针形参">函数指针形参</h2>
<p>和数组类似，虽然不能定义函数类型的形参，但是形参可以是指向函数的指针。这个时候，形参看起来是函数类型，实际上是当成指针使用。<br>
可以直接把函数作为实参使用，这个时候它会自动的转换成指针：<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第三个参数是函数类型，它会自动的转换成指向函数的指针</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">useBigger</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s1, <span class="keyword">const</span> <span class="built_in">string</span> &amp;s2, <span class="keyword">bool</span> pf(<span class="keyword">const</span> <span class="built_in">string</span> &amp;, <span class="keyword">const</span> <span class="built_in">string</span> &amp;))</span></span>;</span><br><span class="line"><span class="comment">//第三个参数是显式声明的指向函数的指针</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">useBigger</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s1, <span class="keyword">const</span> <span class="built_in">string</span> &amp;s2, <span class="keyword">bool</span> (*pf)(<span class="keyword">const</span> <span class="built_in">string</span> &amp;, <span class="keyword">const</span> <span class="built_in">string</span> &amp;))</span></span>;</span><br><span class="line"><span class="comment">// 函数lengthCompare会被自动的转换成函数指针</span></span><br><span class="line">useBigger(s1, s2, lengthCompare);</span><br></pre></td></tr></table></figure></p>
<h3 id="使用typedef和delctype简化函数指针">使用<code>typedef</code>和<code>delctype</code>简化函数指针</h3>
<p>可以使用下列语句定义函数指针：<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下面两个是函数类型：</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">bool</span> <span class="title">Func</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp;, <span class="keyword">const</span> <span class="built_in">string</span>&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">delctype</span><span class="params">(lengthCompare)</span> Func2</span>; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//下面两个是函数指针类型：</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">bool</span> <span class="params">(*FuncP)</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp;, <span class="keyword">const</span> <span class="built_in">string</span>&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">delctype</span><span class="params">(lengthCompare)</span> *FuncP2</span>;</span><br></pre></td></tr></table></figure></p>
<p>需要注意的是，<code>decltype</code>返回函数类型，不会将函数自动转换成指针类型，只有在前面加上<code>*</code>才能得到指针。</p>
<h2 id="返回指向函数的指针">返回指向函数的指针</h2>
<p>和数组类似，虽然不能返回一个函数，但是可以返回指向函数类型的指针。然后，我们必须把返回类型功能写成指针，编译器不会自动的将函数返回类型当成对应的指针类型处理。</p>
<h2 id="auto和decltype作用于函数指针"><code>auto</code>和<code>decltype</code>作用于函数指针</h2>
<h2 id="参考文献">参考文献</h2>
<p>1.《C++ Primer》第五版</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/12/06/C-function-overload/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/12/06/C-function-overload/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">C++ function overload</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-12-06 15:34:29" itemprop="dateCreated datePublished" datetime="2019-12-06T15:34:29+08:00">2019-12-06</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/12/06/C-return/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/12/06/C-return/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">C/C++ return</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-12-06 15:31:03 / 修改时间：15:34:18" itemprop="dateCreated datePublished" datetime="2019-12-06T15:31:03+08:00">2019-12-06</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/C-C/" itemprop="url" rel="index"><span itemprop="name">C/C++</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="return和返回值类型"><code>return</code>和返回值类型</h2>
<p><code>return</code>语句结束当前正在执行的函数并将控制权返回到函数调用的地方。<code>return</code>语句有两种形式：<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">return</span> expression ;</span><br></pre></td></tr></table></figure></p>
<h2 id="无返回值函数">无返回值函数</h2>
<h2 id="有返回值函数">有返回值函数</h2>
<h2 id="返回数组指针">返回数组指针</h2>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/12/05/UNIX-signals/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/12/05/UNIX-signals/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">UNIX signals</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-12-05 10:20:16" itemprop="dateCreated datePublished" datetime="2019-12-05T10:20:16+08:00">2019-12-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-12-06 05:30:58" itemprop="dateModified" datetime="2019-12-06T05:30:58+08:00">2019-12-06</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UNIX/" itemprop="url" rel="index"><span itemprop="name">UNIX</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="program-error-signals">Program Error Signals</h2>
<p>当操作系统或者计算机本身检测到一个严重的程序错误时，它就会产生program error signals。一般来说，这些signals都表示你的程序出现了很严重的问题，没有办法继续进行计算了。<br>
一些程序为了在进程终止前进行清理，会建立handle program。这个handler结束的时候应该指定该signal的默认动作或者重新raise这个signal，这样子和原来没有建立signal处理程序的时候相比，仅仅多了清理的一部分，其他还和原来一样。一般来说，这些signal的默认动作都是终止进程。如果不是<code>raise</code>或者<code>kill</code>发出的这些signals，选择block或者忽略这些singals或者建立handlers让它们正常返回，程序可能会崩溃。<br>
当某一个program error signals终止一个进程的时候，它会写一个core dump文件记录进程终止状态。这个core dump文件的名字叫做core，保存在进程终止时所在目录。（在ubuntu中，没有保存文件，而是直接输出了出来[3]）</p>
<h3 id="sigfpe"><code>SIGFPE</code></h3>
<h3 id="sigill"><code>SIGILL</code></h3>
<h3 id="sigbus"><code>SIGBUS</code></h3>
<h3 id="sigsegv"><code>SIGSEGV</code></h3>
<h3 id="sigabrt"><code>SIGABRT</code></h3>
<h3 id="sigtrap"><code>SIGTRAP</code></h3>
<h3 id="sigemt"><code>SIGEMT</code></h3>
<h2 id="terminal-signals">Terminal Signals</h2>
<p>这一小节介绍的signal都是由于terminate一个进程的。它们之间的区别在于使用目的不同，并且程序可能对不同的signals有不同的处理方法。<br>
处理这些signals的目的是让进程在terminate之前能够进行合适的清理。比如，删除临时文件等等。</p>
<h3 id="sigtem"><code>SIGTEM</code></h3>
<p>这个signal可以被blocked, handled和忽略，shell命令的<code>kill</code>默认会产生<code>SIGTERM</code> signal。</p>
<blockquote>
<p>It is the normal way to politely ask a program to terminate.</p>
</blockquote>
<h3 id="sigint"><code>SIGINT</code></h3>
<p><code>SIGINT</code>是程序中断singal，当用户输入INTR字符（通常是C-c）时中断。</p>
<h3 id="sigquit"><code>SIGQUIT</code></h3>
<p><code>SIGQUIT</code>和<code>SIGINT</code>很像，会中断一个进程，但是它被QUIT（通常是C-\）控制，并且当它terminate一个进程时，它会产生一个core dump，就像一个程序出错信号一样。<br>
在处理<code>SIGQUI</code>的时候，最好不进行某些cleanups。比如，如果程序创建临时文件，处理其他termination时，最好把临时文件给删除了，但是对于<code>SIGQUIT</code>来说，最好不把它们给删了，因为用户可以用它们查找原因。</p>
<h3 id="sigkill"><code>SIGKILL</code></h3>
<p><code>SIGKILL</code> signal用于立刻终止程序。它不能被handled，也不能被忽略，因此是致命的。同样的也不能被block。<br>
这个singal通常是显式请求。因为他不能被handled，所以一般把它作为最后一个选择，在尝试了C-c或者<code>SIGTERM</code>不起作用之后，最后再使用<code>SIGKILL</code>。</p>
<h3 id="sighup"><code>SIGHUP</code></h3>
<p>如果终端借口检测到一个连接断开（可能因为网络或者电话连接断了），就将这个signal报告和这个终端相关的控制进程。</p>
<h3 id="其他">其他</h3>
<blockquote>
<p>The default behavior of SIGINT, SIGTERM, SIGQUIT and SIGHUP is to kill the program. However applications are allowed to install a handler for these signals. So the actual behavior of applications when they receive these signals is a matter of convention (which each application may or may not follow), not of system design.<br>
SIGINT is the “weakest” of the lot. Its conventional meaning is “stop what you’re doing right now and wait for further user input”. It’s the signal generated by Ctrl+C in a terminal. Non-interactive programs generally treat it like SIGTERM.<br>
SIGTERM is the “normal” kill signal. It tells the application to exit cleanly. The application might take time to save its state, to free resources such as temporary files that would otherwise stay behind, etc. An application that doesn’t want to be interrupted during a critical application might ignore SIGTERM for a while.<br>
SIGQUIT is the harshest of the ignorable signals. It’s meant to be used when an application is misbehaving and needs to be killed now, and by default it traditionally left a core dump file (modern systems where most users wouldn’t know what a core file is tend to not produce them by default). Applications can set a handler but should do very little (in particular not save any state) because the intent of SIGQUIT is to be used when something is seriously wrong.<br>
SIGKILL never fails to kill a running process, that’s the point. Other signals exist to give the application a chance to react.<br>
SIGHUP is about the same as SIGTERM in terms of harshness, but it has a specific role because it’s automatically sent to applications running in a terminal when the user disconnects from that terminal (etymologically, because the user was connecting via a telephone line and the modem hung up). SIGHUP is often involuntary, unlike SIGTERM which has to be sent explicitly, so applications should try to save their state on a SIGHUP. SIGHUP also has a completely different conventional meaning for non-user-facing applications (daemons), which is to reload their configuration file.</p>
</blockquote>
<h2 id="job-control-signals">Job Control Signals</h2>
<h3 id="sigcld"><code>SIGCLD</code></h3>
<h2 id="参考文献">参考文献</h2>
<p>1.<a href="https://unix.stackexchange.com/questions/251195/difference-between-less-violent-kill-signal-hup-1-int-2-and-term-15" target="_blank" rel="noopener">https://unix.stackexchange.com/questions/251195/difference-between-less-violent-kill-signal-hup-1-int-2-and-term-15</a><br>
2.<a href="https://www.gnu.org/software/libc/manual/html_node/Termination-Signals.html#Termination-Signals" target="_blank" rel="noopener">https://www.gnu.org/software/libc/manual/html_node/Termination-Signals.html#Termination-Signals</a><br>
3.<a href="https://stackoverflow.com/questions/2065912/core-dumped-but-core-file-is-not-in-the-current-directory" target="_blank" rel="noopener">https://stackoverflow.com/questions/2065912/core-dumped-but-core-file-is-not-in-the-current-directory</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/12/04/UNIX-Signal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/12/04/UNIX-Signal/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">UNIX Signal</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-12-04 15:22:47" itemprop="dateCreated datePublished" datetime="2019-12-04T15:22:47+08:00">2019-12-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-12-05 15:09:34" itemprop="dateModified" datetime="2019-12-05T15:09:34+08:00">2019-12-05</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UNIX/" itemprop="url" rel="index"><span itemprop="name">UNIX</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概述">概述</h2>
<p>Signals是软件终端。它提供了一种处理异步事件的方法。</p>
<h2 id="什么是signal">什么是signal</h2>
<p>每一个signal都有一个名字，它们以三个字符<code>SIG</code>开头。例如：</p>
<ul>
<li><code>SIGABRT</code>是abort signal，调用abort函数时产生这种signal</li>
<li><code>SIGALRM</code>是闹钟signal，由alarm函数设置的定时器超时后产生这种signal</li>
</ul>
<p>在头文件<code>&lt;singal.h&gt;</code>中，signal name都被定义成正整数常量。如果内核包含对用户级应用程序有意义的文件，被认为是一种不好的形式，如果应用程序和内核需要使用同一个定义，那么就将有关信息放在内核头文件中，然后用户级头文件再包含该内核头文件。比如Linux 3.2.0将signal定义在<code>&lt;bits/signum.h&gt;</code>中。</p>
<p>很多条件可以产生signal：</p>
<ul>
<li>用户按一些键</li>
<li>硬件异常</li>
<li>调用<code>kill(2)</code>函数</li>
<li>调用<code>kill(1)</code>命令，它是<code>kill(2)</code>的接口</li>
<li>检测到某种软件条件已经发生</li>
</ul>
<p>常见的signal可以分为以下几类：</p>
<ul>
<li>程序出错signals，用于report程序错误</li>
<li>Termination singals，用于中断或者终止程序</li>
<li>Alarm signals,</li>
<li>异步I/O signals</li>
<li>Joc control signals</li>
<li>操作错误signal</li>
<li>miscellaneous signals</li>
<li>signal messages</li>
</ul>
<p>关于具体的每个signal的介绍，可以看书，看文档<code>man 7 signal</code>，或者查看另一篇文章<a href>UNIX signals</a>。</p>
<p>在某个signal出现后，可以按照以下三种方式之一进行signal处理：</p>
<ol>
<li>忽略singal。有两个signal不能被忽略：<code>SIGKILL</code>和<code>SIGTSTP</code>，它们向内核或者root用户踢欧冠呢了停止或者终止进程的可靠方法。还有某些硬件signal，除零或者非法内存引用，进程的行为是未定义的。</li>
<li>捕获signal。通过内核接收到某个signal后，调用相应的用户函数。</li>
<li>执行系统默认动作。对于大多数系统，默认动作是终止进程的执行。</li>
</ol>
<h2 id="函数signal">函数<code>signal</code></h2>
<p><code>signal</code>是ISO C定义的。但是ISO C不涉及多进程，进程组，终端I/O等概念。所以它对signal的定义非常含糊，对于UNIX的用处很小。<br>
而<code>signal</code>的语义和实现有关，最好使用<code>sigaction</code>函数代替<code>signal</code>。</p>
<h3 id="signal定义"><code>signal</code>定义</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*<span class="keyword">sighandler_t</span>)</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="keyword">sighandler_t</span> signal(<span class="keyword">int</span> signum, <span class="keyword">sighandler_t</span> handler);</span><br></pre></td></tr></table></figure>
<h3 id="signal性质"><code>signal</code>性质</h3>
<ol>
<li><code>handler</code>的值是常量<code>SIG_IGN</code>，<code>SIG_DFL</code>或者一个函数的地址。分别表示忽略该信号，执行默认动作，或者调用相应的函数。</li>
<li><code>signal</code>函数要求两个参数，返回一个函数指针，这个指针指向的函数没有返回值。第一个参数<code>signum</code>是整形术，第二个参数是函数指针。</li>
</ol>
<h3 id="exec和fork"><code>exec</code>和<code>fork</code></h3>
<p>当使用<code>exec</code>执行一个程序时，所有signal的状态都是系统默认或者忽略。通常所有signal都被设置为它们的默认的动作，除非调用<code>exec</code>的进程忽略该signal。更确切的说，<code>exec</code>函数将原先设置为要catch的signal更改为默认动作，其他signal的状态不变。比如一个进程原先要捕捉的signal，执行一个新程序后就不再catch了，因为signal catch函数的地址可能在执行的新程序文件中无意义了。</p>
<h3 id="不可靠的signal">不可靠的<code>signal</code></h3>
<h2 id="参考文献">参考文献</h2>
<p>1.《APUE》第三版<br>
2.<a href="https://www.gnu.org/software/libc/manual/html_node/Standard-Signals.html#Standard-Signals" target="_blank" rel="noopener">https://www.gnu.org/software/libc/manual/html_node/Standard-Signals.html#Standard-Signals</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/11/28/C-passing-arguments/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/11/28/C-passing-arguments/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">C/C++ passing arguments</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-11-28 23:49:24" itemprop="dateCreated datePublished" datetime="2019-11-28T23:49:24+08:00">2019-11-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-12-06 14:49:20" itemprop="dateModified" datetime="2019-12-06T14:49:20+08:00">2019-12-06</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/C-C/" itemprop="url" rel="index"><span itemprop="name">C/C++</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="参数传递">参数传递</h2>
<p>形参初始化的机理和变量初始化一样。形参的类型决定了形参和实参交互的方式。如形参是引用类型，它将绑定到对应的实参上；否则，将实参的值拷贝后赋给形参。<br>
当形参是引用类型时，我们说它对应的实参被<strong>引用传递</strong>，或者函数被<strong>传引用调用</strong>。和其他引用一样，引用形参也是它绑定的对象的别名；也就是说，引用形参是它对应的实参的别名。<br>
当实参的值被拷贝给形参时，形参和实参是两个相互独立的对象。我们说这样的实参被<strong>值传递</strong>或者函数被<strong>传值调用</strong>。</p>
<p>因为C中没有引用，所以C中传递参数的方式只有值传递，而C++中还有引用，不仅有值传递，还有引用传递。</p>
<h3 id="值传参">值传参</h3>
<p>当初始化一个非引用类型的变量时，初始值被拷贝给变量。此时，对变量的改动不会影响初始值。值传参的原理和这个一样，函数对形参做的所有操作都不会影响实参。</p>
<h4 id="指针形参">指针形参</h4>
<p>指针的行为和其他非引用类型一样。当执行指针拷贝操作时，拷贝的是指针的值。拷贝之后，两个指针是不同的指针。但是因为指针可以让我们间接访问它所指向的对象，所以可以通过指针修改它所指对象的值。</p>
<h3 id="引用传参">引用传参</h3>
<p>函数接受的参数是引用类型的话就是引用传参。通过使用引用形参，函数可以改变一个或者多个实参的值。<br>
引用传参的好处：</p>
<ol>
<li>避免拷贝，可以避免低效的拷贝操作，或者有些类型不支持拷贝，比如IO类型。</li>
<li>间接的实现多个返回值（也可以通过值传递指针实现）。</li>
</ol>
<h3 id="const形参和实参"><code>const</code>形参和实参</h3>
<p>当形参是<code>const</code>时，必须注意顶层<code>const</code>，顶层<code>const</code>作业于对象本身。当用实参初始化形参时，会忽略掉顶层<code>const</code>，即形参的顶层<code>const</code>被忽略掉了。当形参有顶层<code>const</code>时，传递给它常量或者非常量对象都是可以的。</p>
<h4 id="指针或者引用形参和const">指针或者引用形参和<code>const</code></h4>
<p>形参的初始化方式和变量的初始化方式是一样的，所以指针或者引用形参和<code>const</code>结合时，按照<code>const</code>变量的初始化规则执行就行。</p>
<h4 id="尽量使用常量引用">尽量使用常量引用</h4>
<p>把函数不会修改的形参定义成普通的引用是一种比较常见的错误，这么做带给函数的调用者一种误导，即函数可以修改它的实参的值。此外，使用引用而非常量引用也会极大地限制函数所能接受的实参类型。（比如，不能把<code>const</code>对象，字面值或者需要类型转换的对象传递给普通的引用传参）</p>
<h3 id="数组形参">数组形参</h3>
<p>数组有两个特殊的性质：</p>
<ol>
<li>不允许拷贝，因为不能拷贝数组，所以不能以值传递的方式使用数组参数。</li>
<li>在使用数组时通常会将其转换成指针。因为数组会被转换成指针，所以为函数传递数组时，实际上传递的是指向数组首元素的指针，这样子可以节约开销。</li>
</ol>
<h4 id="管理数组转换的指针">管理数组转换的指针</h4>
<p>当传递给函数一个数组时，实参自动的转成指向数组首元素的指针，数组的大小对于函数的调用没有什么影响。因为数组是以指针的形式传递给函数的，所以函数其实是不知道数组的大小的，调用者应该为此提供一些额外的信息。通常有三种方式：</p>
<ol>
<li>显示传递一个表示数组大小的形参</li>
<li>使用标记指定数组长度，要求数组本身包含一个结束标记，典型的例子是C风格字符串。</li>
<li>使用标准库规范，传递数组首元素和尾后元素的指针。可以使用<code>begin</code>和<code>end</code>函数获得数组的首元素和尾后元素的指针。</li>
</ol>
<h4 id="数组形参和const">数组形参和<code>const</code></h4>
<p>当函数不需要对数组进行写操作时，数组形参应该是指向<code>const</code>的指针。只有当函数确实需要改变数组元素值的时候，才把形参定义成指向非常量的指针。</p>
<h4 id="数组引用形参">数组引用形参</h4>
<p>C++允许将变量定义成数组的引用，形参也可以是数组的引用。此时，引用形参绑定到数组上。</p>
<h4 id="传递多维数组">传递多维数组</h4>
<p>C++其实没有真正的多维数组，多维数组其实就是数组的数组。把多维数组传递给函数时，传递的是指向数组首元素的指针。而多维数组是数组的数组，首元素本身就是一个数组，多维数组转换成指向数组的指针。数组第二维以及后面维度都是数组类型的一部分，不能省略。</p>
<h3 id="main命令行选项"><code>main</code>命令行选项</h3>
<p>详细可以查看<a href>C/C++ main argc argv</a>。</p>
<h3 id="可变形参">可变形参</h3>
<p>当不知道向函数传递多少个参数时，C++ 11提供了两种方法处理不同数量实参，如果所有实参类型相同，传递<code>initializer_list</code>标准库类型，如果实参类型不同，编写特殊的函数，可变参数模板。<br>
此外，C++ 还有一种特殊的形参，叫做省略符，可以用它传递可变数量的实参。</p>
<h4 id="initializer-list形参"><code>initializer_list</code>形参</h4>
<p>如果实参数量未知，但是类型相同，可以使用标准库类型<code>initializer_list</code>类型的形参。该标准库提供的操作如下：</p>
<ul>
<li><code>initializer_list&lt;T&gt; lst</code>，默认初始化，T类型元素的空列表</li>
<li><code>initializer_list&lt;T&gt; lst{a, b, c...}</code>，list元素是对应初始值的副本，列表中的元素是<code>const</code></li>
<li><code>lst2(lst)</code>和<code>lst2 = lst</code>，注意，拷贝或者赋值一个<code>initializer_list</code>对象不会拷贝列表中的元素；拷贝后，原始列表和副本共享元素。</li>
<li><code>lst.size()</code></li>
<li><code>lst.begin()</code></li>
<li><code>lst.end()</code></li>
</ul>
<p><code>initializer_list</code>是一个标准库类型，它也是一个模板，它的元素永远都是常量。</p>
<p>有一个疑问，就是<code>std::initializer_list</code>和<code>std::vector</code>有什么区别？[2,3,4]<br>
拷贝<code>std::initializer_list</code>的时候并不会拷贝底层的对象。相当于拷贝了“指针”，或者说<code>std::initializer_list</code>有reference semantics而<code>std::vector</code>具有value semantics。</p>
<blockquote>
<p>Initializer lists may be implemented as a pair of pointers or pointer and length. Copying a std::initializer_list does not copy the underlying objects.</p>
</blockquote>
<h4 id="省略符形参">省略符形参</h4>
<p>省略符形参是为了便于C++访问某些特殊的C代码而设置的。省略符形参只能出现在形参列表的最后一个位置：<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(param_list, ...)</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(...)</span></span>;</span><br></pre></td></tr></table></figure></p>
<h2 id="参考文献">参考文献</h2>
<p>1.《C++ Primer》第五版<br>
2.<a href="https://stackoverflow.com/questions/27753420/initializer-list-vs-vector" target="_blank" rel="noopener">https://stackoverflow.com/questions/27753420/initializer-list-vs-vector</a><br>
3.<a href="https://en.cppreference.com/w/cpp/utility/initializer_list" target="_blank" rel="noopener">https://en.cppreference.com/w/cpp/utility/initializer_list</a><br>
4.<a href="https://stackoverflow.com/questions/14414832/why-use-initializer-list-instead-of-vector-in-parameters" target="_blank" rel="noopener">https://stackoverflow.com/questions/14414832/why-use-initializer-list-instead-of-vector-in-parameters</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/11/28/C-separate-compilation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/11/28/C-separate-compilation/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">C/C++ separate compilation</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-11-28 23:24:38 / 修改时间：23:47:08" itemprop="dateCreated datePublished" datetime="2019-11-28T23:24:38+08:00">2019-11-28</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/C-C/" itemprop="url" rel="index"><span itemprop="name">C/C++</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="功能文件头文件和实现">功能文件头文件和实现</h2>
<h3 id="头文件">头文件</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// print_string.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> PRINT_STRING</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRINT_STRING</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_string</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *str)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h3 id="实现">实现</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// print_string.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"print_string.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_string</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,  str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="测试文件实现">测试文件实现</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"print_string.h"</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> str[] = <span class="string">"hello world"</span>;</span><br><span class="line">    print_string(str);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="编译和链接">编译和链接</h2>
<p>执行以下命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ main.cpp print_string.cpp -o main</span><br><span class="line">./main</span><br></pre></td></tr></table></figure>
<h2 id="理解">理解</h2>
<p>在<code>main</code>中包含了<code>print_string.h</code>头文件，相当于对函数进行了声明。然后使用<code>g++</code>编译的时候相当于提供了<code>print_string</code>的实现。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/11/28/UNIX-Process-Relationships/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/11/28/UNIX-Process-Relationships/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">Process Relationships</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-11-28 00:06:11" itemprop="dateCreated datePublished" datetime="2019-11-28T00:06:11+08:00">2019-11-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-12-04 15:22:26" itemprop="dateModified" datetime="2019-12-04T15:22:26+08:00">2019-12-04</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UNIX/" itemprop="url" rel="index"><span itemprop="name">UNIX</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概述">概述</h2>
<p>在UNIX Process Control中，介绍了：</p>
<ol>
<li>每一个进程都有一个父进程，初始的kernel-level的进程通常是它自己。</li>
<li>当子进程终止的时候，父进程可以获得子进程的exit status。</li>
<li>同时在介绍<code>waitpid</code>的时候`提到了process groups，并且解释了我们可以等待一个进程组中任意进程的终止。</li>
</ol>
<p>这一篇文章更详细的介绍了process groups，以及POSIX.1中引入的session的概念。同时还介绍了用于登录的login shell和所有从login shell中启动的进程的关系。</p>
<h2 id="终端登录">终端登录</h2>
<h3 id="bsd登录">BSD登录</h3>
<p>系统bootstrap时，内核创建进程号为1的init进程。init进程使系统进行入多用户模式，init读取文件<code>/etc/tty</code>，对每一个允许登录的终端设备，init调用一次<code>fork</code>，它所生成的子程序<code>exec getty</code>程序。<br>
<code>getty</code>对终端设备调用<code>open</code>函数，以读写方式打开终端。一旦终端被打开，文件描述符0,1,2就被关联到该设备。然后<code>getty</code>输出<code>login</code>等字样，等待用户输入。当用户输入username之后，<code>getty</code>工作就结束了，接下来通过类似于以下的方式调用<code>login</code>：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execle(&quot;/bin/login&quot;, &quot;login&quot;, &quot;-p&quot;, username, (char*)0, envp);</span><br></pre></td></tr></table></figure></p>
<p><code>login</code>得到了用户名，接下来调用<code>getpasswd</code>提示用户键入密码，然后调用<code>crypt</code>将用户键入的口令和shadow中的pwsswd比较，判断密码是否正确。如果密码正确的话，<code>login</code>还会进行以下工作：</p>
<ol>
<li>将当前工作目录改为用户的主目录。</li>
<li>调用<code>chown</code>更改终端的控制权，使登录用户成为它的所有者。</li>
<li>对终端设备的权限改成用户读和写。</li>
<li>用<code>login</code>得到的所有参数进行初始化</li>
<li><code>login</code>进程更改登录用户的<code>uid</code>并调用该用户的登录shell。</li>
</ol>
<p>当然现代的<code>login</code>不仅仅进行这些工作，还会根据启动文件更改或者增加用户的环境变量等等。</p>
<h2 id="网络登录">网络登录</h2>
<h3 id="bsd登录-v2">BSD登录</h3>
<p>网络登录的话，BSD中有一个inetd进程，等待绝大多数互联想链接。作为系统启动的一部分，<code>init</code>调用一个shell，使其执行shell脚本/etc/rc，shell脚本启动一个守护进程inetd。当这个shell脚本终止时，inetd的进程变成init。inetd等待TCP/IP连接，每当有一个连接到达时，就执行一次<code>fork</code>，然后使用<code>exec</code>执行相应的子程序。<br>
比如一个TELNET服务请求。客服进程打开一个到服务主机的TCP连接，客户机运行TELNET服务进程（用telnetd表示）。它们之间使用TELNET应用协议通过TCP交换数据。客服进程的用户登录到服务进程所在的主机。<br>
然后telnetd进程打开一个伪终端设备，并且使用<code>fork</code>将它们分成两个进程。父进程处理通过网络的通信，子进程执行login程序。父进程和子进程之间通过伪终端相连接。在调用<code>exec</code>之前，子进程使其文件描述符0,1,2和伪终端相连。登录成功的话，执行和终端操作类似的设置。</p>
<p>当通过终端或者网络登录时，我们得到一个登录shell，它的标准输入，标准输出和标准错误要么连接到一个终端设备，要么连接到一个伪终端设备。</p>
<h2 id="进程组">进程组</h2>
<p>除了pid，每一个进程还属于一个process group。进程组是一个或者一组进程的集合。他们都是同一个job的进程，每一个进程组都有一个唯一的进程组id，和pid类似，可以存放在pid_t中。函数<code>getpgrp</code>获得process group的ID，<code>getpgid</code>获得指定进程的进程组ID，它们都是SUS定义的。<br>
每个进程组有一个组长进程，组长进程的进程组ID和它的进程ID一样。进程组组长可以创建一个进程组，创建该组中的进程，然后终止。只要在某个进程组中有一个进程存在，那么该进程组就存在，跟其组长是否终止无关。<br>
可以调用<code>setpgid</code>创建一个新的进程组后者加入一个现有的进程组。<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">setpgid</span><span class="params">(<span class="keyword">pid_t</span> pid, <span class="keyword">pid_t</span> pgid)</span></span>;</span><br></pre></td></tr></table></figure></p>
<p><code>setpgid</code>将pid号为pid的进程的进程组ID设置为pgid。当子进程调用了<code>exec</code>之后，父进程就不能修改子进程的进程组ID了。<br>
通常在job control shell中，在fork之后调用此函数，父进程设置子进程的进程组ID，子进程也设置子进程的进程组ID，这两个调用总有一个是重复的，但是可以确保子进程的组ID被正确设置了。</p>
<h2 id="session">Session</h2>
<p>Session是一个或者多个进程组的集合。比如一个session可以有三个进程组：<br>
进程组1：登录shell，<br>
进程组2：proc1, proc2<br>
进程组3：proc3, proc4, proc5<br>
等等。通常一个进程组的进程是由一个shell pipeline生成的。比如上面的进程组可能是通过以下shell命令实现的：<br>
proc1 | proc2 &amp;<br>
proc3 | proc4 | proc5</p>
<p>可以调用<code>setsid</code>创建一个新的session：<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">pid_t</span> setsid(<span class="keyword">void</span>);</span><br></pre></td></tr></table></figure></p>
<p>这个函数具有以下性质：<br>
如果调用这个函数的进程不是一个进程组的组长，就创建一个新的session：</p>
<ol>
<li>该进程变成新的session的session leader，这个session leader是创建该session的进程。注意SUS只说明了session leader，而没有像pid和process gid之类的session id。也就是说session leader是有唯一PID的单个进程，可以将session leader的ID当做session ID。<strong>注意什么是session leader，它是一个进程，而session ID是session leader的PID，或者也把session ID较为session leader的process group ID</strong>。</li>
<li>调用进程是新进程组和新session中的唯一一个进程。</li>
<li>新的session没有controlling terminal。</li>
</ol>
<h2 id="控制终端">控制终端</h2>
<p>session和process group的一些其他属性：</p>
<ul>
<li>一个session通常会有一个controlling terminal，通常是终端设备或者伪终端设备。</li>
<li>建立和控制终端连接的session leader被称为controlling process（控制进程）。</li>
<li>一个session中的几个process group可以被分为一个foreground process group（前台进程组）和多个background process group（后台进程组）。</li>
<li>如果一个session有一个controlling terminal，那么它有一个前台进程组，其它进程组为后台进程组。</li>
<li>无论何时键入终端的中断键，ctrl+C，都会将中断信号发送至前台进程组的所有进程。</li>
<li>无论何时键入终端的退出键，ctrl+\，都会将退出信号发送到前台进程组的所有进程。</li>
<li>如果终端接口检测到网络已经断开，将挂断信号发送到session leader。</li>
</ul>
<p>登录shell属于后台进程组，它是session leader，也就是controlling process。登录时，会自动建立controlling terminal。有时候不管标准输入，标准输出是否重定向，程序都要和控制终端交互，可以open文件/dev/tty。在内核中，/dev/tty是controlling terminal的同义词，如果没有controlling terminal，对于这个设备的open失败。</p>
<h2 id="tcgetpgrp-tcsetpgrp和tcgetsid"><code>tcgetpgrp</code>, <code>tcsetpgrp</code>和<code>tcgetsid</code></h2>
<h3 id="函数原型">函数原型</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">pid_t</span> tcgetpgrp(<span class="keyword">int</span> fd);</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">tcsetpgrp</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">pid_t</span> pgrp)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;termios.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">pid_t</span> tcgetsid(<span class="keyword">int</span> fd);</span><br></pre></td></tr></table></figure>
<h3 id="属性">属性</h3>
<ol>
<li><code>tcgetpgrp</code>返回前台进程组ID，它与在fd上打开的终端相关联。</li>
<li>如果进程有一个controlling terminal，这个进程可以调用<code>tcsetpgrp</code>将前台进程组ID设置为pgrpid，fd必须引用该session的controlling terminal。</li>
<li>可以通过<code>tcgetsid</code>函数获得session leader的进程组ID。</li>
</ol>
<h2 id="job-control">job control</h2>
<p>可以在一个终端上启动多个jobs（groups of process），它控制哪个job可以访问终端，哪个job应该在后台运行，job control需要满足以下三个条件：</p>
<ol>
<li>支持job control的shell</li>
<li>内核的终端驱动程序必须支持job contrl</li>
<li>内核必须支持某些特定的job-control signals。</li>
</ol>
<p>在shell中使用job contrl，我们可以创建前台的job，也可以创建后台的job，一个job是进程的集合，通常是进程的pipeline，可以在后台运行多个job。<br>
可以通过键入几个特殊字符和终端驱动程序进行交互作用，控制前台进程组的所有进程：</p>
<ul>
<li>中断，ctrl+C，产生SIGINT</li>
<li>退出，ctrl+\，产生SIGQUIT</li>
<li>挂起，ctrl+Z，产生SIGSTRP</li>
</ul>
<p>终端驱动程序还需要处理一些情况：</p>
<ol>
<li>当后台job试图读取终端时<br>
如果有一个前台job和多个后台jobs。一般情况下，只有前台job接收终端输入，当后台job试图从终端读取，并不会报错，终端驱动程序会检测这种情况，并且向后台job发出一个SIGTTIN signal。这个signal会停止后台job，shell向有关用户发出通知说你的后台job停止啦！然后用户可以用shell命令将它转换后前台job，从终端读取。<br>
如果</li>
<li>当后台job试图写终端时<br>
当用户禁止后台job向controlling terminal写后，当后台job试图写向标准输出，终端驱动程序识别出这个写操作来自于后台job，向该job发出SIGTTOU signal，阻塞相应的job。当用户使用fg将后台job转换为前台job时，job继续执行。</li>
</ol>
<h2 id="shell执行过程">shell执行过程</h2>
<p>有些shell支持job control，比如bash，有些不支持，比如Bourne shell。</p>
<p>执行以下命令：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps -o pid,ppid,pgid,sid,comm | cat      // 后台job</span><br><span class="line">ps -o pid,ppid,pgid,sid,comm | cat &amp;    // 前台job</span><br></pre></td></tr></table></figure></p>
<h3 id="不支持job-control的shell">不支持job control的shell</h3>
<p>在不支持job control的shell中，管道的最后一个进程是shell的子进程，而执行管道中其他命令的进程是该最后进程的子进程。当最后一个进程终止时，shell得到通知。<br>
所有的job的process group id和shell的都一样。<br>
<img src="/2019/11/28/UNIX-Process-Relationships/shell_no_job_control.png" alt="shell_no_job_control"></p>
<h3 id="支持job-control的shell">支持job control的shell</h3>
<p>而在支持job control的shell中<br>
每一个job都有一个自己的process group id，和shell的不一样。<br>
shell是两个job的父进程。</p>
<h2 id="孤儿进程组">孤儿进程组</h2>
<p>当一个进程组的父进程退出之后，而子进程还没有结束，这个时候整个进程组就成了孤儿进程组。<br>
什么是孤儿进程组：<br>
进程组中每个成员的父进程要么是它组内的一个成员，要么不是这个进程组所在session的成员。</p>
<h2 id="freebsd实现">FreeBSD实现</h2>
<p>每个session都会有一个seesion结构，它包含：</p>
<ul>
<li><code>s_count</code></li>
<li><code>s_leader</code></li>
<li><code>s_ttyvp</code></li>
<li><code>s_ttyp</code></li>
<li><code>s_sid</code>，这一部分不是SUS的组成，只有FreeBSD有。</li>
</ul>
<p>每个终端或者伪终端会在内核中分配一个tty结构，它包含：</p>
<ul>
<li><code>t_session</code></li>
<li><code>t_pgrp</code></li>
<li><code>t_termios</code></li>
<li><code>t_winsize</code></li>
</ul>
<p>每个进程组都包含一个pgrp结构，它包含：</p>
<ul>
<li><code>pg_id</code></li>
<li><code>pg_session</code></li>
<li><code>pg_memebers</code></li>
</ul>
<p>每个进程都有一个<code>proc</code>结构，它包含：</p>
<ul>
<li><code>p_pid</code></li>
<li><code>p_ptr</code></li>
<li><code>p_grp</code></li>
<li><code>p_pglist</code></li>
</ul>
<p>进程通过v_node结构体访问/dev/tty。</p>
<p>它们之间的关系如下图所示：<br>
<img src="/2019/11/28/UNIX-Process-Relationships/" alt="session_and_process_group"></p>
<h2 id="参考文献">参考文献</h2>
<p>1.《APUE》第三版</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/11/27/assembly-languages/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/11/27/assembly-languages/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">assembly languages</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-11-27 21:36:52 / 修改时间：22:00:57" itemprop="dateCreated datePublished" datetime="2019-11-27T21:36:52+08:00">2019-11-27</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/汇编/" itemprop="url" rel="index"><span itemprop="name">汇编</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="机器指令">机器指令</h2>
<p>计算机指令可以表示为序列化的bits，一般来说，这是一个程序最低级别的表示-每一条指令都等于CPU的一个单个的，不可分隔的指令。这种表示方法叫做机器语言，因为它是机器可以理解的唯一一种形式。</p>
<h2 id="汇编语言">汇编语言</h2>
<p>一种更高level的表示叫做assembly language。Assembly language和机器语言的很类似，通常可以很方便的把程序从汇编语言转换成机器语言。因为机器语言和汇编语言的相似性，每一个不同的机器架构都有它自己的汇编语言。事实上，每一个架构都可能有好几个汇编语言。<br>
汇编语言的优势是汇编语言对于人类来说是更容易阅读和理解的。举例来说，将寄存器20和寄存器17的内容相加，并将结果存放在寄存器16的MIPS机器语言指令是：0x02918020。给出这个指令，很难直接理解它是怎么工作的。相同的MISP汇编指令是：<br>
<code>add $16, $20, $17</code><br>
可读性更强。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://mxxhcm.github.io/2019/11/26/C-strlen-vs-sizeof/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="马晓鑫爱马荟荟">
      <meta itemprop="description" content="记录硕士三年自己的积累">
      <meta itemprop="image" content="/images/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mxxhcm's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/11/26/C-strlen-vs-sizeof/" class="post-title-link" itemprop="http://mxxhcm.github.io/index.html">C/C++ strlen vs sizeof</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-11-26 10:07:37 / 修改时间：10:10:14" itemprop="dateCreated datePublished" datetime="2019-11-26T10:07:37+08:00">2019-11-26</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C/++</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><code>strlen</code>不计算字符串数组的null字节，而<code>sizeof</code>会计算null字节所占的字节。</li>
<li><code>strlen</code>是一个函数，使用时需进行一次系统调用。而<code>sizeof</code>会在编译时计算。</li>
</ol>
<h2 id="参考文献">参考文献</h2>
<p>1.《APUE》第三版8.3节</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/favicon.jpg" alt="马晓鑫爱马荟荟">
            
              <p class="site-author-name" itemprop="name">马晓鑫爱马荟荟</p>
              <p class="site-description motion-element" itemprop="description">记录硕士三年自己的积累</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">290</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">25</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">375</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/mxxhcm" title="GitHub &rarr; https://github.com/mxxhcm" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:mxxhcm@gmail.com" title="E-Mail &rarr; mailto:mxxhcm@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">马晓鑫爱马荟荟</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v6.6.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script src="/js/src/utils.js?v=6.6.0"></script>

  <script src="/js/src/motion.js?v=6.6.0"></script>



  
  


  <script src="/js/src/affix.js?v=6.6.0"></script>

  <script src="/js/src/schemes/pisces.js?v=6.6.0"></script>



  

  


  <script src="/js/src/bootstrap.js?v=6.6.0"></script>



  



  






<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    







  





  

  

  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  


  
  

  

  

  

  

  

  

</body>
</html>
